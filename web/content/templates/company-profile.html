<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
    <title>Foundation Accelerator</title>
    <link rel="stylesheet" href="css/foundation.css" />
	<link rel="stylesheet" href="css/custom.css" />
	<link rel="stylesheet" href="css/company-profile.css" />
    <link rel="stylesheet" href="css/motion-ui.css" />
	<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
	<link href='css/fullcalendar.css' rel='stylesheet' />
	<link href='css/scheduler.css' rel='stylesheet' />
    <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/spectrum.css">
    <link rel="stylesheet" href="js/tinymce/skins/lightgray/skin.min.css" type="text/css" />
	<script src="js/jquery.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
	<script src='js/moment.min.js'></script>
	<script src='js/fullcalendar.min.js'></script>
	<script src='js/scheduler.min.js'></script>
	<script src='js/jquery.tablesorter.min.js'></script>
    <script src="js/spectrum.js"></script>
    <script src="js/tinymce/tinymce.min.js"></script>
    <script src='js/setup-progress.js'></script>
    <script src='js/zen.js'></script>
    <script type="text/javascript" src="https://appcenter.intuit.com/Content/IA/intuit.ipp.anywhere.js"></script>
	<script type="text/javascript">
        intuit.ipp.anywhere.setup({
        	menuProxy: '<?php print($quickbooks_menu_url); ?>',
            grantUrl: '<?php print($quickbooks_oauth_url); ?>',
            datasources: {
                quickbooks: true,
                payments: false
            },
            paymentOptions: {
                intuitReferred: true
            }
        });
    </script>
<script>
	  jQuery(function ($) { $("#datepicker").datepicker( {dateFormat:'yy-mm-dd'} ); });


//Cover Letter

	tinymce.init({
	  	selector: 'textarea#finalPacketCoverLetter',
	  	setup: function(editor) {
	   		$('#saveFinalPacketCoverLetter').on('click', function(e) {
	    		var finalPacketCoverLetter = tinyMCE.get('finalPacketCoverLetter').getContent();
	      		$('textarea#finalPacketCoverLetter').html(finalPacketCoverLetter);
	      		
	      		//finalPacketCoverLetter

	      		if (finalPacketCoverLetter == '') {
					$('#finalPacketCoverLetter').parent().find('.form-error').addClass('is-visible');
				} else {
					$.ajax({
						url: 'saveFinalPacketCoverLetter.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							text: finalPacketCoverLetter
						},
						success: function(response) {
							if(!response == ''){
								// console.log(response);
								// $('#finalPacketCoverLetter').text('Last Updated on '+response+'');
								$('#finalPacketCoverLetter').parent().find('.form-error').removeClass('is-visible');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Final Packet Cover Letter has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	text: 'Customer First Name',
			        	onclick: function() { editor.insertContent('{customerFirstName}'); }
			      	},{
			       	text: 'Customer Last Name',
			        	onclick: function() { editor.insertContent('{customerLastName}'); }
			      	},{
			        text: 'Property Address',
			        	onclick: function() { editor.insertContent('{propertyAddress}'); }
			      	},{
				      	text: 'Evaluation Name',
				      	onclick: function() { editor.insertContent('{evaluationName}')}
			      	},

		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var finalPacketCoverLetter = tinyMCE.get('finalPacketCoverLetter').getContent();

		      	finalPacketCoverLetter = finalPacketCoverLetter.replace(/{customerFirstName}/gi, 'John');
		      	finalPacketCoverLetter = finalPacketCoverLetter.replace(/{customerLastName}/gi, 'Sample');
		      	finalPacketCoverLetter = finalPacketCoverLetter.replace(/{customerAddress}/gi, '1234 Some Street, <br> <br> Cityville, MO 1234');
		      	finalPacketCoverLetter = finalPacketCoverLetter.replace(/{propertyAddress}/gi, 'Installation Street Address, Cityville, MO 1234');
		      	finalPacketCoverLetter = finalPacketCoverLetter.replace(/{evaluationName}/gi, 'evaluation name');
		     	// finalPacketCoverLetter = finalPacketCoverLetter.replace('<p class='+ '"'+ 'p1' + '"'+ '>', '<p>');

		      	var companyName = $('.project-title').text();

		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').text();
		      	var companyWebsite = $('.website').text();
		      	var arrMonths = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

		      	var todaysDate = new Date();
		      	var strTodaysDate = arrMonths[todaysDate.getMonth()] + " " + todaysDate.getDate() + ", " + todaysDate.getFullYear();
	
			  	var PreviewHtml =
			  	'<body style=\" font-family: sans-serif;\">' +
			  	'<p style=\"width:100%; padding:5px 45px;\">' + companyLogo + '</p>' +
			  	'<p style=\"width:100%; padding:5px 45px;\">'+ strTodaysDate + '</p>'+
			  	'<p style=\"width:100%; padding:5px 45px;\">John Sample <br/>'+
			  	'1234 Some Street,<br />'+
			  	'Cityville, MO 12345' + '</p>' +
			  	'<div class=\"row\" style=\"padding:5px 60px;\"><p>' +
			  	finalPacketCoverLetter +
			  	'</p></div>' +
			  	'<p style=\"width:100%; padding:5px 45px; text-align:center;\" >' +
			  		'<strong>' + companyName + '</strong> | ' + companyAddress + '<br/>' +
			  		companyPhones + 
			  	'</p></body></html>';

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Cover Letter Preview');
		      	$('#emailPreviewModal #modalContent').html(PreviewHtml);
		      	$('#emailPreviewModal').foundation('open');




		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "tags | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});
	

	//add warranty
	tinymce.init({
	  	selector: 'textarea#addWarrantyBody',
	  	setup: function(editor) {
	   		$('#saveAddWarrantyBody').on('click', function(e) {
	    		var addWarrantyBody = tinyMCE.get('addWarrantyBody').getContent();
	      		$('textarea#addWarrantyBody').html(addWarrantyBody);
	      		
	      		var warrantyAdd = 0;

	      		if (addWarrantyBody == '') {
					$('#warrantyError').addClass('is-visible');
					warrantyAdd = 1;
				}else{
					$('#warrantyError').removeClass('is-visible');
					// warrantyAdd = 0;
				}

				if($('input[name="warrantyName"]').val()==''){
						$('#addWarrantyNameError').addClass('is-visible');
						warrantyAdd = 1;
				}else{
					// warrantyAdd = 0;
					$('#addWarrantyName').removeClass('is-visible');
				}

				if ($('#optCertificate').prop('checked')){
					var selectedWarrantyType = 0;
				}else{
					var selectedWarrantyType = 1;
				}

				var enteredWarrantyName = $('input[name="warrantyName"]').val();

				if(warrantyAdd == 0) {
					$.ajax({
						url:'warranty-add.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							warrantyName: enteredWarrantyName,
							warrantyBody: addWarrantyBody,
							warrantyType: selectedWarrantyType
						},
						success: function(response) {
							if(!response == ''){
								// console.log(response);
								$('input[name="warrantyName"]').val('');
								$('#optCertificate').prop('checked', 'true');
								$('#optCertificate').val('0');
								tinyMCE.activeEditor.setContent("");
								$('#warrantyError').removeClass('is-visible');
								$('#addWarrantyModal').foundation('close');

								// $('#addWarrantyBody').text('Last Updated on '+response+'')
								$('#emailSavedModal').foundation('open');
								$('#emailSavedModal p').text('Warranty has been saved!');
								//repopulate the company warranty table.
								$('#warrantyTable tbody tr').not(':first').remove();
								companyWarranties();
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			      		text: 'Company Address',
			      		onclick: function () {editor.insertContent('{companyAddress}');}
			      	},{
		      			text: 'Company Phone Numbers',
		      			onclick: function () {editor.insertContent('{companyPhoneNumbers}');}
			      	},
			      	{
			      		text: 'Company Logo',
			      		onclick: function() {editor.insertContent('{companyLogo}'); }
			      	},
		      		{
				       	text: 'Customer First Name',
			        	onclick: function() { editor.insertContent('{customerFirstName}'); }
			      	},{
				       	text: 'Customer Last Name',
			        	onclick: function() { editor.insertContent('{customerLastName}'); }
			      	},{
			       	 text: 'Customer Address',
			        	onclick: function() { editor.insertContent('{customerAddress}'); }
			      	},{
				        text: 'Property Address',
			        	onclick: function() { editor.insertContent('{propertyAddress}'); }
			      	},{
				      	text: 'Evaluation Name',
				      	onclick: function() { editor.insertContent('{evaluationName}')}
			      	},{
			      		text: 'Todays Date',
			      		onclick: function() { editor.insertContent('{todaysDate}')}
			      	}
		      	]
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "tags | fontsizeselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});

	
	// edit warranty
	tinymce.init({
	  	selector: 'textarea#editWarrantyBody',
	  	setup: function(editor) {
	   		$('#saveEditWarrantyBody').on('click', function(e) {
	    		var editWarrantyBody = tinyMCE.get('editWarrantyBody').getContent();
	      		$('textarea#editWarrantyBody').html(editWarrantyBody);
	      		
	      		var warrantyID = $('input[name="editWarrantyID"]').val();
	      		// console.log(warrantyID);

	      		var warrantyEdit =0;

	      		if (editWarrantyBody == '') {
					$('#warrantyEditError').addClass('is-visible');
					warrantyEdit = 1;
				}else{
					$('#warrantyEditError').removeClass('is-visible');
					// warrantyEdit = 0;
				}

				if($('input[name="editWarrantyName"]').val()==''){
						$('#editWarrantyNameError').addClass('is-visible');
						warrantyEdit = 1;
				}else{
					// warrantyEdit = 0;
					$('#editWarrantyNameError').removeClass('is-visible');
				}

				if ($('#optEditCertificate').prop('checked')){
					var documentType = 0;
				}else{
					var documentType = 1;
				}

				var warrantyName = $('input[name="editWarrantyName"]').val();

				if(warrantyEdit == 0) {
					$.ajax({
						url:'warranty-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							warrantyID: warrantyID,
							warrantyName: warrantyName,
							warrantyBody: editWarrantyBody,
							documentType: documentType
						},
						success: function(response) {
							if(!response == ''){
								// console.log(response);
								$('input[name="editWarrantyName"]').val('');
								$('#optEditCertificate').prop('checked', 'checked');
								$('#optEditCertificate').val('0');
								tinyMCE.activeEditor.setContent("");
								$('#editWarrantyNameError').removeClass('is-visible');
								$('#warrantyEditError').removeClass('is-visible');
								$('#warrantyEditModal').foundation('close');

								$('#emailSavedModal').foundation('open');
								$('#emailSavedModal p').text('Warranty has been saved!');

								//clear the company warranty table.
								$('#warrantyTable tbody tr').not(':first').remove();
								//repopulate the company warranty table.
								companyWarranties();
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			      		text: 'Company Address',
			      		onclick: function () {editor.insertContent('{companyAddress}');}
			      	},{
		      			text: 'Company Phone Numbers',
		      			onclick: function () {editor.insertContent('{companyPhoneNumbers}');}
			      	},
			      	{
			      		text: 'Company Logo',
			      		onclick: function() {editor.insertContent('{companyLogo}'); }
			      	},
		      		{
				       	text: 'Customer First Name',
			        	onclick: function() { editor.insertContent('{customerFirstName}'); }
			      	},{
				       	text: 'Customer Last Name',
			        	onclick: function() { editor.insertContent('{customerLastName}'); }
			      	},{
			       	 text: 'Customer Address',
			        	onclick: function() { editor.insertContent('{customerAddress}'); }
			      	},{
				        text: 'Property Address',
			        	onclick: function() { editor.insertContent('{propertyAddress}'); }
			      	},{
				      	text: 'Evaluation Name',
				      	onclick: function() { editor.insertContent('{evaluationName}')}
			      	},{
			      		text: 'Todays Date',
			      		onclick: function() { editor.insertContent('{todaysDate}')}
			      	}
		      	]
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "tags | fontsizeselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Contract Text Editor
	tinymce.init({
	  	selector: 'textarea#contractText',
	  	setup: function(editor) {
	        editor.on('keyup', function(e) {
	        	contractModified = 1;
        	});
	    	$('#saveContractText').on('click', function(e) {
	    		var contractContent = tinyMCE.get('contractText').getContent();
	      		//console.log(contractContent);
	      		$('textarea#contractText').html(contractContent);

	      		if (contractContent == '') {
					// $('#contractText').addClass('is-invalid-input');
					// $('#contractText').parent().addClass('is-invalid-label');
					$('#contractText').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'contract-add.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							text: contractContent
						},
						success: function(response) {
							if(!response == ''){
								$('#contractLastSaved').text('Last Updated by '+response+'');
								$('#contractSavedModal').foundation('open');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	'wysiwyg additional options': { 
				  'paste_remove_spans': true
				},
		      	menu: [{
			       	text: 'Current Date',
			        	onclick: function() { editor.insertContent('{date}'); }
			      	},{
			       	 text: 'First Name',
			        	onclick: function() { editor.insertContent('{firstName}'); }
			      	},{
			        text: 'Last Name',
			        	onclick: function() { editor.insertContent('{lastName}'); }
			      	},{
			        text: 'Address',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	},{
			        text: 'City',
			        	onclick: function() { editor.insertContent('{city}'); }
			      	},{
			        text: 'State',
			        	onclick: function() { editor.insertContent('{state}'); }
			      	},{
			        text: 'Zip',
			        	onclick: function() { editor.insertContent('{zip}'); }
			      	},{
			        text: 'Phone',
			        	onclick: function() { editor.insertContent('{phone}'); }
			      	},{
			        text: 'Email',
			        	onclick: function() { editor.insertContent('{email}'); }
			      	},{
			      	text: 'Bid #',
			        	onclick: function() { editor.insertContent('{bidNumber}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var contractText = tinyMCE.get('contractText').getContent();

		      	//contractText = contractText.replace(/{evaluatorFirstName}/gi, '<?php echo $userFirstName;  ?>');

		      	var companyName = $('.project-title').text();

		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Contract Preview');
		      	$('#emailPreviewModal #modalContent').html('<div class="medium-12 columns"><p class="no-margin" style="text-align:center;font-size:1.5rem;font-weight: bold;line-height:1;">Contract</p><p class="no-margin" style="text-align:center;font-size:2.5rem;font-weight: bold;">'+companyName+'</p><p style="text-align:center;font-size:12px;line-height: 1.2;">'+companyAddress+'<br/><?php echo $primaryPhoneDisplay;  ?><br/>'+companyWebsite+'<br/></p></div><div><div style="display:inline-block;"><p style="display:inline-block;margin-bottom:0;">Customer Name:</p></div><div style="border-bottom:1px solid #000000;width: 30rem;display:inline-block;"><p style="display:inline-block;margin-bottom:0;padding-left:10px;">John Smith</p></div><div style="display:inline-block;"><p style="display:inline-block;text-align:right;margin-bottom:0;">Date:</p></div><div style="border-bottom:1px solid #000000;width: 7rem;display:inline-block;"><p style="display:inline-block;margin-bottom:0;padding-left: 10px;text-align:center;"><?php echo $todayDateShortEmailPreview;  ?></p></div></div><div><div style="display:inline-block;"><p style="display:inline-block;margin-bottom:0;">Located:</p></div><div style="border-bottom:1px solid #000000;width: 44rem;display:inline-block;"><p style="display:inline-block;margin-bottom:0;padding-left:10px;">1234 Some Street, Thiscity, MO 12345</p></div></div><div style="margin-bottom: 1rem;"><div style="display:inline-block;"><p style="display:inline-block;margin-bottom:0;">Phone:</p></div><div style="border-bottom:1px solid #000000;width: 20rem;display:inline-block;"><p style="display:inline-block;margin-bottom:0;padding-left:10px;">(000) 000-0000</p></div><div style="display:inline-block;"><p style="display:inline-block;text-align:right;margin-bottom:0;">Email:</p></div><div style="border-bottom:1px solid #000000;width: 22rem;display:inline-block;"><p style="display:inline-block;margin-bottom:0;padding-left:10px;">johnsmith@google.com</p></div></div><p>'+contractText+'<div style="margin-bottom: 1.5rem;"><div style="display:inline-block;"><pSignature:</p></div><div style="border-bottom:1px solid #000000;width: 30rem;display:inline-block;"><p style="display:inline-block;margin-bottom:0;padding-left:10px">John Smith</p></div><div style="display:inline-block;"><p style="display:inline-block;text-align:right;margin-bottom:0;">Date:</p></div><div style="border-bottom:1px solid #000000;width: 7rem;display:inline-block;"><p style="display:inline-block;margin-bottom:0;text-align:center;padding-left:10px"><?php echo $todayDateShortEmailPreview;  ?></p></div></div>');


		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "tags | fontsizeselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//New Customer Email Text Editor
	tinymce.init({
	  	selector: 'textarea#newCustomerEmail',
	  	setup: function(editor) {
	    	$('#saveNewCustomerEmail').on('click', function(e) {
	    		var newCustomerEmail = tinyMCE.get('newCustomerEmail').getContent();
	      		$('textarea#newCustomerEmail').html(newCustomerEmail);

	      		if (newCustomerEmail == '') {
					$('#newCustomerEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailAddCustomer',
							text: newCustomerEmail
						},
						success: function(response) {
							if(!response == ''){
								$('#newCustomerLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('New Customer Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	text: 'Current Date',
			        	onclick: function() { editor.insertContent('{date}'); }
			      	},{
			       	 text: 'First Name',
			        	onclick: function() { editor.insertContent('{firstName}'); }
			      	},{
			        text: 'Last Name',
			        	onclick: function() { editor.insertContent('{lastName}'); }
			      	},{
			        text: 'Address',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	},{
			        text: 'City',
			        	onclick: function() { editor.insertContent('{city}'); }
			      	},{
			        text: 'State',
			        	onclick: function() { editor.insertContent('{state}'); }
			      	},{
			        text: 'Zip',
			        	onclick: function() { editor.insertContent('{zip}'); }
			      	},{
			        text: 'Phone',
			        	onclick: function() { editor.insertContent('{phone}'); }
			      	},{
			        text: 'Email',
			        	onclick: function() { editor.insertContent('{email}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var newCustomerEmail = tinyMCE.get('newCustomerEmail').getContent();
		      	var companyName = $('.project-title').text();
		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('New Customer Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Introduction<br/><br/>Hello John,</p>'+newCustomerEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');

		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});

	
	//Evaluation Appointment Email Text Editor
	tinymce.init({
	  	selector: 'textarea#evaluationAppointmentEmail',
	  	setup: function(editor) {
	   		$('#saveEvaluationAppointmentEmail').on('click', function(e) {
	    		var evaluationAppointmentEmail = tinyMCE.get('evaluationAppointmentEmail').getContent();
	    		if($('#scheduleEmailSendSales').prop('checked')){
				 	var CheckedVal = "1";
				}
				else{
					var CheckedVal = "0";
				}
		
	    		var scheduleEmailSendSales = CheckedVal;
	      		$('textarea#evaluationAppointmentEmail').html(evaluationAppointmentEmail);

	      		if (evaluationAppointmentEmail == '') {
					$('#evaluationAppointmentEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailSchedule',
							text: evaluationAppointmentEmail,
							sendSales:'scheduleEmailSendSales',
							sendFrom: scheduleEmailSendSales 
						},
						success: function(response) {
							if(!response == ''){
								$('#evaluationAppointmentLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Evaluation Appointment Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	text: 'Evaluator First Name',
			        	onclick: function() { editor.insertContent('{evaluatorFirstName}'); }
			      	},{
			       	text: 'Evaluator Last Name',
			        	onclick: function() { editor.insertContent('{evaluatorLastName}'); }
			      	},{
			       	 text: 'Evaluator Bio',
			        	onclick: function() { editor.insertContent('{evaluatorBio}'); }
			      	},{
			        text: 'Evaluator Email',
			        	onclick: function() { editor.insertContent('{evaluatorEmail}'); }
			      	},{
			        text: 'Evaluator Phone',
			        	onclick: function() { editor.insertContent('{evaluatorPhone}'); }
			      	},{
			        text: 'Evaluator Picture',
			        	onclick: function() { editor.insertContent('{evaluatorPicture}'); }
			      	},{
			        text: 'Appointment Date/Time',
			        	onclick: function() { editor.insertContent('{time}'); }
			      	},{
			        text: 'Appointment Address (1234 Some Street, Cityville, MO 12345)',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var evaluationAppointmentEmail = tinyMCE.get('evaluationAppointmentEmail').getContent();

		      	evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{evaluatorFirstName}/gi, '<?php echo $userFirstName;  ?>');
		      	evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{evaluatorLastName}/gi, '<?php echo $userLastName;  ?>');
		      	evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{evaluatorBio}/gi, '<?php echo $userBio;  ?>');
		      	evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{evaluatorEmail}/gi, '<?php echo $userEmail;  ?>');
		      	evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{evaluatorPhone}/gi, '<?php echo $userPhoneDisplay;  ?>');
		      	if ('<?php echo $userPhoto;  ?>' == '') {
		      		evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{evaluatorPicture}/gi, '<img style="max-height:180px;" src="images/no-image-user-profile.jpg" />');
		      	} else {
		      		evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{evaluatorPicture}/gi, '<img style="border:1px solid #151719;max-height:180px;" src="image.php?type=userimage&cid=<?php echo $companyID;  ?>&uid=<?php echo $userID;  ?>&name=<?php echo $userPhoto;  ?>" />');
		      	}
		      	evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{time}/gi, 'Monday, August 8 at 9:00 am');
		      	evaluationAppointmentEmail = evaluationAppointmentEmail.replace(/{address}/gi, '1234 Some Street, Thiscity, MO 12345');

		      	var companyName = $('.project-title').text();

		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Evaluation Appointment Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Appointment Confirmation<br/><br/>Hello John,</p>'+evaluationAppointmentEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "tags | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Customer Bid Email Text Editor
	tinymce.init({
	  	selector: 'textarea#customerBidEmail',
	  	setup: function(editor) {
	   		$('#saveCustomerBidEmail').on('click', function(e) {
	    		var customerBidEmail = tinyMCE.get('customerBidEmail').getContent();
	    		if($('#bidEmailSendSales').prop('checked')){
				 	var CheckedVal = "1";
				}
				else{
					var CheckedVal = "0";
				}
		
	    		var bidEmailSendSales = CheckedVal;
	      		$('textarea#customerBidEmail').html(customerBidEmail);

	      		if (customerBidEmail == '') {
					$('#customerBidEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailBidSent',
							text: customerBidEmail,
							sendSales:'bidEmailSendSales',
							sendFrom: bidEmailSendSales 
						},
						success: function(response) {
							if(!response == ''){
								$('#customerBidLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Customer Bid Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	text: 'Evaluator First Name',
			        	onclick: function() { editor.insertContent('{evaluatorFirstName}'); }
			      	},{
			       	text: 'Evaluator Last Name',
			        	onclick: function() { editor.insertContent('{evaluatorLastName}'); }
			      	},{
			       	 text: 'Evaluator Bio',
			        	onclick: function() { editor.insertContent('{evaluatorBio}'); }
			      	},{
			        text: 'Evaluator Email',
			        	onclick: function() { editor.insertContent('{evaluatorEmail}'); }
			      	},{
			        text: 'Evaluator Phone',
			        	onclick: function() { editor.insertContent('{evaluatorPhone}'); }
			      	},{
			        text: 'Evaluator Picture',
			        	onclick: function() { editor.insertContent('{evaluatorPicture}'); }
			      	},{
			        text: 'View Bid Link',
			        	onclick: function() { editor.insertContent('{viewBidLink}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var customerBidEmail = tinyMCE.get('customerBidEmail').getContent();
		      	var companyColor = $('.companyColor span').css('backgroundColor');

		      	customerBidEmail = customerBidEmail.replace(/{evaluatorFirstName}/gi, '<?php echo $userFirstName;  ?>');
		      	customerBidEmail = customerBidEmail.replace(/{evaluatorLastName}/gi, '<?php echo $userLastName;  ?>');
		      	customerBidEmail = customerBidEmail.replace(/{evaluatorBio}/gi, '<?php echo $userBio;  ?>');
		      	customerBidEmail = customerBidEmail.replace(/{evaluatorEmail}/gi, '<?php echo $userEmail;  ?>');
		      	customerBidEmail = customerBidEmail.replace(/{evaluatorPhone}/gi, '<?php echo $userPhoneDisplay;  ?>');
		      	if ('<?php echo $userPhoto;  ?>' == '') {
		      		customerBidEmail = customerBidEmail.replace(/{evaluatorPicture}/gi, '<img style="max-height:180px;" src="images/no-image-user-profile.jpg" />');
		      	} else {
		      		customerBidEmail = customerBidEmail.replace(/{evaluatorPicture}/gi, '<img style="border:1px solid #151719;max-height:180px;" src="image.php?type=userimage&cid=<?php echo $companyID;  ?>&uid=<?php echo $userID;  ?>&name=<?php echo $userPhoto;  ?>" />');
		      	}
		      	customerBidEmail = customerBidEmail.replace(/{viewBidLink}/gi, '<a href="#" style="color: #ffffff;text-decoration: none;background-color: '+companyColor+';padding: 10px;border-radius: 5px;font-weight: normal;">View Bid</a>');

		      	var companyName = $('.project-title').text();

		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Customer Bid Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Evaluation and Bid<br/><br/>Hello John,</p>'+customerBidEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "tags | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Bid Accept Email Text Editor
	tinymce.init({
	  	selector: 'textarea#bidAcceptEmail',
	  	setup: function(editor) {
	   		$('#saveBidAcceptEmail').on('click', function(e) {

	    		var bidAcceptEmail = tinyMCE.get('bidAcceptEmail').getContent();

				if($('#bidAcceptEmailSendSales').prop('checked')){
				 	var CheckedVal = "1";
				}
				else{
					var CheckedVal = "0";
				}
		
	    		var bidAcceptEmailSendSales = CheckedVal;
	      		$('textarea#bidAcceptEmail').html(bidAcceptEmail);

	      		if (bidAcceptEmail == '') {
					$('#bidAcceptEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailBidAccept',
							text: bidAcceptEmail,
							sendSales:'bidAcceptEmailSendSales',
							sendFrom: bidAcceptEmailSendSales 
						},
						success: function(response) {
							if(!response == ''){
								$('#bidAcceptLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Bid Accept Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
							console.log($object);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	 text: 'First Name',
			        	onclick: function() { editor.insertContent('{firstName}'); }
			      	},{
			        text: 'Last Name',
			        	onclick: function() { editor.insertContent('{lastName}'); }
			      	},{
			        text: 'Address',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	},{
			        text: 'City',
			        	onclick: function() { editor.insertContent('{city}'); }
			      	},{
			        text: 'State',
			        	onclick: function() { editor.insertContent('{state}'); }
			      	},{
			        text: 'Zip',
			        	onclick: function() { editor.insertContent('{zip}'); }
			      	},{
			        text: 'Phone',
			        	onclick: function() { editor.insertContent('{phone}'); }
			      	},{
			        text: 'Email',
			        	onclick: function() { editor.insertContent('{email}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var bidAcceptEmail = tinyMCE.get('bidAcceptEmail').getContent();
		      	var companyName = $('.project-title').text();
		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Bid Accept Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Bid Has Been Accepted<br/><br/>Hello John,</p>'+bidAcceptEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Bid Reject Email Text Editor
	tinymce.init({
	  	selector: 'textarea#bidRejectEmail',
	  	setup: function(editor) {
	   		$('#saveBidRejectEmail').on('click', function(e) {
	   		 		var bidRejectEmail = tinyMCE.get('bidRejectEmail').getContent();
	   		 		if($('#bidRejectEmailSendSales').prop('checked')){
				 		var CheckedVal = "1";
					}
					else{
						var CheckedVal = "0";
					}
			
		    		var bidRejectEmailSendSales = CheckedVal;

	      		$('textarea#bidRejectEmail').html(bidRejectEmail);

	      		if (bidRejectEmail == '') {
					$('#bidRejectEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailBidReject',
							text: bidRejectEmail,
							sendSales:'bidRejectEmailSendSales',
							sendFrom: bidRejectEmailSendSales 
						},
						success: function(response) {
							if(!response == ''){
								$('#bidRejectLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Bid Reject Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	 text: 'First Name',
			        	onclick: function() { editor.insertContent('{firstName}'); }
			      	},{
			        text: 'Last Name',
			        	onclick: function() { editor.insertContent('{lastName}'); }
			      	},{
			        text: 'Address',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	},{
			        text: 'City',
			        	onclick: function() { editor.insertContent('{city}'); }
			      	},{
			        text: 'State',
			        	onclick: function() { editor.insertContent('{state}'); }
			      	},{
			        text: 'Zip',
			        	onclick: function() { editor.insertContent('{zip}'); }
			      	},{
			        text: 'Phone',
			        	onclick: function() { editor.insertContent('{phone}'); }
			      	},{
			        text: 'Email',
			        	onclick: function() { editor.insertContent('{email}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var bidRejectEmail = tinyMCE.get('bidRejectEmail').getContent();
		      	var companyName = $('.project-title').text();
		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Bid Reject Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Bid Has Been Rejected<br/><br/>Hello John,</p>'+bidRejectEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Installation Appointment Email Text Editor
	tinymce.init({
	  	selector: 'textarea#installationAppointmentEmail',
	  	setup: function(editor) {
	   		$('#saveInstallationAppointmentEmail').on('click', function(e) {
	    		var installationAppointmentEmail = tinyMCE.get('installationAppointmentEmail').getContent();
	      		$('textarea#installationAppointmentEmail').html(installationAppointmentEmail);

	      		if (installationAppointmentEmail == '') {
					$('#installationAppointmentEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailInstallation',
							text: installationAppointmentEmail
						},
						success: function(response) {
							if(!response == ''){
								$('#installationAppointmentLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Installation Appointment Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
		      		text: 'Installer First Name',
			        	onclick: function() { editor.insertContent('{installerFirstName}'); }
			      	},{
			       	text: 'Installer Last Name',
			        	onclick: function() { editor.insertContent('{installerLastName}'); }
			      	},{
			       	 text: 'Installer Bio',
			        	onclick: function() { editor.insertContent('{installerBio}'); }
			      	},{
			        text: 'Installer Email',
			        	onclick: function() { editor.insertContent('{installerEmail}'); }
			      	},{
			        text: 'Installer Phone',
			        	onclick: function() { editor.insertContent('{installerPhone}'); }
			      	},{
			        text: 'Installer Picture',
			        	onclick: function() { editor.insertContent('{installerPicture}'); }
			      	},{
			        text: 'Installation Date/Time',
			        	onclick: function() { editor.insertContent('{time}'); }
			      	},{
			        text: 'Installation Address (1234 Some Street, Cityville, MO 12345)',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var installationAppointmentEmail = tinyMCE.get('installationAppointmentEmail').getContent();

		      	installationAppointmentEmail = installationAppointmentEmail.replace(/{installerFirstName}/gi, '<?php echo $userFirstName;  ?>');
		      	installationAppointmentEmail = installationAppointmentEmail.replace(/{installerLastName}/gi, '<?php echo $userLastName;  ?>');
		      	installationAppointmentEmail = installationAppointmentEmail.replace(/{installerBio}/gi, '<?php echo $userBio;  ?>');
		      	installationAppointmentEmail = installationAppointmentEmail.replace(/{installerEmail}/gi, '<?php echo $userEmail;  ?>');
		      	installationAppointmentEmail = installationAppointmentEmail.replace(/{installerPhone}/gi, '<?php echo $userPhoneDisplay;  ?>');
		      	if ('<?php echo $userPhoto;  ?>' == '') {
		      		installationAppointmentEmail = installationAppointmentEmail.replace(/{installerPicture}/gi, '<img style="max-height:180px;" src="images/no-image-user-profile.jpg" />');
		      	} else {
		      		installationAppointmentEmail = installationAppointmentEmail.replace(/{installerPicture}/gi, '<img style="border:1px solid #151719;max-height:180px;" src="image.php?type=userimage&cid=<?php echo $companyID;  ?>&uid=<?php echo $userID;  ?>&name=<?php echo $userPhoto;  ?>" />');
		      	}
		      	installationAppointmentEmail = installationAppointmentEmail.replace(/{time}/gi, 'Monday, August 8 at 9:00 am');
		      	installationAppointmentEmail = installationAppointmentEmail.replace(/{address}/gi, '1234 Some Street, Thiscity, MO 12345');

		      	var companyName = $('.project-title').text();

		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Installation Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Installation Confirmation<br/><br/>Hello John,</p>'+installationAppointmentEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "tags | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Final Packet Email Text Editor
	tinymce.init({
	  	selector: 'textarea#finalPacketEmail',
	  	setup: function(editor) {
	   		$('#saveFinalPacketEmail').on('click', function(e) {
	    		var finalPacketEmail = tinyMCE.get('finalPacketEmail').getContent();
	      		$('textarea#finalPacketEmail').html(finalPacketEmail);

	      		if (finalPacketEmail == '') {
					$('#finalPacketEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailFinalPacket',
							text: finalPacketEmail
						},
						success: function(response) {
							if(!response == ''){
								$('#finalPacketLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Final Packet Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	 text: 'First Name',
			        	onclick: function() { editor.insertContent('{firstName}'); }
			      	},{
			        text: 'Last Name',
			        	onclick: function() { editor.insertContent('{lastName}'); }
			      	},{
			        text: 'Address',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	},{
			        text: 'City',
			        	onclick: function() { editor.insertContent('{city}'); }
			      	},{
			        text: 'State',
			        	onclick: function() { editor.insertContent('{state}'); }
			      	},{
			        text: 'Zip',
			        	onclick: function() { editor.insertContent('{zip}'); }
			      	},{
			        text: 'Phone',
			        	onclick: function() { editor.insertContent('{phone}'); }
			      	},{
			        text: 'Email',
			        	onclick: function() { editor.insertContent('{email}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var finalPacketEmail = tinyMCE.get('finalPacketEmail').getContent();
		      	var companyName = $('.project-title').text();
		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Final Packet Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Thank You For Your Business<br/><br/>Hello John,</p>'+finalPacketEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Invoice Email Text Editor
	tinymce.init({
	  	selector: 'textarea#invoiceEmail',
	  	setup: function(editor) {
	   		$('#saveInvoiceEmail').on('click', function(e) {
	    		var invoiceEmail = tinyMCE.get('invoiceEmail').getContent();
	      		$('textarea#invoiceEmail').html(invoiceEmail);

	      		if (invoiceEmail == '') {
					$('#invoiceEmail').parent().find('.form-error').addClass('is-visible');

				} else {

					$.ajax({
						url: 'company-email-edit.php',
						dataType: "json",
						contentType: 'application/json',
						type: "POST",
						contentType: "application/x-www-form-urlencoded",
						data: {
							email: 'companyEmailInvoice',
							text: invoiceEmail
						},
						success: function(response) {
							if(!response == ''){
								$('#invoiceLastSaved').text('Last Updated on '+response+'');

								$('#emailSavedModal').foundation('open');

								$('#emailSavedModal p').text('Invoice Email has been saved!');
							}
						}, error: function(jqXHR, textStatus, errorThrown) {
							console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
						}

					});
				}
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	 text: 'First Name',
			        	onclick: function() { editor.insertContent('{firstName}'); }
			      	},{
			        text: 'Last Name',
			        	onclick: function() { editor.insertContent('{lastName}'); }
			      	},{
			        text: 'Address',
			        	onclick: function() { editor.insertContent('{address}'); }
			      	},{
			        text: 'City',
			        	onclick: function() { editor.insertContent('{city}'); }
			      	},{
			        text: 'State',
			        	onclick: function() { editor.insertContent('{state}'); }
			      	},{
			        text: 'Zip',
			        	onclick: function() { editor.insertContent('{zip}'); }
			      	},{
			        text: 'Phone',
			        	onclick: function() { editor.insertContent('{phone}'); }
			      	},{
			        text: 'Email',
			        	onclick: function() { editor.insertContent('{email}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var finalPacketEmail = tinyMCE.get('invoiceEmail').getContent();
		      	var companyName = $('.project-title').text();
		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;
		      	$('#emailPreviewModal').css('max-height',pageHeight)

		      	$('#emailPreviewModal h3#modalTitle').text('Invoice Email Preview');
		      	$('#emailPreviewModal #modalContent').html('<p style="width:100%"><strong>From:</strong> '+companyEmailFrom+'<br/><strong>Date:</strong> <?php echo $todayDateEmailPreview;  ?><br/><strong>To:</strong> johnsmith@google.com<br/><strong>Subject:</strong> Thank You For Your Business<br/><br/>Hello John,</p>'+finalPacketEmail+'<div style="width:100%;margin-top:3rem;"><p class="text-center">'+companyLogo+'<br/>'+companyName+' | '+companyAddress+'<br/>'+companyPhones+''+companyWebsite+'</p></div>');
		      	$('#emailPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste",
	    	"link"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | link | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});


	//Bid Intro Description Text Editor
	tinymce.init({
	  	selector: 'textarea#bidIntroDescription',
	  	setup: function(editor) {
	  		var answer = $(this);
	   		$('#saveBidIntroDescription').on('click', function(e) {
	    		var bidIntroDescription = tinyMCE.get('bidIntroDescription').getContent();
	      		$('textarea#bidIntroDescription').html(bidIntroDescription);

	      		if (bidIntroDescription == '') {
					$('#bidIntroDescription').parent().find('.form-error').addClass('is-visible');
					
				} else {
					var answer_name = 'bidIntroDescription';
					var answer_value = bidIntroDescription;
					var answer_section = 'description';
				    $.ajax({
				        url: 'company-services-ajax.php',
				        dataType: "json",
				        contentType: 'application/json',
				        type: "POST",
				        contentType: "application/x-www-form-urlencoded",
				        data: {
							 answer_name: answer_name,
							 answer_value: answer_value,
							 answer_section: answer_section,
				        },
				
				        success: function (response) {
							//console.log(response);
							//Remove Blue Background
				           $(answer).parent().removeClass( "save-pending" );
						   //Add Green Background and then Remove
							$(answer).parent().css('background-Color', '#90EE90').animate({ backgroundColor: "#FFFFFF" }, 1000);//.addClass('save-success');

							$('#emailSavedModal').foundation('open');

							$('#emailSavedModal p').text('Bid Intro Description has been saved!');
				        },
						 error: function(jqXHR, textStatus, errorThrown) {
				  			console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);

							$(answer).parent().removeClass( "save-pending" );
							$(answer).parent().addClass( "save-error" );
						 }
				    });
				}			
	    	});
	    	editor.addButton('tags', {
		      	type: 'menubutton',
		      	text: 'FX Tags',
		      	icon: false,
		      	menu: [{
			       	 text: 'Company Name',
			        	onclick: function() { editor.insertContent('{companyName}'); }
			      	}
		      	]
		    });
		    editor.addButton('preview', {
		      text: 'Preview',
		      icon: false,
		      onclick: function () {
		      	var bidIntroDescription = tinyMCE.get('bidIntroDescription').getContent();
		      	var companyName = $('.project-title').text();
		      	var companyEmailFrom = $('.fromAddress').text();
		      	var companyLogo = $('.companyLogo').html();

		      	var companyAddress = $('.companyAddress').text();
		      	companyAddress = companyAddress.replace(/<br\s*[\/]?>/gi,"");

		      	var companyPhones = $('.companyPhones').html();
		      	var companyWebsite = $('.website').html();

		      	var pageHeight = $( window ).height() * .85;

		      	$('#bidPreviewModal').css('max-height',pageHeight)

		      	//$('#bidPreviewModal h3#modalTitle').text('Final Packet Email Preview');
		      	$('#bidPreviewModal #modalContent').html('<html><body> <div style="width:150px;margin:auto;">'+ companyLogo +'</div> <h2 style="text-align:center;"> <span style="font-weight:normal;font-size:14px;">Prepared for:</span><br/> John Smith<br/> 123 Fake St, Suite 200<br/> Anytown, MO 12345 </h2> <div style="width:350px;margin:15px auto 15px auto;" class="photoBucket"> <span style="page-break-inside: avoid"> <img style="border:1px solid #000; padding:.5rem;" src="images/sample_house.jpg" width="350" </span> </div> <p style="text-align:center;font-size:16px;margin-top:0;margin-bottom:0;"> <span style="font-size:14px;">Bid #: 116</span><br/> <span style="font-size:14px;">Evaluated on:</span><br/> Friday, September 9, 2016 <br/><br/> <span style="font-size:14px;">Evaluated By:</span><br/> John Doe </p> <h4 style="text-align:center;margin-top: 1rem;margin-bottom: .5rem;">'+ companyName +'<br/> 1234 Address Street, Suite 200<br/>' + companyPhones +' www.acmecompany.com<br/> </h4> <span style="page-break-before: always;"></span> <h2 style="text-align:center;">Bid and Scope of Work</h2> <p>' + bidIntroDescription + '</p> <div> <h3>Piering</h3> <p> Install the piering system under structural footings of home per repair plan. Piers will be installed per manufacturers specifications and driven to refusal. If needed, foundation structure will be raised and leveled using a hydraulic lifting system. </p> <p> <strong>Total:</strong> $4,051.00<br/> 1 Under Porch<br/>1 Concentric<br/>1 Helical<br/>1 Other<br/> <br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Grout Under Footings</h4> <p>Cement grout mixture will be pumped into voids under footings after lifting of structure has been performed to ensure entire footing surface is fully supported.</p> <p style="page-break-before: avoid;"> <strong>Total: $40.00</strong><br/><br/> <strong>North Wall:</strong> 4 Linear Feet - Grout<br/><br/> </p> </div> <div> <h3>Wall Repair</h3> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Wall Braces</h4> <p style="page-break-before: avoid;"> Description W4X9.5<br/><br/> <strong>Total:</strong> $350.00<br/> <strong>North Wall:</strong> 1 - W4X9.5 Brace(s)<br/> <br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Wall Stiffeners</h4> <p style="page-break-before: avoid;"> Description C8X11.5<br/><br/> <strong>Total:</strong> $50.00<br/> <strong>North Wall:</strong> 1 - C8X11.5 Stiffener(s)<br/> <br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Wall Anchors</h4> <p style="page-break-before: avoid;"> Description C8X11.5<br/><br/> <strong>Total:</strong> $60.00<br/> <strong>North Wall:</strong> 1 - C8X11.5 Anchor(s)<br/> <br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Wall Excavation</h4> <p>Excavate foundation wall down to the structural footings and straiten wall to a relevant plumb. Seal wall from exterior by repairing cracks on exposed wall and applying roller-grade elastomeric emulsive membrane. Install new footing tile drain encased in geotextile fabric filter and connect to existing tile drain and sump pump, or drain to daylight where possible. Backfill 1/3 of excavation with clean gravel and backfill remaining excavation with original soils compacted in 8” lifts. Haul off debris and extra soils as needed.</p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $450.00<br/> <strong>North Wall:</strong><br/> Excavate Wall - 2 Linear Feet x 2 Depth (With Equipment)<br/> Straighten Wall - 3 Linear Feet<br/> Tile Drain 1 - Tile Drain<br/> Membrane 1 - Membrane<br/> Gravel Backfill Height - 4 Linear Feet<br/> Gravel Backfill - 0.97 Cubic Yards<br/> Excess Soil - -0.43 Cubic Yards<br/> <br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Beam Pocket Repair</h4> <p>Foundation walls will be repaired on exterior where steel girder has penetrated wall and broken concrete. </p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $400.00<br/> <strong>North Wall:</strong> 2 - Beam Pockets<br/> <br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Window Well Replacement</h4> <p>Description</p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $1,200.00<br/> <strong>North Wall:</strong> 4 - Window Wells<br/> <br/> </p> </div> <div> <h3>Water Management</h3> </div> <strong>Sump Pumps</strong><br/><strong>Total:</strong> $1304.00<br/><br/> <strong>Pump #1</strong><br/> Type 1 - Description Type 1<br/> Standard - Description Standard<br/> 1 LF Plumbing<br/> 1 Elbows<br/> Simple Electrical<br/> Standard Discharge<br/> <br/> <strong>Pump #2</strong><br/> Type 1 - Description Type 1<br/> Bell - Description Bell<br/> 2 LF Plumbing<br/> 2 Elbows<br/> Need Electrician<br/> Buried Discharge 4 LF<br/> <br/> <strong>Pump #3</strong><br/> Type 3 - Description Type 3<br/> Standard - Description Standard<br/> 3 LF Plumbing<br/> 3 Elbows<br/> Simple Electrical<br/> Standard Discharge<br/> <br/> <div> <h4 style="margin-bottom:0;margin-top:0;">Interior Drain System</h4> <p>Interior drain system will be installed along the perimeter basement walls at the locations specified in repair plan report. Drain system will be connected to a sump pump which will remove any excess groundwater under concrete slab and prevent water infiltration into basement. </p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $20.00<br/> <strong>North Wall:</strong> 2 Linear Feet<br/><br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Gutter Discharges</h4> <p>Extend and bury gutter downspouts to discharge downgradient from foundation at locations specified in repair plan report. Roof rainwater discharged by gutter downspouts are the largest sources of water near the home foundation. Extending gutter discharges away from the home foundation will greatly reduce foundation issues.</p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $120.00<br/> <strong>North Wall:</strong> 2 Linear Feet Above Ground, 3 Linear Feet Buried<br/><br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">French Drains</h4> <p>Install French drain and route discharge downgradient per repair plan. French drain will be covered with soil and sod/seed. French drains are designed to slowly dry out chronically wet areas, they are not designed to move storm water without surface inlets.</p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $140.00<br/> <strong>North Wall:</strong> 1 Linear Feet Perforated, 2 Linear Feet Non-Perforated<br/> <br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Surface Drain Fixtures</h4> <p style="page-break-before: avoid;"> Description Type 1<br/><br/> <strong>Total:</strong> $100.00<br/> <strong>North Wall:</strong> 2 - Type 1 Drain Fixture(s)<br/><br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Curtain Drain</h4> <p>Install curtain drain and route discharge downgradient at locations specified in repair plan. A 24 inch X 24 inch trench lined with 40-mil pond liner will house a 4 inch perforated pipe and then trench filled with clean gravel. Pipe will be buried to a downgradient location for discharge. Curtain drains require exposed clean gravel/decorative gravel at ground surface in order to accept surface water. </p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $20.00<br/> <strong>North Wall:</strong> 2 Linear Feet<br/><br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Window Well Drains</h4> <p>Drains will be installed in existing window wells and either connected to existing tile drain system piped to a sump pump or downgradient location for gravity discharge.</p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $300.00<br/> <strong>North Wall:</strong> 3 Window Well Drains - 2 Linear Feet Interior, 4 Linear Feet Exterior<br/><br/> </p> </div> <div> <h4 style="margin-bottom:0;margin-top:0;">Grading</h4> <p>Surface soils will be graded around home foundation by adding compacted soil, which will restore proper slope and promote positive drainage away from home.</p> <p style="page-break-before: avoid;"> <strong>Total:</strong> $4.80<br/> <strong>North Wall:</strong> 0.08 Yards<br/><br/> </p> </div> <div> <h3>Crack Repair</h3> <p> <strong>Total:</strong> $1,750.00<br/> <strong>Floor Cracks:</strong><br/> 4 Linear Feet - Description Polyurethane, 5 Linear Feet - Description Polyurethane with Carbon Fiber Staples, 6 Linear Feet - Description Polyurethane with Hydrophilic Injection, 7 Linear Feet - Description Bonding Epoxy, 8 Linear Feet - Description Mortar, 9 Linear Feet - Description Exterior Membrane<br/><br/> <strong>North Wall:</strong><br/> 5 Linear Feet - Description Polyurethane with Hydrophilic Injection<br/><br/> </p> </div> <div> <h3>Support Posts</h3> <p> <strong>Total:</strong> $220.00<br/> Post 1 Existing - Adjust Only Replace Post with New Footing (36x36x8)<br/>Post 2 Existing - Adjust Only Replace Post <br/>Post 3 Existing - Adjust Only Replace Post <br/>Post 4 Existing - Adjust Only Replace Post <br/>Post 5 Existing - Adjust Only Replace Post with New Footing (36x36x8)<br/> Post 1 Install New Post with New Footing (48x48x8)<br/> </p> <br/> </div> <div> <h3>Mudjacking</h3> <p> <strong>Total:</strong> $600.00<br/> <strong>Basement</strong> - 600.00<br/><br/> </p> </div> <div> <h3>Custom Services</h3> <p> <strong>Total:</strong> $300.00<br/> Flatwork - Flatwork Description<br/>1 <br/>1 Rebar - Rebar Description<br/> <br/> </p> </div> <br/> <h3 style="margin-bottom:0;margin-top:0;">Payment Terms</h3> <p style="margin-bottom:0;margin-top:0;"> <strong>Bid Acceptance:</strong> $4,591.92<br/> <strong>Project Complete:</strong> $4,591.92<br/> </p> <br/> <p style="margin-bottom:0;margin-top:0;">Subtotal: $11,479.80</p> <p style="margin-bottom:0;margin-top:0;">Discount 20%: -$2,295.96</p> <h3>Total: $9,183.84</h3> </body> </html>');
		      	$('#bidPreviewModal').foundation('open');
		      }
		    });
	  	},
	 	height: 500,
	  	plugins: [
	    	"code",
	    	"paste"
	  	],
	  	paste_as_text: true,
	  	toolbar1: "bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | code | preview",
	  	menubar: false,
	  	elementpath: false,
	  	toolbar_items_size: 'small',
	  	content_css: [
	    	'js/tinymce/skins/codepen.min.css'
	  	]
	});

var decodeEntities = function (encodedString) {
    var textArea = document.createElement('textarea');
    textArea.innerHTML = encodedString;
    return textArea.value;
}


$(document).ready(function() {

	
	$('#password').focusin(function(){
		$('#passwordInfo').toggle();
	});

	$('#password').focusout(function(){
		$('#passwordInfo').toggle();
	});
	

	$('#password').change(validPassword);
	$('#password2').change(validPassword);

	$('#syncQuickbooksAccounts').click(syncQuickbooksAccounts);
	$('#closeSyncCutomersModal').click(closeSyncCutomersModal);
	$('#saveSyncCutomersModal').click(saveSyncCutomersModal);
	

	$('#cancelAddWarrantyBody').click(function(){
		$('input[name="warrantyName"]').val('');
		$('#optCertificate').prop('checked', 'true');
		$('#optCertificate').val('0');
		tinyMCE.activeEditor.setContent("");
		$('#warrantyError').removeClass('is-visible');
		$('input[name="warrantyName"]').removeClass('is-invalid-input');	
		$('#addWarrantyNameError').removeClass('is-visible');
		$('#addWarrantyModal').foundation('close');

	});

	$('#resetPasswordConfirmed').click(function(){

		// var userEmail = $('input[name="userEmail"]').val();
		// var userID = $('input[name="userID').val();

		// var emailResetData = new FormData();
	 //        emailResetData.append('userEmail', userEmail);
	 //        emailResetData.append('userID', userID);
	       
	 		$('#loading-image').show();

	        $.ajax({
	        	url: 'reset-password.php',
	            dataType: "json",
	            contentType: 'application/json',
	            type: "POST",
	            contentType: "application/x-www-form-urlencoded",
	            data:{
	            	userEmail: $('input[name="userEmail"]').val(),
	            	userID: $('input[name="userID"]').val()
	            },
				success: function(response) {
					// var response = jQuery.parseJSON(response);
					// console.log(response);
					if(response =="OK"){
						document.getElementById('passwordResetUserName').innerHTML='';

						$('#resetPasswordConfirm').foundation('close');
						$('#passwordResetUserName').append($('input[name="userFirstName"]').val());
						$('#loading-image').hide();

						$('#resetPasswordEmailSent').foundation('open');

					}
					

				},
				error: function (jqXHR, textStatus, errorThrown) {
                        console.log(textStatus, errorThrown);
                        console.log(jqXHR.responseText);
                        $('#loading-image').hide();

                    }
            });
	  
	});

	selectedTab = '#general';
    contractModified = 0;
    
    function confirmExit() {
        if (contractModified == 1) {
        	$('#contractNotSavedModal').foundation('open');
            return; 
        }
        else{
			changeTab(selectedTab + 'TabLink', selectedTab);
			history.pushState(null, null, selectedTab);
        }
    }
    $('#saveContractText').click(function() {
        contractModified = 0;
    });

	//needed for Zendesk Help Ticket
	userInfo = {
	    name: "<?php echo $userFirstName;  ?>" + " <?php echo $userLastName;  ?>",
	    email: "<?php echo $userEmail;  ?>"
	}
    

	//Change websites to have prefix of 'http://'
	if ($('.website a').attr('href').substr(0, 7) != 'http://'){
		$('.website a').attr('href', 'http://' + $('.website a').attr('href'));
	}

	//Change tab when hash is present in link
	var link_tab = window.location.hash.substr(0);
	if(link_tab){
   		changeTab(link_tab + 'TabLink', link_tab);
	}

	$('#generalTabLink').on('click', function() {
		selectedTab = '#general';
		confirmExit();
	});

	$('#usersTabLink').on('click', function() {
		selectedTab = '#users';
		confirmExit();
	});

	$('#servicesTabLink').on('click', function() {
		selectedTab = '#services';
		confirmExit();
	});

	$('#pricingTabLink').on('click', function() {
		selectedTab = '#pricing';
		confirmExit();
	});

	$('#contractTabLink').on('click', function() {
		selectedTab = '#contract';
		confirmExit();
	});

	$('#emailsTabLink').on('click', function() {
		selectedTab = '#emails';
		confirmExit();
	});

	$('#finalPacketTabLink').on('click', function() {
		selectedTab = '#finalPacket';
		confirmExit();
	});

	$('#noSaveContract').click(function() {
		contractModified = 0;
		$.ajax({
			url: 'getContract.php',
			dataType: "json",
			contentType: 'application/json',
			type: "POST",
			contentType: "application/x-www-form-urlencoded",
			success: function(response) {
				if(!response == ''){
					var content = $('<div/>').html(response.contractText).text();
					tinymce.get('contractText').getBody().innerHTML = content;
					changeTab(selectedTab + 'TabLink', selectedTab);
					history.pushState(null, null, selectedTab);
				}
			}
		});
		$('#contractNotSavedModal').foundation('close');
	});

	$('#editCompanyProfileModal .addPhone').click(addPhoneRowCompany);
   	$('#editCompanyProfileModal .deletePhone').click(deletePhoneRowCompany);
   	$('#editCompanyProfileModal input.isPrimary').change(isPrimaryCheckCompany);
	$('#editCompanyProfile').click(editCompanyProfile);
	$('#closeEditCompanyProfile').click(closeEditCompanyProfile);
  	$('#saveEditCompanyProfile').click(saveEditCompanyProfile);
  	$('#addBillingAddress').click(addBillingAddress);
  	$('#continueMissingInformation').click(editCompanyProfile);

  	$('#addWarranty').click(function(){
  		var pageHeight = $( window ).height() * .85;

		//Display Modal
		$('#addWarrantyModal').css('max-height',pageHeight);
		$('#optCertificate').prop('checked', 'true');
        $('#addWarrantyModal').foundation('open');

  	});

  	// $('#saveAddWarranty').click(saveAddWarranty);
  	// $('#cancelAddWarranty').click(cancelAddWarranty);
  	$('#cancelWarrantyCoordinates').click(cancelWarrantyCoordinates);
  	$('#saveWarrantyCoordinates').click(saveWarrantyCoordinates);
  	$('#yesDeleteWarranty').click(yesDeleteWarranty);
  	$('#cancelDeleteWarranty').click(cancelDeleteWarranty);
  	// $('#saveEditWarranty').click(saveEditWarranty);
  	$('#cancelEditWarrantyBody').click(cancelEditWarranty);

  	$('#addDisclaimer').click(function(){
  		var pageHeight = $( window ).height() * .85;

		//Display Modal
		$('#addDisclaimerModal').css('max-height',pageHeight);
        $('#addDisclaimerModal').foundation('open');

  	});

  	$('#saveAddDisclaimer').click(saveAddDisclaimer);
  	$('#cancelAddDisclaimer').click(cancelAddDisclaimer);
  	$('#yesDeleteDisclaimer').click(yesDeleteDisclaimer);
  	$('#cancelDeleteDisclaimer').click(cancelDeleteDisclaimer);
  	$('#saveEditDisclaimer').click(saveEditDisclaimer);
  	$('#cancelEditDisclaimer').click(cancelEditDisclaimer);


  	$('#userPhoneTable .addPhone').click(addPhoneRowUser);
   	$('#userPhoneTable .deletePhone').click(deletePhoneRowUser);
   	$('#userPhoneTable input.isPrimary').change(isPrimaryCheckUser);

   	$('#cancelNewUser').click(cancelNewUser);
   	$('#cancelExistingUser').click(cancelExistingUser);

   	$('#quickbooksSettings').click(quickbooksSettings);

   	$('#saveQuickbooksSettings').click(saveQuickbooksSettings);
   	$('#closeQuickbooksSettings').click(closeQuickbooksSettings);

   	if ('<?php echo $quickbooksStatus; ?>' == '1') {
   		if ('<?php echo $quickbooksDefaultService; ?>' == '') {
   			quickbooksSettings();
   			//$('#quickbooksSettingsModal').foundation('open');
   		}
   	}

   	$('.userEdit').change(function(){
   		$(this).addClass('changed');
   	});

  	$('#addNewLogo').click(function(){
  		$('#newLogoUpload').show();
  		$('#addNewLogo').hide();
  	});

  	$('#addNewPhoto').click(function(){
  		$('#newPhotoUpload').show();
  		$('#addNewPhoto').hide();
  	});

  	$('#editCompanyProfileModal .required').change(function(){
  		if ($(this).val != ''){
  			$(this).parent().removeClass('is-invalid-label');
			$(this).removeClass('is-invalid-input');
			$(this).parent().find('.form-error').removeClass('is-visible');
		}
  	});

  	$('#changePassword').click(function() {
  		$('#changePasswordInput').slideToggle('2000','swing');
  		$('#changePassword').text($(this).text() == 'Change Password' ? "Keep Existing Password" : "Change Password");
	});

  	$('#resetPassword').click(function(){

  		//show confirm modal
  		$('#resetUserName').innerHTML='';
  		$('#resetUserName').text($('input[name="userFirstName"]').val() + " " + $('input[name="userLastName"]').val() +'?');
  		$('#resetPasswordConfirm').foundation('open');

  	});

	$('input[required], select[required], input[name="warrantyName"], input[name="warrantyFile"], input[name="disclaimerName"], textarea[name="disclaimer"], select[name="disclaimerSection"], textarea[name="addWarrantyBody"], select[name="quickbooksDefaultService"]').change(function(){
        if ($(this).val() == ''){
            $(this).parent().addClass('is-invalid-label');
            $(this).addClass('is-invalid-input');
            $(this).parent().find('.form-error').addClass('is-visible');
        } else {
            $(this).parent().removeClass('is-invalid-label');
            $(this).removeClass('is-invalid-input');
            $(this).parent().find('.form-error').removeClass('is-visible');
        }
    });

	//Get Company Warranties
    companyWarranties();

    //Get Company Disclaimers
    companyDisclaimers();


    // $('#warrantyCoordinatesModal .warranty-preview img').click(getClickPositionAdd);
    // $('#warrantyEditModal .warranty-preview img').click(getClickPositionEdit);
    // $('#warrantyCoordinatesModal input[name="addressPosition"]').change(getClickPositionAdd);

    // $('#warrantyEditModal input[name="addressPosition"]').change(getClickPositionEdit);


    //Show Setup Modal if Clicked in Top Nav
    $('#showSetup').click(showSetupModal);

    //Show Setup Modal On Page Load if it Hasn't Been Viewed Since Yesterday
    showSetupModal('true');

    //Update Last Viewed When Modal Opens
    $('#setupModal').on('open.zf.reveal', function() {
        $.ajax({
            url: 'setupProgressUpdate.php',
            dataType: "json",
            contentType: 'application/json',
            type: "POST",
            contentType: "application/x-www-form-urlencoded",
            data: {
                updateSetupNotice: 'true'
            },
            success: function (response) {
                //console.log(response);
                // if (response == 'true') {
                // }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.log(textStatus, errorThrown);
                console.log(jqXHR.responseText);
            }
        });

    });

    //Update Checkmarks When Clicked
    $('img.setupProgressCheckmark').click(updateChecks);

    //Stop Showing Setup Modal
    $('#setupComplete').click(setupComplete);


	// //Text Area Click Part of Tag and Highlight Entire Tag
	// var textarea = document.getElementById('contractText');
 //    textarea.onclick = textarea_Click;

	//  function textarea_Click(e) {
 //        var caret = getCaretPosition();
 //        var text = textarea.value;
 //        var begin = caret - 1;
 //        while (begin >= 0) {
 //            if (text.charAt(begin) == '}') return;
 //            else if (text.charAt(begin) == '{') break;
 //            else begin--;
 //        }

 //        if (begin >= 0) {
 //            var end = caret;
 //            while (end < text.length) {
 //                if (text.charAt(end) == '}') break;
 //                else end++;
 //            }

 //            if (end < text.length)
 //                setSelection(begin, end);
 //        }
 //    }


 //    function getCaretPosition() {
 //        if (textarea.selectionStart) {
 //            return textarea.selectionStart;
 //        } else {
 //            // TODO: Handle IE ugliness on your own :)
 //            return 0;
 //        }
 //    }

 //    function setSelection(begin, end) {
 //        if ("selectionStart" in textarea) {
 //            textarea.selectionStart = begin;
 //            textarea.selectionEnd = end + 1;
 //        } else if (document.selection) {
 //            // TODO: Handle IE ugliness on your own :)
 //            return;
 //        }
 //    }

 

	function htmlDecode(value) {
  		return $("<textarea/>").html(value).text();
	};

	$('#contractText').keyup(function (e) {
		if (e.keyCode == 8) {
			console.log('Deleted');
			//e.preventDefault();
//			var text = $(this).val().split(' ');
//
//			text.splice(text.length-1);
//
//			$(this).val(text.join(' '));
		}
	});

	$('#contractText').change(function(){
		$('#contractText').removeClass('is-invalid-input');
		$('#contractText').parent().removeClass('is-invalid-label');
		$('#contractText').parent().find('.form-error').removeClass('is-visible');
	});


	


	//User Color Pallette Picker
	$("#showPalette").spectrum({
		preferredFormat: "hex",
	    color: "",
	    showPaletteOnly: true,
	    hideAfterPaletteSelect:true,
	    change: function(color) {
	        var color = $("#showPalette").spectrum("get").toHexString();
			$('input[name="calendarBgColor"]').val(color);

			if (!$('.userList#0').hasClass('active')) {
				$('input[name="calendarBgColor"]').addClass('changed');
			}
	    },
	    palette: [
	    	["#000000"],

	        ["#191ab3", "#0033cc", "#0165b3", "#01989b", "#a0d3e8"],

	        ["#02b366", "#00cc00", "#33fe00", "#99fe00", "#cbff00"],

	        ["#feff00", "#ffe500", "#ffcd00", "#ffb200", "#fe9900"],

	        ["#fe8000", "#fe6600", "#ff3300", "#fd0000", "#e60065"],

	        ["#cc0099", "#970099", "#65009e", "#42009a", "#310199"]

	    ]
	});



	//Get Services Data and Populate Fields
	$.ajax({
		url: 'getCompanyServices.php',
		dataType: "json",
		contentType: 'application/json',
		type: "POST",
		contentType: "application/x-www-form-urlencoded",
		success: function(response) {
			//console.log(response);
			if(!response == ''){
				$.each(response, function(key, value){
					$(document).find('input[name="'+key+'"], textarea[name="'+key+'"], select[name="'+key+'"]').each(function() {
						var $this = $(this);

						switch(this.type)
						{
						case 'select-one':
						case 'select-multiple':
							$this.find("option[value='"+value+"']").attr('selected', true);
							break;
						case 'text':
						case 'textarea':
							$this.val(htmlDecode(value));
							break;
						case 'checkbox':
						case 'radio':
							if($(this).val() == value) {
								this.checked = true;
								//console.log($this.attr('id'));
								//add class show to child - everything with attribute parent = "id" - set calss to show
								if (!$this.attr('id') == "" ) $('.servicesAnswer[parent="'+key+'"]').addClass('show');
							}
						}
					});
				});
			}
		}
	});

	//Get Pricing Data and Populate Fields
	$.ajax({
		url: 'getCompanyPricing.php',
		dataType: "json",
		contentType: 'application/json',
		type: "POST",
		contentType: "application/x-www-form-urlencoded",
		success: function(response) {
			if(!response == ''){
				$.each(response, function(key, value){
					$(document).find('input[name="'+key+'"], textarea[name="'+key+'"], select[name="'+key+'"]').each(function() {
						var $this = $(this);

						switch(this.type)
						{
						case 'select-one':
						case 'select-multiple':
							$this.find("option[value='"+value+"']").attr('selected', true);
							break;
						case 'text':
						case 'textarea':
							$this.val(value);
							break;
						case 'checkbox':
						case 'radio':
							if($(this).val() == value) {
								this.checked = true;
								//console.log($this.attr('id'));
								//add class show to child - everything with attribute parent = "id" - set calss to show
								if (!$this.attr('id') == "" ) $('.servicesAnswer[parent="'+key+'"]').addClass('show');
							}
						}
					});
				});
			}
		}
	});

	$.ajax({
		url: 'getPricingTables.php',
		dataType: "json",
		contentType: 'application/json',
		type: "POST",
		contentType: "application/x-www-form-urlencoded",
		success: function (response) {
			//console.log(response);
			if(!response == ''){
				$.each(response, function (i, item) {

					$cloneRow = $('.'+item.tableType+' tbody tr:first').clone().css('display','');

					$cloneRow.find('input[type=hidden]').val(item.id);
					$cloneRow.find('input.pricingAnswer.Sort').val(item.sort);

					if ($cloneRow.find('select.ManufacturerItemID').has('option[value="' + item.manufacturerItemID + '"]').length > 0)
                   		$cloneRow.find('select.ManufacturerItemID > option[value="' + item.manufacturerItemID + '"]').attr('selected', 'selected');

					$cloneRow.find('input.pricingAnswer.Name').val(htmlDecode(item.name));
					$cloneRow.find('textarea.pricingAnswer.Description').val(htmlDecode(item.description));
					$cloneRow.find('input.pricingAnswer.Price').val(item.price);

					$('.'+item.tableType+' tbody').append($cloneRow);
					$('.'+item.tableType+' tbody > tr:last-child input, .'+item.tableType+' tbody > tr:last-child select, .'+item.tableType+' tbody > tr:last-child textarea').change(ajaxPricingSave);
					$('.'+item.tableType+' tbody > tr:last-child a.deleteRow').click(openDeleteModal);

				});

				$('.cpTable').each(function() {
					oldRow = $(this).find('tbody > tr:last-child input.Sort').val();
					if (oldRow != '') {
						var newRow = parseFloat(oldRow) + 1;
					} else {
						var newRow = 1;
					}

					$cloneBlankRow = $(this).find('tbody tr:first').clone().css('display','');
					$(this).find('tbody').append($cloneBlankRow);
					$(this).find('tbody > tr:last-child input.Sort').val(newRow);
					$(this).find('tbody > tr:last-child input, tbody > tr:last-child select, tbody > tr:last-child textarea').change(ajaxPricingSave);
					$(this).find('tbody > tr:last-child a.deleteRow').click(openDeleteModal);

				});
			} else {
				$('.cpTable').each(function() {
					oldRow = $(this).find('tbody > tr:last-child input.Sort').val();
					if (oldRow != '') {
						var newRow = parseFloat(oldRow) + 1;
					} else {
						var newRow = 1;
					}

					$cloneBlankRow = $(this).find('tbody tr:first').clone().css('display','');
					$(this).find('tbody').append($cloneBlankRow);
					$(this).find('tbody > tr:last-child input.Sort').val(newRow);
					$(this).find('tbody > tr:last-child input, tbody > tr:last-child select, tbody > tr:last-child textarea').change(ajaxPricingSave);
					$(this).find('tbody > tr:last-child a.deleteRow').click(openDeleteModal);
				});
			}

		 },
		 error: function(jqXHR, textStatus, errorThrown) {
			$('.cpTable').each(function() {
				oldRow = $(this).find('tbody > tr:last-child input.Sort').val();
				if (oldRow != '') {
						var newRow = parseFloat(oldRow) + 1;
					} else {
						var newRow = 1;
					}

				$cloneBlankRow = $(this).find('tbody tr:first').clone().css('display','');
				$(this).find('tbody').append($cloneBlankRow);
				$(this).find('tbody > tr:last-child input.Sort').val(newRow);
				$(this).find('tbody > tr:last-child input, tbody > tr:last-child select, tbody > tr:last-child textarea').change(ajaxPricingSave);
				$(this).find('tbody > tr:last-child a.deleteRow').click(openDeleteModal);
			});
		 }
	});



	$('#inactive').change(getUsers);

	$("li.userList").click(function(){
		userID = $(this).attr('id');

		viewSettings(userID);
	});

	// $("input.passwordMatch").focusout(checkPassword);

	$("#submitNewUser").click(submitNewUser);

	$("#updateExistingUser").click(updateExistingUser);

	//Update Services on Change
	$("input.servicesAnswer, textarea.servicesAnswer, select.servicesAnswer").change(ajaxServicesSave);

	//Update Pricing on Change
	$("input.pricingAnswer, select.pricingAnswer, textarea.pricingAnswer").change(ajaxPricingSave);

	//Delete Pricing Table Row on Click
	$("#yesDeleteRow").click(ajaxPricingDeleteRow);



	$(".addUser").click(function() {
		if (!$('.userList#0').hasClass('active')) {
			$('#loading-image').show();

			//Look Up Total Users
			$.ajax({
		    	url: 'getUserCount.php',
		    	dataType: "json",
		    	contentType: 'application/json',
		    	type: "POST",
		    	contentType: "application/x-www-form-urlencoded",
		    	success: function(response) {
					//console.log(response);
					if(!response == ''){
						var totalUserCount = response.totalActiveUsers;
						var totalUsersPaid = Number('<?php echo $totalUsersPaid; ?>');

						$('#loading-image').hide();

						if (totalUserCount < totalUsersPaid) {
							addNewUserRow();
						} else {
							$('#usersExceededModal').foundation('open');
						}
					}
				},
				 error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
				}
		    });
		}
		
	});
});
//End of Document Ready

var syncQuickbooksAccounts = function() {
	$('#loading-image').show();

	$.ajax({
    	url: 'getCustomers.php',
    	dataType: "json",
    	contentType: 'application/json',
    	type: "POST",
    	contentType: "application/x-www-form-urlencoded",
    	success: function(response) {
			//console.log(response);

			if (response != null) {	
                $.each(response, function (i, item) {

                	if (item.quickbooksID == null) {
                		item.quickbooksID = ''; 
                	}

                    $('#syncCustomersTable .link select').append('<option quickbooks="'+item.quickbooksID+'" value="'+item.customerID+'">'+item.firstName+' '+item.lastName+' - '+item.ownerAddress+'</option>');

                });

                $.ajax({
			    	url: 'getQuickbooksCustomers.php',
			    	dataType: "json",
			    	contentType: 'application/json',
			    	type: "POST",
			    	contentType: "application/x-www-form-urlencoded",
			    	success: function(response) {
						//console.log(response);

						 if (response != null) {
			                $.each(response, function (i, item) {

			                    $cloneRow = $('#syncCustomersTable tbody tr:first').clone().css('display', '');

			                    $cloneRow.find('.name').text(item.customerName);
			                    $cloneRow.find('.address').text(item.address);
			                    $cloneRow.find('.link').attr('quickbooks',item.customerID);

			                    if ($cloneRow.find('.link select').has('option[quickbooks="' + item.customerID + '"]').length > 0)
			                        $cloneRow.find('.link select > option[quickbooks="' + item.customerID + '"]').prop('selected', true);

			                    $('#syncCustomersTable tbody').append($cloneRow);
			                    //$('.crackRepairTable tbody > tr:last-child select').change(saveAnswer);

			                });

			                var pageHeight = $( window ).height() * .85;
							$('#syncCustomersModal').css('height',pageHeight);		

							$('#loading-image').hide();

			                $('#syncCustomersModal').foundation('open');
			            } 

					},
					 error: function(jqXHR, textStatus, errorThrown) {
			  				console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
					}
			    });

            } 

		},
		 error: function(jqXHR, textStatus, errorThrown) {
  				console.log(textStatus, errorThrown);
				console.log(jqXHR.responseText);
		}
    });
	
};

var closeSyncCutomersModal = function(){
	$('#syncCustomersTable tbody tr').not(':first').remove();
	$('#syncCustomersModal').foundation('close');
};

var saveSyncCutomersModal = function(){
	var quickbooksSyncArray = storeQuickbooksTableData();
    
    function storeQuickbooksTableData() {
        var quickbooksSyncTableData = new Array();
        $('#syncCustomersTable tbody tr').each(function(row,tr){
            quickbooksSyncTableData[row]={
                "customerID":$(tr).find('td:eq(2)').find('select').val(),
                "quickbooksID":$(tr).find('td:eq(2)').attr('quickbooks')
            };
        });
        quickbooksSyncTableData.shift();
        var quickbooksSyncTableArray = quickbooksSyncTableData;
        quickbooksSyncTableArray = JSON.stringify(quickbooksSyncTableArray);    
        return quickbooksSyncTableArray;
    }

    $.ajax({
    	url: 'syncCustomers.php',
    	dataType: "json",
    	contentType: 'application/json',
    	type: "POST",
    	contentType: "application/x-www-form-urlencoded",
    	data: {
    		quickbooksSyncArray: quickbooksSyncArray
    	},
    	success: function(response) {
			//console.log(response);

			if (response == 'true') {	
               	$('#syncCustomersTable tbody tr').not(':first').remove();
				$('#syncCustomersModal').foundation('close');
            } 

		},
		 error: function(jqXHR, textStatus, errorThrown) {
  				console.log(textStatus, errorThrown);
				console.log(jqXHR.responseText);
		}
    });
};

var quickbooksSettings = function(){
	$('#loading-image').show();

	$.ajax({
    	url: 'getQuickbooksSettings.php',
    	dataType: "json",
    	contentType: 'application/json',
    	type: "POST",
    	contentType: "application/x-www-form-urlencoded",
    	success: function(response) {
			//console.log(response);

			if (response != null) {
				//console.log(response.items);

                $.each(response.items, function (i, item) {
	            	$('#quickbooksSettingsModal select[name="quickbooksDefaultService"]').append('<option value="'+item.itemID+'">'+item.itemName+'</option>');

                });

                $.each(response.settings, function (i, item) {
	            	var quickbooksDefaultService = item.quickbooksDefaultService;
	            	
	            	if (quickbooksDefaultService == null) {
	                	$('#closeQuickbooksSettings').prop('disabled',true);
	                } else {
	                	$('#quickbooksSettingsModal select[name="quickbooksDefaultService"]').find('option[value="'+quickbooksDefaultService+'"]').prop('selected','selected');
	                }
                });

    			// var pageHeight = $( window ).height() * .85;
				// $('#quickbooksSettingsModal').css('height',pageHeight);		

				$('#loading-image').hide();

                $('#quickbooksSettingsModal').foundation('open');
            } 

		},
		 error: function(jqXHR, textStatus, errorThrown) {
  				console.log(textStatus, errorThrown);
				console.log(jqXHR.responseText);
		}
    });
};

var saveQuickbooksSettings = function(){

	var quickbooksDefaultService = $('select[name="quickbooksDefaultService"]').val();

	if (quickbooksDefaultService == '') {
		$('select[name="quickbooksDefaultService"]').addClass('is-invalid-input');
		$('select[name="quickbooksDefaultService"]').parent().addClass('is-invalid-label');
		$('select[name="quickbooksDefaultService"]').parent().find('.form-error').addClass('is-visible');
	} else {
		$('select[name="quickbooksDefaultService"]').removeClass('is-invalid-input');
		$('select[name="quickbooksDefaultService"]').parent().removeClass('is-invalid-label');
		$('select[name="quickbooksDefaultService"]').parent().find('.form-error').removeClass('is-visible');
	}

	if (!$('select[name="quickbooksDefaultService"]').hasClass('is-invalid-input')) {
		$.ajax({
	    	url: 'quickbooks-settings-edit.php',
	    	dataType: "json",
	    	contentType: 'application/json',
	    	type: "POST",
	    	contentType: "application/x-www-form-urlencoded",
	    	data:{
	    		quickbooksDefaultService: quickbooksDefaultService
	    	},
	    	success: function(response) {
				//console.log(response);
				if (response == 'true') {
					$('select[name="quickbooksDefaultService"]').val('');
					$('#closeQuickbooksSettings').prop('disabled',false);

					$('#quickbooksSettingsModal').foundation('close');
				}

			},
			error: function(jqXHR, textStatus, errorThrown) {
	  				console.log(textStatus, errorThrown);
					console.log(jqXHR.responseText);
			}
	    });
	}
};

var closeQuickbooksSettings = function(){
	$('select[name="quickbooksDefaultService"]').removeClass('is-invalid-input');
	$('select[name="quickbooksDefaultService"]').parent().removeClass('is-invalid-label');
	$('select[name="quickbooksDefaultService"]').parent().find('.form-error').removeClass('is-visible');

	$('select[name="quickbooksDefaultService"]').val('');

	$('#quickbooksSettingsModal').foundation('close');
};

var addNewUserRow = function(){

	if (!$('.userList#0').hasClass('active')) {

		var settings = $('.cp-user-settings .cp-user-settings-container').addClass('new');

		$(settings).find('input[name="userFirstName"]').val('');
		$(settings).find('input[name="userLastName"]').val('');
		$(settings).find('input[name="userEmail"]').val('');
		$(settings).find('input[name="userPassword"]').val('');
		$(settings).find('input[name="userPassword2"]').val('');
		$(settings).find('input[name="userPhoneDirect"]').val('');
		$(settings).find('input[name="userPhoneCell"]').val('');
		$(settings).find('input[name="userID"]').val('0');
		$(settings).find('input[name="primary"]').prop('checked', false);
		$(settings).find('input[name="projectManagement"]').prop('checked', false);
		$(settings).find('input[name="marketing"]').prop('checked', false);
		$(settings).find('input[name="sales"]').prop('checked', false);
		$(settings).find('input[name="installation"]').prop('checked', false);
		$(settings).find('input[name="bidVerification"]').prop('checked', false);
		$(settings).find('input[name="bidCreation"]').prop('checked', false);
		$(settings).find('input[name="pierDataRecorder"]').prop('checked', false);
		$(settings).find('input[name="timecardApprover"]').prop('checked', false);
		$(settings).find('input[name="userActive"]').prop('checked', true);
		$(settings).find('textarea[name="userBio"]').val('');
		$(settings).find('input[name="calendarBgColor"]').val('#000000');

		//Reset Photo
		$(settings).find('#currentPhoto').text('');
		$(settings).find('#newPhotoUpload').show();
		$(settings).find('#addNewPhoto').hide();
		$('.cp-user-settings-container input[name="userPhoto"]').val('');

		//Reset Phone Table
		$('#userPhoneTable tbody tr').not(':first').remove();

		//Add Row For Phone
		addPhoneRowUser();

		$('#userPhoneTable tbody tr:nth-child(2) td.primary input.isPrimary').prop('checked', true);

		//Reset Color Palette
		$("#showPalette").spectrum("set", '');

		//Set ID to 0
		$(settings).find('.cp-user-form').attr('id', '0');

		var obj = $('<li class="userList" id="0"></li>').text('New User');
		$('.cp-users ul').append(obj);

		$('.cp-users ul li.userList').removeClass('active');
		$('.cp-users ul li:last').addClass('active');

		//Show Password Boxes
		if($('#changePasswordInput').is(':hidden')){
	 		$('#changePasswordInput').slideDown();
		}
		// $(settings).find('#changePassword').hide();
		$(settings).find('#resetPassword').hide();
	}

};

var changeTab = function(tabLink, tabContent ){
	$('#project-tabs li').each(function(){
		$(this).removeClass('is-active');
		$(this).find('a').removeAttr('aria-selected');
	});

	$('.tabs-content div').each(function (){
		$(this).removeClass('is-active')
	});

	$(tabContent).addClass('is-active');
	$(tabLink).parent().addClass('is-active');
	$(tabLink).attr('aria-selected', 'true');
}

var disableCancelButton = false;

var getUsers = function() {

	//console.log('users');
	// $('#loading-image').show();

	$('.cp-users ul li').remove();

	if ($('#inactive').is(':checked')) { var inactive = '1' }
	else { var inactive = '0'}

	$.ajax({
    	url: 'getUserData.php',
    	dataType: "json",
    	contentType: 'application/json',
    	type: "POST",
    	contentType: "application/x-www-form-urlencoded",
   	 	data: {
			inactive: inactive,
    	},
    	success: function(response) {
			//console.log(response);
			if(!response == ''){

				$.each(response, function (i, item) {
					//console.log(i, item);

					var obj = $('<li class="userList"></li>').attr('id', item.userID).text( decodeEntities(item.userFirstName) + ' ' + decodeEntities(item.userLastName) ).data('info', item);

					$('.cp-users ul').append(obj);

					if (item.userActive == '0') {
						$('li.userList[id='+item.userID+']').append('<small style="float:right;font-style:italic;margin: .3rem 0 0 0;">Inactive</small>');
					}

					$('.cp-users ul li.userList[id='+item.userID+']').click(function(){

						viewSettings(item.userID);
					});

					// $("input.passwordMatch").change(checkPassword);

					$.ajax({
						url: 'getUserPhone.php',
						dataType: "json",
						contentType: 'application/json',
						type: "GET",
						contentType: "application/x-www-form-urlencoded",
						data: {
							userID: item.userID,
    					},
						success: function(response) {
							$('li.userList[id="'+item.userID+'"]').data("phone",response);
							// $('#loading-image').hide();

						}, error: function(jqXHR, textStatus, errorThrown) {
			  				console.log(textStatus, errorThrown);
							console.log(jqXHR.responseText);
							
						}

					}).done(function(){
			          showFirstUser();
			      });

				});

			}

		}

	}).done(function(){
          $('.cp-users ul li:eq(0)').addClass('active');
      });


};


	window.onload = getUsers;

var showFirstUser = function() {

	$('.cp-users ul li.userList.active').click();
	$('#loading-image').hide();
	if ('<?php echo $companyEmailFrom; ?>' == '' || '<?php echo $companyEmailReply; ?>' == '' || '<?php echo $defaultInvoices; ?>' == '' || '<?php echo $invoiceSplitBidAcceptance; ?>' == '' || '<?php echo $invoiceSplitProjectComplete; ?>' == ''){
		disableCancelButton = true;
		$('#missingInformationModal').foundation('open');
	}

};


var viewSettings = function(userID) {

	 id = userID;

	if ($('.userList#0').hasClass('active')) {

		$('#leaveBeforeSavingNewModal #moveToUserID').val(id);
		$('#leaveBeforeSavingNewModal').foundation('open');

	} else {

		if ($('.userEdit').hasClass('changed')) {
			$('#leaveBeforeSavingExistingModal #moveToUserID').val(id);
			$('#leaveBeforeSavingExistingModal').foundation('open');

		} else {

			$('.cp-user-settings .cp-user-settings-container').removeClass('new');

			$('#userPhoneSection small.onePhone').removeClass('is-visible');
			$('#userPhoneSection small.fullPhone').removeClass('is-visible');
			$('#userPhoneSection small.primary').removeClass('is-visible');

			$('.cp-user-settings .cp-user-settings-container').find('.cp-user-form .errorMsg').empty();
			
			$('.cp-users ul li.userList').removeClass('active');

			$('.cp-users ul').find('li.userList[id="'+id+'"]').addClass('active');
			
			//Clear Password Fields
			// $('.cp-user-settings .cp-user-settings-container').find('input[name="userPassword"]').val('');
			// $('.cp-user-settings .cp-user-settings-container').find('input[name="userPassword2"]').val('');
				if(!$('#resetPassword').is(':visible')){
					$('#resetPassword').show();
				}

			//Reset Photo
			$('.cp-user-settings .cp-user-settings-container').find('.cp-user-form #newPhotoUpload').hide();
			$('.cp-user-settings .cp-user-settings-container').find('.cp-user-form #addNewPhoto').show();
			$('.cp-user-settings-container input[name="userPhoto"]').val('');

			//Reset Phone Table
			$('#userPhoneTable tbody tr').not(':first').remove();

			//Collapse Password Boxes
			if($('#changePasswordInput').is(':visible')){
		     	$('#changePasswordInput').slideUp();
		     	$('#changePassword').text($(this).text() == 'Change Password' ? "Keep Existing Password" : "Change Password");
			}
			
			// $('.cp-user-settings .cp-user-settings-container').find('#changePassword').show();

			//show the reset password link instead




			var settings = $('.cp-user-settings .cp-user-settings-container');

			$(settings).find('input[name="userFirstName"]').val($('li.userList.active').data('info').userFirstName);
			$(settings).find('input[name="userLastName"]').val($('li.userList.active').data('info').userLastName);
			$(settings).find('input[name="userEmail"]').val($('li.userList.active').data('info').userEmail);
			$(settings).find('input[name="userPhoneDirect"]').val($('li.userList.active').data('info').userPhoneDirect);
			$(settings).find('input[name="userPhoneCell"]').val($('li.userList.active').data('info').userPhoneCell);
			$(settings).find('input[name="userID"]').val($('li.userList.active').data('info').userID);
			$(settings).find('textarea[name="userBio"]').val($('li.userList.active').data('info').userBio);
			$(settings).find('.cp-user-form').attr('id', $('li.userList.active').data('info').userID);

			//Set User Photo
			var userPhoto = $('li.userList.active').data('info').userPhoto;
			var userID = $('li.userList.active').data('info').userID;
			
			if (userPhoto == '' || userPhoto == null) {
				$('#currentPhoto').html('');
				$('#newPhotoUpload').show();
		  		$('#addNewPhoto').hide();
			} else {
		  		$('#currentPhoto').html('<img src="image.php?type=userimage&cid=<?php echo $companyID; ?>&uid='+userID+'&type=userimage&name='+userPhoto+'" style="height:10rem;margin-bottom:.5rem;" />');
			}

			//Set Color
			var newColor = $('li.userList.active').data('info').calendarBgColor;
			$("#showPalette").spectrum("set", newColor);

			var color = $("#showPalette").spectrum("get").toHexString();
				$('input[name="calendarBgColor"]').val(color);
				id = $('li.userList.active').data('info').userID;

			if ($('li.userList.active').data('info').primary == 1) { $(settings).find('input[name="primary"]').prop('checked', true); }
			else { $(settings).find('input[name="primary"]').prop('checked', false); }
			
			if ($('li.userList.active').data('info').projectManagement == 1) $(settings).find('input[name="projectManagement"]').prop('checked', true);
			else $(settings).find('input[name="projectManagement"]').prop('checked', false);

			if ($('li.userList.active').data('info').marketing == 1) $(settings).find('input[name="marketing"]').prop('checked', true);
			else $(settings).find('input[name="marketing"]').prop('checked', false);
			
			if ($('li.userList.active').data('info').sales == 1) $(settings).find('input[name="sales"]').prop('checked', true);
			else $(settings).find('input[name="sales"]').prop('checked', false);
			
			if ($('li.userList.active').data('info').installation == 1) $(settings).find('input[name="installation"]').prop('checked', true);
			else $(settings).find('input[name="installation"]').prop('checked', false);
			
			if ($('li.userList.active').data('info').bidVerification == 1) $(settings).find('input[name="bidVerification"]').prop('checked', true);
			else $(settings).find('input[name="bidVerification"]').prop('checked', false);
			
			if ($('li.userList.active').data('info').bidCreation == 1) $(settings).find('input[name="bidCreation"]').prop('checked', true);
			else $(settings).find('input[name="bidCreation"]').prop('checked', false);
			
			if ($('li.userList.active').data('info').pierDataRecorder == 1) $(settings).find('input[name="pierDataRecorder"]').prop('checked', true);
			else $(settings).find('input[name="pierDataRecorder"]').prop('checked', false);

			if ($('li.userList.active').data('info').timecardApprover == 1) $(settings).find('input[name="timecardApprover"]').prop('checked', true);
			else $(settings).find('input[name="timecardApprover"]').prop('checked', false);
			
			if ($('li.userList.active').data('info').userActive == 1) $(settings).find('input[name="userActive"]').prop('checked', true);
			else $(settings).find('input[name="userActive"]').prop('checked', false);
			
			//Set Phone Table
			var phones = $('li.userList.active').data('phone');

			$(phones).each(function(i, item) {
		    	
		    	$cloneRow = $('#userPhoneTable tbody tr:first').clone().css('display', '');
		  		$cloneRow.addClass('dbRow');
		        
		        if ($cloneRow.find('select.Description').has('option[value="' + item.phoneDescription + '"]').length > 0)
		            $cloneRow.find('select.Description > option[value="' + item.phoneDescription + '"]').attr('selected', 'selected');
		        	$cloneRow.find('input.Phone').val(item.phoneNumber);
		        
		        if (item.isPrimary == '1')
		            $cloneRow.find('input.isPrimary').prop('checked', true);

		        $cloneRow.find('select.Description').attr('sort', item.userPhoneID);
		        $cloneRow.find('input.Phone').attr('sort', item.userPhoneID);
		        $cloneRow.find('input.isPrimary').attr('sort', item.userPhoneID);
		        
		        $('#userPhoneTable tbody').append($cloneRow);
		        $('#userPhoneTable tbody > tr:last-child input.isPrimary ').click(isPrimaryCheckUser);
		        $('#userPhoneTable tbody > tr:last-child a ').click(deletePhoneRowUser);
		        $('#userPhoneTable').find('tbody > tr:last-child input.Phone').mask('(000) 000-0000');
	        	
	        	$('.userEdit').change(function(){
			   		$(this).addClass('changed');
			   	});
			});
		}
	}
};


	var addPhoneRowUser = function () {

        //oldRow = $('#userPhoneTable').find('tbody > tr:last-child input.isPrimary').attr('value');
        //var newRow = parseFloat(oldRow) + 1;

        $cloneBlankRow = $('#userPhoneTable').find('tbody tr:first').clone().css('display', '');
        $('#userPhoneTable').find('tbody').append($cloneBlankRow);
        $('#userPhoneTable').find('tbody > tr:last-child input.isPrimary').change(isPrimaryCheckUser);
        $('#userPhoneTable').find('tbody > tr:last-child .delete > a').click(deletePhoneRowUser);

        $('#userPhoneTable').find('tbody > tr:last-child input.Phone').mask('(000) 000-0000');

        //if ($('#userPhoneTable input.isPrimary').is(':not(:checked)'))
         if (!$('#userPhoneTable input.isPrimary:checked'))
            $('#userPhoneTable tbody tr:nth-child(2) td.primary input.isPrimary').prop('checked', true);
    };


    var deletePhoneRowUser = function () {

    	if ($(this).parent().parent().hasClass('dbRow')) {
    		$(this).parent().parent().find('select').attr('delete','delete');
    		$(this).parent().parent().css('display','none');

            if ($(this).parent().parent().find('input.isPrimary').is(':checked'))
                $('#userPhoneTable tbody tr:visible').eq(0).find('td.primary input.isPrimary').prop('checked', true);

	        if ($('#userPhoneTable tbody').children().length == 1)
	           	addPhoneRowUser();
    	} else {
    		$(this).parent().parent().remove();

    		if ($(this).parent().parent().find('input.isPrimary').is(':checked'))
                $('#userPhoneTable tbody tr:visible').eq(0).find('td.primary input.isPrimary').prop('checked', true);

	        if ($('#userPhoneTable tbody').children().length == 1)
	           addPhoneRowUser();
    	}

    };


    var isPrimaryCheckUser = function () {

        $('#userPhoneTable').find('input.isPrimary').prop('checked', false);
        $(this).prop('checked', true);

    };

// var checkPassword = function() {

// 	id = $(this).parents('form').parent('.cp-user-form').attr('id');

// 	//console.log(id);

// 	var password = $('.cp-user-form[id='+id+']').find('#password').val();
// 	var password2 = $('.cp-user-form[id='+id+']').find('#password2').val();

// 		//console.log(password);
// 		// console.log(password2);

// 	if (password != password2) {
// 		$('.cp-user-form[id='+id+']').find('#password').parent().addClass('is-invalid-label');
// 		$('.cp-user-form[id='+id+']').find('#password').addClass('is-invalid-input');
// 		$('.cp-user-form[id='+id+']').find('#password').parent().find('.error-match').addClass('is-visible');

// 		$('.cp-user-form[id='+id+']').find('#password2').parent().addClass('is-invalid-label');
// 		$('.cp-user-form[id='+id+']').find('#password2').addClass('is-invalid-input');
// 		$('.cp-user-form[id='+id+']').find('#password2').parent().find('.error-match').addClass('is-visible');

// 	} else {
// 		$('.cp-user-form[id='+id+']').find('#password').parent().removeClass('is-invalid-label');
// 		$('.cp-user-form[id='+id+']').find('#password').removeClass('is-invalid-input');
// 		$('.cp-user-form[id='+id+']').find('#password').parent().find('.error-match').removeClass('is-visible');

// 		$('.cp-user-form[id='+id+']').find('#password2').parent().removeClass('is-invalid-label');
// 		$('.cp-user-form[id='+id+']').find('#password2').removeClass('is-invalid-input');
// 		$('.cp-user-form[id='+id+']').find('#password2').parent().find('.error-match').removeClass('is-visible');
// 	}

// };



var validPassword = function(){

	var password = $('#password').val();
	var password2 = $('#password2').val();
	var errorMessage = '';
	var passwordErrors = false;


	if(password !='' && password2 !=''){
		if(password != password2){
			errorMessage +="<br> Your passwords do not match";
			passwordErrors = true;
		}
	}

				if (password.length < 8) {
			    	// echo strlen($userPassword);
			        errorMessage += " <br> Your password must contain at least 8 characters.";
			        passwordErrors = true;
			    }
			    
			    if(!password.match("[0-9]")) {
			        errorMessage += " <br> Your password must contain at least 1 number.";
			        passwordErrors = true;
			        // return false;
			    }

			    if(!password.match("[A-Z]")) {
			        errorMessage += " <br> Your password must contain at least 1 capital letter.";
			        passwordErrors = true;
			        // return false;
			    }
			    
			    if(!password.match("[a-z]")) {
			    	errorMessage += " <br> Your password must contain at least 1 lowercase letter.";
			    	passwordErrors = true;
			    	// return false;
			    }
			    
			    if(password.match(' ')) {
			    	errorMessage += " <br> Your password cannot contain spaces.";
			    	passwordErrors = true;
			    	// return false;
			    }

			    if (passwordErrors == true){
			    	showPasswordErrors(errorMessage);
			    	console.log("showerrors");
			    }else{
			    	errorMessage = "";
			    	hidePasswordErrors();
			    }
}

function showPasswordErrors(errorMessage){

	var passwordErrors = document.getElementById('passwordErrors');

	passwordErrors.innerHTML = '';

	$('#passwordErrors').append(errorMessage);
	$('#passwordErrors').show();

	$('#password').addClass('is-invalid-input');
	$('#password').parent().addClass('is-invalid-label');

	$('#password2').addClass('is-invalid-input');
	$('#password2').parent().addClass('is-invalid-label');

};

function hidePasswordErrors(){

	var passwordErrors = document.getElementById('passwordErrors');
	passwordErrors.innerHTML = '';

	$('#passwordErrors').hide();	

	$('#password').removeClass('is-invalid-input');
	$('#password').parent().removeClass('is-invalid-label');

	$('#password2').removeClass('is-invalid-input');
	$('#password2').parent().removeClass('is-invalid-label');

	$('#password').parent().find('.form-error').removeClass('is-visible');
	$('#password2').parent().find('.form-error').removeClass('is-visible');

}




var submitNewUser = function() {

	var addNewUser;

	if ($('input[name="userFirstName"]').val() == '' || $('input[name="userLastName"]').val() == '' || $('input[name="userEmail"]').val() == '') {
		addNewUser = 0;
		$('input.required').each(function(){
	        if ($(this).val() == '') {
	            $(this).parent().addClass('is-invalid-label');
	            $(this).addClass('is-invalid-input');
	            $(this).parent().find('.form-error').addClass('is-visible');
	        } else {
	            $(this).parent().removeClass('is-invalid-label');
	            $(this).removeClass('is-invalid-input');
	            $(this).parent().find('.form-error').removeClass('is-visible');
	        }
	    });

	} else {	
		if ($('input[name="userPassword"]').val() == '' || $('input[name="userPassword2"]').val() == '') {
			addNewUser = 0;
			$('input[name="userPassword"], input[name="userPassword2"]').each(function(){
		        if ($(this).val() == '') {
		            $(this).parent().addClass('is-invalid-label');
		            $(this).addClass('is-invalid-input');
		            $(this).parent().find('.pass-required').addClass('is-visible');
		             // $(this).parent().find('.form-error').addClass('is-visible');
		        } else {
		            $(this).parent().removeClass('is-invalid-label');
		            $(this).removeClass('is-invalid-input');
		            $(this).parent().find('.form-error').removeClass('is-visible');
		        }
		    });
		} else {
			if ($('#userPhoneTable tbody tr:visible').length > 0) {
				$('#userPhoneSection small.onePhone').removeClass('is-visible');
				
				$('#userPhoneTable tbody tr:visible').each(function(){
	  				if ($(this).find('td input.Phone').val() == '' || $(this).find('td select.Description').val() == '') {
	                	$('#userPhoneSection small.fullPhone').addClass('is-visible');
	                	addNewUser = 0;
		            } else {
		                $('#userPhoneSection small.fullPhone').removeClass('is-visible');
		                addNewUser = 1;
		            }
	  			}); 

	  			if (addNewUser == 1) {
	  				if ($('#userPhoneTable .isPrimary:checked').length < 1) {
			            $('#userPhoneSection small.primary').addClass('is-visible');
			            addNewUser = 0;
			        } else {
			            if ($('#userPhoneTable .isPrimary:checked').is(':visible')) {
			                $('#userPhoneSection small.primary').removeClass('is-visible');
			                addNewUser = 1;
			            } else {
			                $('#userPhoneSection small.primary').addClass('is-visible');
			                addNewUser = 0;
			            }
			        }
	  			}
	        } else {
	            $('#userPhoneSection small.onePhone').addClass('is-visible');
	            addNewUser = 0;
	        }
      		if (!isEmail($('input[name="userEmail"]').val())){
	  			$('input[name="userEmail"]').parent().addClass('is-invalid-label');
				$('input[name="userEmail"]').addClass('is-invalid-input');
				$('input[name="userEmail"]').parent().find('.form-error').addClass('is-visible');
				addNewUser = 0;
  			}
		}
	}

	//If required fields are filled in
	if (addNewUser == 1) {

		$('#loading-image').show();

		var form = $(this).parents('#myForm');
		var firstName = $(form).find('input[name=userFirstName]').val();
		var lastName = $(form).find('input[name=userLastName]').val();
		var email = $(form).find('input[name=userEmail]').val();
		var password = $(form).find('input[name=userPassword]').val();
		var primary = $(form).find('input[name=primary]');
		var projectManagement = $(form).find('input[name=projectManagement]');
		var marketing = $(form).find('input[name=marketing]');
		var sales = $(form).find('input[name=sales]');
		var installation = $(form).find('input[name=installation]');
		var bidVerification = $(form).find('input[name=bidVerification]');
		var bidCreation = $(form).find('input[name=bidCreation]');
		var pierDataRecorder = $(form).find('input[name=pierDataRecorder]');
		var timecardApprover = $(form).find('input[name=timecardApprover]');
		var calendarBgColor = $(form).find('input[name=calendarBgColor]').val();
		var userBio = $(form).find('textarea[name="userBio"]').val();
		var active = $(form).find('input[name=userActive]');

		//Decode
		firstName = decodeEntities(firstName);
		lastName = decodeEntities(lastName);
		userBio = decodeEntities(userBio);



		  	if ($(primary).is(':checked')) { primaryAnswer = '1'; }
			else { primaryAnswer = '0'; }

			if ($(projectManagement).is(':checked')) { projectManagementAnswer = '1'; }
			else { projectManagementAnswer = '0'; }

			if ($(marketing).is(':checked')) { marketingAnswer = '1'; }
			else { marketingAnswer = '0'; }

			if ($(sales).is(':checked')) { salesAnswer = '1'; }
			else { salesAnswer = '0'; }

			if ($(installation).is(':checked')) { installationAnswer = '1'; }
			else { installationAnswer = '0'; }

			if ($(bidVerification).is(':checked')) { bidVerificationAnswer = '1'; }
			else { bidVerificationAnswer = '0'; }

			if ($(bidCreation).is(':checked')) { bidCreationAnswer = '1'; }
			else { bidCreationAnswer = '0'; }

			if ($(pierDataRecorder).is(':checked')) { pierDataRecorderAnswer = '1'; }
			else { pierDataRecorderAnswer = '0'; }

			if ($(timecardApprover).is(':checked')) { timecardApproverAnswer = '1'; }
			else { timecardApproverAnswer = '0'; }

		  	if ($(active).is(':checked')) { activeAnswer = '1'; }
			else { activeAnswer = '0'; }

		storeUserPhoneTableData();

		function storeUserPhoneTableData() {
	        var userPhoneTableData = new Array();
	        $('#userPhoneTable tbody tr').each(function(row,tr){
	            userPhoneTableData[row]={
	            	"phoneDelete":$(tr).find('td:eq(0)').find('select').attr('delete'),
	            	"userPhoneID":$(tr).find('td:eq(0)').find('select').attr('sort'),
	                "phoneDescription":$(tr).find('td:eq(0)').find('select').val(),
	                "phoneNumber":$(tr).find('td:eq(1)').find('input').val(),
	                "isPrimary":$(tr).find('td:eq(2)').find('input:checked').val()
	            };
	        });
	        userPhoneTableData.shift();
	        var userPhoneTableArray = userPhoneTableData;
	        var userPhoneTableArray = JSON.stringify(userPhoneTableArray);


	        var formdata = new FormData();
	        formdata.append('firstName', firstName);
	        formdata.append('lastName', lastName);
	        formdata.append('email', email);
	        formdata.append('password', password);
	        formdata.append('primaryAnswer', primaryAnswer);
	        formdata.append('projectManagementAnswer', projectManagementAnswer);
	        formdata.append('marketingAnswer', marketingAnswer);
	        formdata.append('salesAnswer', salesAnswer);
	        formdata.append('installationAnswer', installationAnswer);
	        formdata.append('bidVerificationAnswer', bidVerificationAnswer);
	        formdata.append('bidCreationAnswer', bidCreationAnswer);
	        formdata.append('pierDataRecorderAnswer', pierDataRecorderAnswer);
	        formdata.append('timecardApproverAnswer', timecardApproverAnswer);
	        formdata.append('calendarBgColor', calendarBgColor);
	        formdata.append('userBio', userBio);
	        formdata.append('activeAnswer', activeAnswer);
	        formdata.append('phoneArray', userPhoneTableArray);
	        formdata.append('file', $('.cp-user-settings-container input[name="userPhoto"]')[0].files[0]);

	        $.ajax({
	        	url: 'user-add.php',
	            type: "POST",
	            data: formdata,
	            processData: false,  // tell jQuery not to process the data
	            contentType: false,  // tell jQuery not to set contentType
				success: function(response) {

					var response = jQuery.parseJSON(response);

					//console.log(response);

					if (response == 'need username') {
						$('#userErrorModal').foundation('open');
						$('#userErrorModal #errorMessage').text('Please enter a username and password.');

					} else if (response == 'email already exists') {
						$('#userErrorModal').foundation('open');
						$('#userErrorModal #errorMessage').text('The email address you entered has already been taken.');
						$('#loading-image').hide();
					} else {


						$.each(response, function (i, item) {

							$('.cp-users ul li:last').text(item.userFirstName + ' ' + item.userLastName);
							$('.cp-users ul li:last').attr('id',item.userID);

							$('.cp-users ul li:last').data('info', item);

							//if (item.userActive == '0') {
								//$('li.userList[id='+item.userID+']').append('<small style="float:right;font-style:italic;margin: .3rem 0 0 0;">Inactive</small>');
							//}

							//Remove Changed Class
							$('.userEdit').removeClass('changed');

							$(".cp-users ul li.userList").click(function(){
								userID = $(this).attr('id');

								viewSettings(userID);
							});

							//Reset Phone Table
							$('#userPhoneTable tbody tr').not(':first').remove();

							var settings = $('.cp-user-settings .cp-user-settings-container');

							$(settings).find('input[name="userFirstName"]').val($('li.userList.active').data('info').userFirstName);
							$(settings).find('input[name="userLastName"]').val($('li.userList.active').data('info').userLastName);
							$(settings).find('input[name="userEmail"]').val($('li.userList.active').data('info').userEmail);
							$(settings).find('input[name="userPassword"]').val('');
							$(settings).find('input[name="userPassword2"]').val('');
							$(settings).find('input[name="userID"]').val($('li.userList.active').data('info').userID);
							$(settings).find('textarea[name="userBio"]').val($('li.userList.active').data('info').userBio);

							$(settings).find('.cp-user-form').attr('id', $('li.userList.active').data('info').userID);

							//User Photo
							var userPhoto = $('li.userList.active').data('info').userPhoto;
							var userID = $('li.userList.active').data('info').userID;

							$('.cp-user-settings-container input[name="userPhoto"]').val('');

							if (userPhoto == '' || userPhoto == null) {
								$('#currentPhoto').html('');
								$('#newPhotoUpload').show();
						  		$('#addNewPhoto').hide();
							} else {
						  		$('#currentPhoto').html('<img src="image.php?type=userimage&cid=<?php echo $companyID;  ?>&uid='+userID+'&name='+userPhoto+'" style="height:10rem;margin-bottom:.5rem;" />');
						  		$('#newPhotoUpload').hide();
						  		$('#addNewPhoto').show();
							}

							//User Password
							if($('#changePasswordInput').is(':visible')){
						     	$('#changePasswordInput').slideUp();
						     	$('#changePassword').text($(this).text() == 'Change Password' ? "Keep Existing Password" : "Change Password");
							}

							//Color
							var newColor = $('li.userList.active').data('info').calendarBgColor;
					 		$("#showPalette").spectrum("set", newColor);

							id = $('li.userList.active').data('info').userID;

							if ($('li.userList.active').data('info').primary == 1) { $(settings).find('input[name="admin"]').prop('checked', true); }
							else { $(settings).find('input[name="admin"]').prop('checked', false); }

							if ($('li.userList.active').data('info').projectManagement == 1) $(settings).find('input[name="projectManagement"]').prop('checked', true);
							else $(settings).find('input[name="projectManagement"]').prop('checked', false);

							if ($('li.userList.active').data('info').marketing == 1){ $(settings).find('input[name="marketing"]').prop('checked', true);}
							else $(settings).find('input[name="marketing"]').prop('checked', false);


							if ($('li.userList.active').data('info').sales == 1) $(settings).find('input[name="sales"]').prop('checked', true);
							else $(settings).find('input[name="sales"]').prop('checked', false);

							if ($('li.userList.active').data('info').installation == 1) $(settings).find('input[name="installation"]').prop('checked', true);
							else $(settings).find('input[name="installation"]').prop('checked', false);

							if ($('li.userList.active').data('info').bidVerification == 1) $(settings).find('input[name="bidVerification"]').prop('checked', true);
							else $(settings).find('input[name="bidVerification"]').prop('checked', false);

							if ($('li.userList.active').data('info').bidCreation == 1) $(settings).find('input[name="bidCreation"]').prop('checked', true);
							else $(settings).find('input[name="bidCreation"]').prop('checked', false);

							if ($('li.userList.active').data('info').pierDataRecorder == 1) $(settings).find('input[name="pierDataRecorder"]').prop('checked', true);
							else $(settings).find('input[name="pierDataRecorder"]').prop('checked', false);

							if ($('li.userList.active').data('info').timecardApprover == 1) $(settings).find('input[name="timecardApprover"]').prop('checked', true);
							else $(settings).find('input[name="timecardApprover"]').prop('checked', false);

							if ($('li.userList.active').data('info').userActive == 1) $(settings).find('input[name="userActive"]').prop('checked', true);
							else $(settings).find('input[name="userActive"]').prop('checked', false);


							$('.cp-user-settings .cp-user-settings-container').removeClass('new');


							$.ajax({
								url: 'getUserPhone.php',
								dataType: "json",
								contentType: 'application/json',
								type: "GET",
								contentType: "application/x-www-form-urlencoded",
								data: {
									userID: userID,
		    					},
								success: function(response) {

									$('.cp-users ul li.active').data("phone",response);

									$.each(response, function (i, item) {

										$cloneRow = $('#userPhoneTable tbody tr:first').clone().css('display', '');

								  		$cloneRow.addClass('dbRow');

								        if ($cloneRow.find('select.Description').has('option[value="' + item.phoneDescription + '"]').length > 0) {
								            $cloneRow.find('select.Description > option[value="' + item.phoneDescription + '"]').attr('selected', 'selected');
								        }

								        $cloneRow.find('input.Phone').val(item.phoneNumber);

								        if (item.isPrimary == '1') {
								            $cloneRow.find('input.isPrimary').prop('checked', true);
								        }

								        $cloneRow.find('select.Description').attr('sort', item.userPhoneID);
								        $cloneRow.find('input.Phone').attr('sort', item.userPhoneID);
								        $cloneRow.find('input.isPrimary').attr('sort', item.userPhoneID);


								        $('#userPhoneTable tbody').append($cloneRow);
								        //$('#userPhoneTable tbody > tr:last-child input.isPrimary').click(isPrimaryCheckUser);
								        $('#userPhoneTable tbody > tr:last-child a ').click(deletePhoneRowUser);
								        $('#userPhoneTable').find('tbody > tr:last-child input.Phone').mask('(000) 000-0000');
								    });

								}, error: function(jqXHR, textStatus, errorThrown) {
					  				console.log(textStatus, errorThrown);
									console.log(jqXHR.responseText);
								}

							});

							$('#loading-image').hide();

							$('#userAddedModal').foundation('open');

						});

					}

		        },
				 error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
				}
		    });
		}
	}
};


var updateExistingUser = function() {
	var updateUser;

	if ($('input[name="userFirstName"]').val() == '' || $('input[name="userLastName"]').val() == '' || $('input[name="userEmail"]').val() == '') {
		updateUser = 0;
		$('input.required').each(function(){
	        if ($(this).val() == '') {
	            $(this).parent().addClass('is-invalid-label');
	            $(this).addClass('is-invalid-input');
	            $(this).parent().find('.form-error').addClass('is-visible');
	        } else {
	            $(this).parent().removeClass('is-invalid-label');
	            $(this).removeClass('is-invalid-input');
	            $(this).parent().find('.form-error').removeClass('is-visible');
	        }
	    });
	} else {

		// if ($('#phoneTable tbody tr:visible').length > 0) {
  // 			$('#companyPhoneSection small.onePhone').removeClass('is-visible');
  			
  // 			$('#phoneTable tbody tr:visible').each(function(){
  // 				if ($(this).find('td input.Phone').val() == '' || $(this).find('td input.Description').val() == '') {
  //               	$('#companyPhoneSection small.fullPhone').addClass('is-visible');

	 //            } else {
	 //                $('#companyPhoneSection small.fullPhone').removeClass('is-visible');
	 //            }
  // 			});
  //       } else {
  //           $('#companyPhoneSection small.onePhone').addClass('is-visible');
  //       }



		if ($('#userPhoneTable tbody tr:visible').length > 0) {
			$('#userPhoneSection small.onePhone').removeClass('is-visible');
			
			$('#userPhoneTable tbody tr:visible').each(function(){
  				if ($(this).find('td input.Phone').val() == '' || $(this).find('td select.Description').val() == '') {
                	$('#userPhoneSection small.fullPhone').addClass('is-visible');
                	updateUser = 0;
	            } else {
	            	if ($(this).find('td input.Phone').val().length < 14) {
                        $('#userPhoneSection small.fullPhone').addClass('is-visible');
                        updateUser = 0;
                    } else {
                        $('#userPhoneSection small.fullPhone').removeClass('is-visible');
                        updateUser = 1;
                    }
	            }
  			}); 

  			if (updateUser == 1) {
  				if ($('#userPhoneTable .isPrimary:checked').length < 1) {
		            $('#userPhoneSection small.primary').addClass('is-visible');
		            updateUser = 0;
		        } else {
		            if ($('#userPhoneTable .isPrimary:checked').is(':visible')) {
		                $('#userPhoneSection small.primary').removeClass('is-visible');
		                updateUser = 1;
		            } else {
		                $('#userPhoneSection small.primary').addClass('is-visible');
		                updateUser = 0;
		            }
		        }
  			}
        } else {
            $('#userPhoneSection small.onePhone').addClass('is-visible');
            updateUser = 0;
        }

  		if (!isEmail($('input[name="userEmail"]').val())){
  			$('input[name="userEmail"]').parent().addClass('is-invalid-label');
			$('input[name="userEmail"]').addClass('is-invalid-input');
			$('input[name="userEmail"]').parent().find('.form-error').addClass('is-visible');
			updateUser = 0;
		}
	}

	//If required fields are filled in
	if (updateUser == 1) {

		$('#loading-image').show();

		var form = $(this).parents('#myForm');
		var userID = $(form).find('input[name=userID]').val();
		var firstName = $(form).find('input[name=userFirstName]').val();
		var lastName = $(form).find('input[name=userLastName]').val();
		var email = $(form).find('input[name=userEmail]').val();
		var password = $(form).find('input[name=userPassword]').val();
		var primary = $(form).find('input[name=primary]');
		var projectManagement = $(form).find('input[name=projectManagement]');
		var sales = $(form).find('input[name=sales]');
		var marketing = $(form).find('input[name=marketing]');
		var installation = $(form).find('input[name=installation]');
		var bidVerification = $(form).find('input[name=bidVerification]');
		var bidCreation = $(form).find('input[name=bidCreation]');
		var pierDataRecorder = $(form).find('input[name=pierDataRecorder]');
		var timecardApprover = $(form).find('input[name=timecardApprover]');
		var calendarBgColor = $(form).find('input[name=calendarBgColor]').val();
		var userBio = $(form).find('textarea[name="userBio"]').val();
		var active = $(form).find('input[name=userActive]');


		  	if ($(primary).is(':checked')) { primaryAnswer = '1'; }
			else { primaryAnswer = '0'; }

			if ($(projectManagement).is(':checked')) { projectManagementAnswer = '1'; }
			else { projectManagementAnswer = '0'; }

			if ($(sales).is(':checked')) { salesAnswer = '1'; }
			else { salesAnswer = '0'; }

			if ($(marketing).is(':checked')) { marketingAnswer = '1';}
			else { marketingAnswer = '0';}

			if ($(installation).is(':checked')) { installationAnswer = '1'; }
			else { installationAnswer = '0'; }

			if ($(bidVerification).is(':checked')) { bidVerificationAnswer = '1'; }
			else { bidVerificationAnswer = '0'; }

			if ($(bidCreation).is(':checked')) { bidCreationAnswer = '1'; }
			else { bidCreationAnswer = '0'; }

			if ($(pierDataRecorder).is(':checked')) { pierDataRecorderAnswer = '1'; }
			else { pierDataRecorderAnswer = '0'; }

			if ($(timecardApprover).is(':checked')) { timecardApproverAnswer = '1'; }
			else { timecardApproverAnswer = '0'; }

			if ($(active).is(':checked')) { activeAnswer = '1'; }
			else { activeAnswer = '0'; }

		storeUserPhoneTableData();

		function storeUserPhoneTableData() {
	        var userPhoneTableData = new Array();
	        $('#userPhoneTable tbody tr').each(function(row,tr){
	            userPhoneTableData[row]={
	            	"phoneDelete":$(tr).find('td:eq(0)').find('select').attr('delete'),
	            	"userPhoneID":$(tr).find('td:eq(0)').find('select').attr('sort'),
	                "phoneDescription":$(tr).find('td:eq(0)').find('select').val(),
	                "phoneNumber":$(tr).find('td:eq(1)').find('input').val(),
	                "isPrimary":$(tr).find('td:eq(2)').find('input:checked').val()
	            };
	        });
	        userPhoneTableData.shift();
	        var userPhoneTableArray = userPhoneTableData;
	        var userPhoneTableArray = JSON.stringify(userPhoneTableArray);


	        var formdata = new FormData();
	        formdata.append('userID', userID);
	        formdata.append('firstName', firstName);
	        formdata.append('lastName', lastName);
	        formdata.append('email', email);
	        formdata.append('password', password);
	        formdata.append('primaryAnswer', primaryAnswer);
	        formdata.append('projectManagementAnswer', projectManagementAnswer);
	        formdata.append('salesAnswer', salesAnswer);
	        formdata.append('marketingAnswer', marketingAnswer);
	        formdata.append('installationAnswer', installationAnswer);
	        formdata.append('bidVerificationAnswer', bidVerificationAnswer);
	        formdata.append('bidCreationAnswer', bidCreationAnswer);
	        formdata.append('pierDataRecorderAnswer', pierDataRecorderAnswer);
	        formdata.append('timecardApproverAnswer', timecardApproverAnswer);
	        formdata.append('calendarBgColor', calendarBgColor);
	        formdata.append('userBio', userBio);
	        formdata.append('activeAnswer', activeAnswer);
	        formdata.append('phoneArray', userPhoneTableArray);
	        formdata.append('file', $('.cp-user-settings-container input[name="userPhoto"]')[0].files[0]);

	        $.ajax({
	        	url: 'user-edit.php',
	            type: "POST",
	            data: formdata,
	            processData: false,  // tell jQuery not to process the data
	            contentType: false,  // tell jQuery not to set contentType
				success: function(response) {

					var response = jQuery.parseJSON(response);

					if (response == 'user could not be updated') {
						$('#userErrorModal').foundation('open');
						$('#userErrorModal #errorMessage').text('User could not be updated.');
					} else if (response == 'email already exists') {
						$('#userErrorModal').foundation('open');
						$('#userErrorModal #errorMessage').text('Email already exists.');
					} else {

						$.each(response, function (i, item) {

							$('.cp-users ul li.active').data('info', item);

							$('.cp-users ul li.active').text( decodeEntities(item.userFirstName )+ ' ' +  decodeEntities(item.userLastName));

							if (item.userActive == '0') {
								$('li.userList[id='+item.userID+']').append('<small style="float:right;font-style:italic;margin: .3rem 0 0 0;">Inactive</small>');
							} else {

								$('li.userList[id='+item.userID+']').find('small').text('');

								//var target = $('small');
								//$('li.userList[id='+item.userID+']').append('<small style="float:right;font-style:italic;margin: .3rem 0 0 0;">Inactive</small>');
							}

							//$('.cp-users ul li.userList').click(viewSettings);

							//Remove Changed Class
							$('.userEdit').removeClass('changed');

							//Reset Phone Table
							$('#userPhoneTable tbody tr').not(':first').remove();

							var settings = $('.cp-user-settings .cp-user-settings-container');

							$(settings).find('input[name="userFirstName"]').val(decodeEntities($('li.userList.active').data('info').userFirstName));
							$(settings).find('input[name="userLastName"]').val(decodeEntities($('li.userList.active').data('info').userLastName));
							$(settings).find('input[name="userEmail"]').val($('li.userList.active').data('info').userEmail);
							$(settings).find('input[name="userPassword"]').val('');
							$(settings).find('input[name="userPassword2"]').val('');
							$(settings).find('input[name="userID"]').val($('li.userList.active').data('info').userID);
							$(settings).find('textarea[name="userBio"]').val(decodeEntities($('li.userList.active').data('info').userBio));

							$(settings).find('.cp-user-form').attr('id', $('li.userList.active').data('info').userID);

							//User Photo
							var userPhoto = $('li.userList.active').data('info').userPhoto;
							var userID = $('li.userList.active').data('info').userID;

							$('.cp-user-settings-container input[name="userPhoto"]').val('');

							if (userPhoto == '' || userPhoto == null) {
								$('#currentPhoto').html('');
								$('#newPhotoUpload').show();
						  		$('#addNewPhoto').hide();
							} else {
						  		$('#currentPhoto').html('<img src="image.php?type=userimage&cid=<?php echo $companyID;  ?>&uid='+userID+'&name='+userPhoto+'" style="height:10rem;margin-bottom:.5rem;" />');
						  		$('#newPhotoUpload').hide();
						  		$('#addNewPhoto').show();
							}

							//User Password
							if($('#changePasswordInput').is(':visible')){
						     	$('#changePasswordInput').slideUp();
						     	$('#changePassword').text($(this).text() == 'Change Password' ? "Keep Existing Password" : "Change Password");
							}

							//Color
							var newColor = $('li.userList.active').data('info').calendarBgColor;
			 				$("#showPalette").spectrum("set", newColor);

							id = $('li.userList.active').data('info').userID;

							if ($('li.userList.active').data('info').primary == 1) { $(settings).find('input[name="admin"]').prop('checked', true); }
							else { $(settings).find('input[name="admin"]').prop('checked', false); }

							if ($('li.userList.active').data('info').projectManagement == 1) $(settings).find('input[name="projectManagement"]').prop('checked', true);
							else $(settings).find('input[name="projectManagement"]').prop('checked', false);

							if ($('li.userList.active').data('info').marketing == 1) $(settings).find('input[name="marketing"]').prop('checked', true);
							else $(settings).find('input[name="marketing"]').prop('checked', false);

							if ($('li.userList.active').data('info').sales == 1) $(settings).find('input[name="sales"]').prop('checked', true);
							else $(settings).find('input[name="sales"]').prop('checked', false);

							if ($('li.userList.active').data('info').installation == 1) $(settings).find('input[name="installation"]').prop('checked', true);
							else $(settings).find('input[name="installation"]').prop('checked', false);

							if ($('li.userList.active').data('info').bidVerification == 1) $(settings).find('input[name="bidVerification"]').prop('checked', true);
							else $(settings).find('input[name="bidVerification"]').prop('checked', false);

							if ($('li.userList.active').data('info').bidCreation == 1) $(settings).find('input[name="bidCreation"]').prop('checked', true);
							else $(settings).find('input[name="bidCreation"]').prop('checked', false);

							if ($('li.userList.active').data('info').pierDataRecorder == 1) $(settings).find('input[name="pierDataRecorder"]').prop('checked', true);
							else $(settings).find('input[name="pierDataRecorder"]').prop('checked', false);

							if ($('li.userList.active').data('info').timecardApprover == 1) $(settings).find('input[name="timecardApprover"]').prop('checked', true);
							else $(settings).find('input[name="timecardApprover"]').prop('checked', false);

							if ($('li.userList.active').data('info').userActive == 1) $(settings).find('input[name="userActive"]').prop('checked', true);
							else $(settings).find('input[name="userActive"]').prop('checked', false);


							$.ajax({
								url: 'getUserPhone.php',
								dataType: "json",
								contentType: 'application/json',
								type: "GET",
								contentType: "application/x-www-form-urlencoded",
								data: {
									userID: userID,
		    					},
								success: function(response) {

									$('.cp-users ul li.active').data("phone",response);

									$.each(response, function (i, item) {

										$cloneRow = $('#userPhoneTable tbody tr:first').clone().css('display', '');

								  		$cloneRow.addClass('dbRow');

								        if ($cloneRow.find('select.Description').has('option[value="' + item.phoneDescription + '"]').length > 0) {
								            $cloneRow.find('select.Description > option[value="' + item.phoneDescription + '"]').attr('selected', 'selected');
								        }

								        $cloneRow.find('input.Phone').val(item.phoneNumber);

								        if (item.isPrimary == '1') {
								            $cloneRow.find('input.isPrimary').prop('checked', true);
								        }

								        $cloneRow.find('select.Description').attr('sort', item.userPhoneID);
								        $cloneRow.find('input.Phone').attr('sort', item.userPhoneID);
								        $cloneRow.find('input.isPrimary').attr('sort', item.userPhoneID);


								        $('#userPhoneTable tbody').append($cloneRow);
								        $('#userPhoneTable tbody > tr:last-child input.isPrimary').click(isPrimaryCheckUser);
								        $('#userPhoneTable tbody > tr:last-child a ').click(deletePhoneRowUser);
								        $('#userPhoneTable').find('tbody > tr:last-child input.Phone').mask('(000) 000-0000');
								    });

								}, error: function(jqXHR, textStatus, errorThrown) {
					  				console.log(textStatus, errorThrown);
									console.log(jqXHR.responseText);
								}

							});

							$('#loading-image').hide();

							$('#userUpdatedModal').foundation('open');

						});

					}

		        },
				error: function(jqXHR, textStatus, errorThrown) {
	  				console.log(textStatus, errorThrown);
					console.log(jqXHR.responseText);
				}
		    });
		}
	}
};


var cancelNewUser = function() {

	var settings = $('.cp-user-settings .cp-user-settings-container').removeClass('new');

	$('.userEdit').removeClass('changed');

	$(settings).find('input[name="userFirstName"]').val('');
	$(settings).find('input[name="userLastName"]').val('');
	$(settings).find('input[name="userEmail"]').val('');
	$(settings).find('input[name="userPassword"]').val('');
	$(settings).find('input[name="userPassword2"]').val('');
	$(settings).find('input[name="userPhoneDirect"]').val('');
	$(settings).find('input[name="userPhoneCell"]').val('');
	$(settings).find('input[name="userID"]').val('0');
	$(settings).find('input[name="primary"]').prop('checked', false);
	$(settings).find('input[name="projectManagement"]').prop('checked', false);
	$(settings).find('input[name="marketing"]').prop('checked', false);
	$(settings).find('input[name="sales"]').prop('checked', false);
	$(settings).find('input[name="installation"]').prop('checked', false);
	$(settings).find('input[name="bidVerification"]').prop('checked', false);
	$(settings).find('input[name="bidCreation"]').prop('checked', false);
	$(settings).find('input[name="pierDataRecorder"]').prop('checked', false);
	$(settings).find('input[name="timecardApprover"]').prop('checked', false);
	$(settings).find('input[name="userActive"]').prop('checked', true);
	$(settings).find('textarea[name="userBio"]').val('');
	$(settings).find('input[name="calendarBgColor"]').val('#000000');

	//Reset Photo
	$(settings).find('#currentPhoto').text('');
	$(settings).find('#newPhotoUpload').show();
	$(settings).find('#addNewPhoto').hide();
	$('.cp-user-settings-container input[name="userPhoto"]').val('');

	//Reset Phone Table
	$('#userPhoneTable tbody tr').not(':first').remove();

	//Add Row For Phone
	addPhoneRowUser();

	$('#userPhoneTable tbody tr:nth-child(2) td.primary input.isPrimary').prop('checked', true);

	//Reset Color Palette
	$("#showPalette").spectrum("set", '');

	$(".userList#0").remove();

	// $('.cp-users ul li.userList').removeClass('active');
	// $('.cp-users ul li:last').addClass('active');

	//Collapse Password Boxes
	// if($('#changePasswordInput').is(':visible')){
 //     	$('#changePasswordInput').slideUp();
 //     	$('#changePassword').text($(this).text() == 'Change Password' ? "Keep Existing Password" : "Change Password");
	// }

	if(!$('#resetPassword').is(':visible')){
		$('#resetPassword').show();
	}

	$('.cp-user-settings .cp-user-settings-container').find('#changePassword').show();

	id = $('#leaveBeforeSavingNewModal #moveToUserID').val();

	viewSettings(id);

};


var cancelExistingUser = function(){

	$('.userEdit').removeClass('changed');

	id = $('#leaveBeforeSavingExistingModal #moveToUserID').val();
	viewSettings(id);
};

var ajaxServicesSave = function() {
    var answer = $(this);
	var answer_name = $(answer).attr('name');
	var answer_value = $(answer).val();
	var answer_id = $(answer).attr('id');
	var answer_section = $(answer).attr('section');

	if(answer.attr('id') == null) {
		$('.servicesAnswer[parent="'+answer_name+'"]').removeClass('show');
	}
	else {
			$('.servicesAnswer[parent="'+answer_id+'"]').addClass('show');
	}

	//Send Correct Value for Checkboxes
	if ($(answer).attr('type') == 'checkbox') {
		if ($(answer).is(':checked')) {
			//$(".testAnswer").html("success");
			//$(question).parent().children("input[type='hidden']").attr('disabled','disabled');
			answer_value = '1';
			if(answer.attr('id') == null) {
				$('.servicesAnswer[parent="'+answer_name+'"]').removeClass('show');
			}
			else {
				$('.servicesAnswer[parent="'+answer_id+'"]').addClass('show');
			}
		}
		else {
			answer_value = '0';
			$('.servicesAnswer[parent="'+answer_name+'"]').removeClass('show');
			//$(question).parent().children("input[type='hidden']").removeAttr('disabled');
		}
	}

	//console.log(answer_value);

	//Add Blue Background
	$(answer).parent().addClass( "save-pending" );

    $.ajax({
        url: 'company-services-ajax.php',
        dataType: "json",
        contentType: 'application/json',
        type: "POST",
        contentType: "application/x-www-form-urlencoded",
        data: {
			 answer_name: answer_name,
			 answer_value: answer_value,
			 answer_section: answer_section,
        },

        success: function (response) {
			//console.log(response);
			//Remove Blue Background
           $(answer).parent().removeClass( "save-pending" );
		   //Add Green Background and then Remove
			$(answer).parent().css('background-Color', '#90EE90').animate({ backgroundColor: "#FFFFFF" }, 1000);//.addClass('save-success');

			function htmlDecode(value) {
		  		return $("<textarea/>").html(value).text();
			};

			$(answer).val(htmlDecode(response));
        },
		 error: function(jqXHR, textStatus, errorThrown) {
  			console.log(textStatus, errorThrown);
			console.log(jqXHR.responseText);

			$(answer).parent().removeClass( "save-pending" );
			$(answer).parent().addClass( "save-error" );
		 }
    });

};


var ajaxPricingSave = function() {
    var answer = $(this);
	var answer_name = $(answer).attr('name');
	var answer_value = $(answer).val();
	var answer_sort = $(answer).parent().parent().find('td input.Sort').val();
	var answer_section = $(answer).attr('section');
	var answer_id = $(answer).parent().parent().find('td input[type="hidden"]').val();
	var id_name = answer_section + 'id';

	//Add Blue Background
	//$(answer).parent().parent().find('div:first label').addClass( "save-pending" );
	//$(answer).parent().addClass( "save-pending" );
	$(answer).addClass( "save-pending" );


	 //Add Pricing Table Row on Change
	 var answer_table = $(answer).parents('table');
	 var answer_tablename = $(answer).parents('table').attr('tablename');

	    if ($(answer_table).hasClass("cpTable")) {

	    	if (answer_tablename == 'pricingPier') {
	    		if ($('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child select.ManufacturerItemID').val() == '' &&
		    		$('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input.Name').val() == '' &&
		    		$('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child textarea.Description').val() == '' &&
		    		$('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input.Price').val() == '') {

			    } else {

			    	var oldValue = $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input.Sort').val();
			        var newVal = parseFloat(oldValue) + 1;

			        $('.cpTable.' + (answer_tablename) + ' tbody').append($('.cpTable.' + (answer_tablename) + ' tbody tr:first').clone().css('display', ''));
			        $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child td input.Sort').val(newVal);
			        $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input, .cpTable.' + (answer_tablename) + ' tbody > tr:last-child select, .cpTable.' + (answer_tablename) + ' tbody > tr:last-child textarea').change(ajaxPricingSave);

			         $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child a.deleteRow').click(openDeleteModal);
			    }

	    	} else {
	    		if ($('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input.Name').val() == '' &&
		    		$('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child textarea.Description').val() == '' &&
		    		$('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input.Price').val() == '') {

			    } else {

			    	var oldValue = $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input.Sort').val();
			        var newVal = parseFloat(oldValue) + 1;

			        $('.cpTable.' + (answer_tablename) + ' tbody').append($('.cpTable.' + (answer_tablename) + ' tbody tr:first').clone().css('display', ''));
			        $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child td input.Sort').val(newVal);
			        $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child input, .cpTable.' + (answer_tablename) + ' tbody > tr:last-child select, .cpTable.' + (answer_tablename) + ' tbody > tr:last-child textarea').change(ajaxPricingSave);

			         $('.cpTable.' + (answer_tablename) + ' tbody > tr:last-child a.deleteRow').click(openDeleteModal);
			    }
	    	}

	    }

    $.ajax({
        url: 'company-pricing-ajax.php',
        dataType: "json",
        contentType: 'application/json',
        type: "POST",
        contentType: "application/x-www-form-urlencoded",
        data: {
			 answer_name: answer_name,
			 answer_value: answer_value,
			 answer_section: answer_section,
			 answer_sort: answer_sort,
			 answer_id: answer_id
        },
        success: function (response) {

			//Remove Blue Background
           $(answer).removeClass( "save-pending" );

           //Add Green Background and then Remove
			$(answer).css('background-Color', '#90EE90').animate({ backgroundColor: "#fefefe" }, 1000);//.addClass('save-success');

		   	if (answer_section == 'pricing') {

				$(answer).val(response);
		   	} else {
		   		function htmlDecode(value) {
			  		return $("<textarea/>").html(value).text();
				};

		   		$(answer).val(htmlDecode(response[0].name));

				if (answer_id == '')
					$(answer).parent().parent().find('td input[type="hidden"]').val(response[0].id);
		   	}

        },
		 error: function(jqXHR, textStatus, errorThrown) {
  			console.log(textStatus, errorThrown);
			console.log(jqXHR.responseText);

			$(answer).parent().parent().find('div:first label').removeClass( "save-pending" );
			$(answer).parent().parent().find('div:first label').addClass( "save-error" );
		 }
    });

};

//Open Cancel Evaluation Modal
var openDeleteModal = function () {
	var idToDelete = $(this).parent().parent().find('td input[type="hidden"]').val();
	if (idToDelete != '') {
		var idToDeleteSection = $(this).attr('section');
		$('#deleteRowModal #idToDelete').val(idToDelete);
		$('#deleteRowModal #idToDeleteSection').val(idToDeleteSection);
	  	$('#deleteRowModal').foundation('open');
	 }
};

var ajaxPricingDeleteRow = function() {
	 var answer = $(this);
	 var answer_row = $(answer).parent().parent();
	 var answer_id = $('#deleteRowModal #idToDelete').val();
	 var answer_section = $('#deleteRowModal #idToDeleteSection').val();


	if (answer_id != '') {
		// console.log(answer_section);
		// console.log(answer_id);

		$.ajax({
	        url: 'company-pricing-ajax-delete-row.php',
	        dataType: "json",
	        contentType: 'application/json',
	        type: "POST",
	        contentType: "application/x-www-form-urlencoded",
	        data: {
				answer_id: answer_id,
				answer_section: answer_section
	        },
	        success: function (response) {
	        	console.log();

	        	if (response == 'true') {

	        		$('.cpTable.'+answer_section+' tbody').find('tr input[type="hidden"][value="'+answer_id+'"]').parent().parent().remove();;

	        		$('#deleteRowModal').foundation('close');

	        		$('#successModal .modal-content').text('Your row has been deleted!');
	        		$('#successModal').foundation('open');
	        	}
	        },
			 error: function(jqXHR, textStatus, errorThrown) {
	  			console.log(textStatus, errorThrown);
				console.log(jqXHR.responseText);

				$(answer).parent().parent().find('div:first label').removeClass( "save-pending" );
				$(answer).parent().parent().find('div:first label').addClass( "save-error" );
			 }
   		 });

	}

};
	
	//add billing address FXLRATR-350
	//If the checkbox is checked, this will ensure that the data is validated
	//before saving or it will remove the need for validation and clear the text boxes
	var addBillingAddress = function () {
		
		if ($('#addBillingAddress').is(":checked")){
			//add validation class
			$('#BillingAddress').toggle();
				$('input[name="companyBillingAddress1"]').addClass("required");
				$('input[name="companyBillingCity"]').addClass("required");
				$('select[name="companyBillingState"]').addClass("required");
				$('input[name="companyBillingZip"]').addClass("required");
		} else {
			$('#BillingAddress').toggle();
				$('input[name="companyBillingAddress1"]').removeClass("required");
				$('input[name="companyBillingCity"]').removeClass("required");
				$('select[name="companyBillingState"]').removeClass("required");
				$('input[name="companyBillingZip"]').removeClass("required");

				//clear out the text boxes so they don't save anyway.
				$('input[name="companyBillingAddress1"]').val('');
				$('input[name="companyBillingAddress2"]').val('');
				$('input[name="companyBillingCity"]').val('');
				$('select[name="companyBillingState"]').val('');
				$('input[name="companyBillingZip"]').val('');

				//remove any validation errors if they appear
				$('.required').parent().removeClass('is-invalid-label');
				$('.required').removeClass('is-invalid-input');
				$('.required').parent().find('.form-error').removeClass('is-visible');
		}
	};

	var addPhoneRowCompany = function () {

        //oldRow = $('#phoneTable').find('tbody > tr:last-child input.isPrimary').attr('value');
        //var newRow = parseFloat(oldRow) + 1;

        $cloneBlankRow = $('#phoneTable').find('tbody tr:first').clone().css('display', '');
        $('#phoneTable').find('tbody').append($cloneBlankRow);
        $('#phoneTable').find('tbody > tr:last-child input.isPrimary').change(isPrimaryCheckCompany);
        $('#phoneTable').find('tbody > tr:last-child .delete > a').click(deletePhoneRowCompany);

        $('#phoneTable').find('tbody > tr:last-child input.Phone').mask('(000) 000-0000');

        //if ($('input.isPrimary').is(':not(:checked)'))
        if (!$('#phoneTable input.isPrimary:checked'))
            $('#phoneTable tbody tr:nth-child(2) td.primary input.isPrimary').prop('checked', true);
    };


    var deletePhoneRowCompany = function () {

    	if ($(this).parent().parent().hasClass('dbRow')) {
    		$(this).parent().parent().find('input').attr('delete','delete');
    		$(this).parent().parent().css('display','none');

    		  if ($(this).parent().parent().find('input.isPrimary').is(':checked'))
                $('#phoneTable tbody tr:visible').eq(0).find('td.primary input.isPrimary').prop('checked', true);

	        if ($('#phoneTable tbody').children().length == 1)
	           	addPhoneRowCompany();
    	} else {
    		$(this).parent().parent().remove();

    		if ($(this).parent().parent().find('input.isPrimary').is(':checked'))
                $('#phoneTable tbody tr:visible').eq(0).find('td.primary input.isPrimary').prop('checked', true);

	        if ($('#phoneTable tbody').children().length == 1)
	           addPhoneRowCompany();
    	}

    };


    var isPrimaryCheckCompany = function () {

        $('#phoneTable').find('input.isPrimary').prop('checked', false);
        $(this).prop('checked', true);

    };


 	var editCompanyProfile = function () {
    	//Get User General Info

    	$.ajax({
			url: 'getCompany.php',
			dataType: "json",
			contentType: 'application/json',
			type: "GET",
			contentType: "application/x-www-form-urlencoded",
			success: function(response) {

				function decodeEntities(encodedString) {
				    var textArea = document.createElement('textarea');
				    textArea.innerHTML = encodedString;
				    return textArea.value;
				}

          		$('input[name="companyName"]').val(decodeEntities(response.companyName));
				$('input[name="companyAddress1"]').val(response.companyAddress1);
				$('input[name="companyAddress2"]').val(response.companyAddress2);
				$('input[name="companyCity"]').val(response.companyCity);

				if ($('select[name="companyState"]').has('option[value="' + response.companyState + '"]').length > 0)
		     		$('select[name="companyState"] > option[value="' + response.companyState + '"]').attr('selected', 'selected');

				$('input[name="companyZip"]').val(response.companyZip);

				//Billing adddress FXLRATR 350
				//Populate the edit modal form with any existing billing address information
				//if it exists
				var companyBillingAddress1=response.companyBillingAddress1;
				// if (companyBillingAddress1 != null) {
				// 	companyBillingAddress1=companyBillingAddress1.trim();
				// }

				if (companyBillingAddress1 != null)
				{
					$('#addBillingAddress').prop('checked', true);
					$('#BillingAddress').show();
					$('input[name="companyBillingAddress1"]').val(response.companyBillingAddress1);
					$('input[name="companyBillingAddress2"]').val(response.companyBillingAddress2);
					$('input[name="companyBillingCity"]').val(response.companyBillingCity);

					if ($('select[name="companyBillingState"]').has('option[value="' + response.companyBillingState + '"]').length > 0)
						$('select[name="companyBillingState"] > option[value="' + response.companyBillingState + '"]').prop('selected', 'selected');
						
						$('input[name="companyBillingZip"]').val(response.companyBillingZip);
					
					

				}else{
					$('#addBillingAddress').prop('checked', false);
					$('#BillingAddress').hide()
					$('input[name="companyBillingAddress1"]').val('');
					$('input[name="companyBillingAddress2"]').val('');
					$('input[name="companyBillingCity"]').val('');
					$('input[name="companyBillingZip"]').val('');
					$('select[name="companyBillingState"]').val();
					$('.required').parent().removeClass('is-invalid-label');
					$('.required').removeClass('is-invalid-input');
					$('.required').parent().find('.form-error').removeClass('is-visible');

				}

				$('input[name="companyWebsite"]').val(response.companyWebsite);

				$('input[name="companyColor"]').val(response.companyColor);
				$('input[name="companyColorHover"]').val(response.companyColorHover);

				$('input[name="companyEmailFrom"]').val(response.companyEmailFrom);
				$('input[name="companyEmailReply"]').val(response.companyEmailReply);

				$('input[name="defaultInvoices"]').val(response.defaultInvoices);

				if (response.invoiceSplitBidAcceptance != null) {
		     		var invoiceSplitBidAcceptance = response.invoiceSplitBidAcceptance * 100;
		     		invoiceSplitBidAcceptance = invoiceSplitBidAcceptance.toFixed(0);
		     	} else {
		     		var invoiceSplitBidAcceptance = '';
		     	}

		     	if (response.invoiceSplitProjectComplete != null) {
		     		var invoiceSplitProjectComplete = response.invoiceSplitProjectComplete * 100;
		     		invoiceSplitProjectComplete = invoiceSplitProjectComplete.toFixed(0);
		     	} else {
		     		var invoiceSplitProjectComplete = '';
		     	}
				

				$('input[name="invoiceSplitBidAcceptance"]').val(invoiceSplitBidAcceptance);
				$('input[name="invoiceSplitProjectComplete"]').val(invoiceSplitProjectComplete);


				if ($('select[name="timezone"]').has('option[value="' + response.timezone + '"]').length > 0)
		     		$('select[name="timezone"] > option[value="' + response.timezone + '"]').attr('selected', 'selected');

		     	if (response.daylightSavings == '1') {
		     	 	$('input[name="daylightSavings"]').attr('checked', 'checked');
		     	}

		     	$('input[name="recentlyCompletedStatus"]').val(response.recentlyCompletedStatus);

		     	if (response.companyLogo == null) {
		     		$('#newLogoUpload').show();
  					$('#addNewLogo').hide();
		     	} else {
		     		$('#currentLogo').html('<img style="border:1px solid #cacaca;width:8rem;" src="image.php?type=companylogo&cid='+response.companyID+'&name='+response.companyLogo+'"><br/>');
		     	}

				//Company Profile Color Picker
				$("#companyColor").spectrum({
					preferredFormat: "hex",
			   	 	showInput: true,
			   	 	change: function(color) {
				        var color = $("#companyColor").spectrum("get").toHexString();
						$('input[name="companyColor"]').val(color);
				    },
				});

				//Company Profile Color Picker
				$("#companyColorHover").spectrum({
					preferredFormat: "hex",
			   	 	showInput: true,
			   	 	change: function(color) {
				        var color = $("#companyColorHover").spectrum("get").toHexString();
						$('input[name="companyColorHover"]').val(color);
				    },
				});


				//On Success Get User Phone
                $.ajax({
					url: 'getCompanyPhone.php',
					dataType: "json",
					contentType: 'application/json',
					type: "GET",
					contentType: "application/x-www-form-urlencoded",
					success: function(response) {
						$.each(response, function (i, item) {

		              		$cloneRow = $('#phoneTable tbody tr:first').clone().css('display', '');

		              		$cloneRow.addClass('dbRow');

		                    $cloneRow.find('input.Description').val(item.phoneDescription);
		                    $cloneRow.find('input.Phone').val(item.phoneNumber);

		                     if (item.isPrimary == '1') {
		                     	$cloneRow.find('input.isPrimary').prop('checked', true);
		                     } else {
		                     	$cloneRow.find('input.isPrimary').prop('checked', false);
		                     }
		                        

		                    $cloneRow.find('input.Description').attr('sort', item.companyPhoneID);
		                    $cloneRow.find('input.Phone').attr('sort', item.companyPhoneID);
		                    $cloneRow.find('input.isPrimary').attr('sort', item.companyPhoneID);


		                    $('#editCompanyProfileModal #phoneTable tbody').append($cloneRow);
		                    $('#editCompanyProfileModal #phoneTable tbody > tr:last-child input.isPrimary ').click(isPrimaryCheckCompany);
		                    $('#editCompanyProfileModal #phoneTable tbody > tr:last-child a ').click(deletePhoneRowCompany);
		                    $('#editCompanyProfileModal #phoneTable').find('tbody > tr:last-child input.Phone').mask('(000) 000-0000');

		                });

						var pageHeight = $( window ).height() * .85;

						//On Success Display Modal
		                $('#editCompanyProfileModal').foundation('open');
		                $('#editCompanyProfileModal').css('height',pageHeight);

		                if (disableCancelButton){
		                	$('#closeEditCompanyProfile').prop('disabled',true);
		                }
		                else{
		                	$('#closeEditCompanyProfile').prop('disabled',false);
		                }

					}, error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
					}

				});

			}, error: function(jqXHR, textStatus, errorThrown) {
  				console.log(textStatus, errorThrown);
				console.log(jqXHR.responseText);
			}

		});

    };


	var closeEditCompanyProfile = function() {
		$('#editCompanyProfileModal #phoneTable tbody tr').not(':first').remove();

				$('#editCompanyProfileModal #phoneTable tbody tr').not(':first').remove();

				$('input[name="companyName"]').val('');
				$('input[name="companyAddress1"]').val('');
				$('input[name="companyAddress2"]').val('');
				$('input[name="companyCity"]').val('');
				$('input[name="companyState"]').val('');
				$('input[name="companyZip"]').val('');

                //clear billing address FXLRATR350
                $('#addBillingAddress').prop('checked', false);
				$('input[name="companyBillingAddress1"]').val('');
				$('input[name="companyBillingAddress2"]').val('');
				$('input[name="companyBillingCity"]').val('');
				$('input[name="companyBillingState"]').val('');
				$('input[name="companyBillingZip"]').val('');

				$('input[name="companyWebsite"]').val('');
				$('input[name="companyColor"]').val('');
				$('input[name="companyColorHover"]').val('');
				$('input[name="companyEmailFrom"]').val('');
				$('input[name="companyEmailReply"]').val('');
				$('input[name="defaultInvoices"]').val('');
				$('input[name="invoiceSplitBidAcceptance"]').val('');
				$('input[name="invoiceSplitProjectComplete"]').val('');
				$('input[name="timezone"]').val('');
				$('input[name="daylightSavings"]').val('');
				$('input[name="recentlyCompletedStatus"]').val('');
				$('input[name="companyLogo"]').val('');
		
				$('.required').parent().removeClass('is-invalid-label');
				$('.required').removeClass('is-invalid-input');
				$('.required').parent().find('.form-error').removeClass('is-visible');

				$('#companyPhoneSection small.onePhone').removeClass('is-visible');
				$('#companyPhoneSection small.fullPhone').removeClass('is-visible');
				$('#companyPhoneSection small.primary').removeClass('is-visible');

				$('#editCompanyProfileModal').foundation('close');

	};

	var errorInvoiceInputs = function () {
		errorBidAcceptanceInput();
		errorProjectCompleteInput();
	};

	var errorBidAcceptanceInput = function (){
		$('[name="invoiceSplitBidAcceptance"]').parent().addClass('is-invalid-label');
		$('[name="invoiceSplitBidAcceptance"]').addClass('is-invalid-input');
		$('[name="invoiceSplitBidAcceptance"]').parent().find('.form-error').addClass('is-visible');
	}

	var errorProjectCompleteInput = function (){
		$('[name="invoiceSplitProjectComplete"]').parent().addClass('is-invalid-label');
		$('[name="invoiceSplitProjectComplete"]').addClass('is-invalid-input');
		$('[name="invoiceSplitProjectComplete"]').parent().find('.form-error').addClass('is-visible');		
	}

	var checkPercentages = function () {
		var validated = false;
		var defaultInvoices = $('[name="defaultInvoices"]').val();
		var bidAcceptance =  parseInt($('[name="invoiceSplitBidAcceptance"]').val());
		var projectComplete = parseInt($('[name="invoiceSplitProjectComplete"]').val());
		switch (defaultInvoices){
			case "":
			case "0":
	  			$('[name="defaultInvoices"]').parent().addClass('is-invalid-label');
				$('[name="defaultInvoices"]').addClass('is-invalid-input');
				$('[name="defaultInvoices"]').parent().find('.form-error').addClass('is-visible');
				break;
			case "1":
				if ($('[name="invoiceSplitBidAcceptance"]').val() != "0"){
			  		$('[name="invoiceSplitBidAcceptance"]').parent().find('.form-error').text('Bid acceptance percentage must be 0 for a default invoice of 1.');
					errorBidAcceptanceInput();
				}
				if ($('[name="invoiceSplitProjectComplete"]').val() != "100"){
					$('[name="invoiceSplitProjectComplete"]').parent().find('.form-error').text('Project completion percentage must be 100 for a default invoice of 1.');
					errorProjectCompleteInput();
				}
				break;
			case "2":
				if (bidAcceptance + projectComplete != 100){
			  		$('[name="invoiceSplitBidAcceptance"]').parent().find('.form-error').text('Invoice percentage must equal 100.');
			  		$('[name="invoiceSplitProjectComplete"]').parent().find('.form-error').text('Invoice percentage must equal 100.');

			  		errorInvoiceInputs();
				}
				if (bidAcceptance < 1){
					$('[name="invoiceSplitBidAcceptance"]').parent().find('.form-error').text('Bid acceptance percentage must be greater than 0.');

					errorBidAcceptanceInput();
				}
				if (projectComplete < 1){
					$('[name="invoiceSplitProjectComplete"]').parent().find('.form-error').text('Project completion percentage must be greater than 0.');

					errorProjectCompleteInput();
				}
				break;
			default:
				if ((bidAcceptance + projectComplete) > 100){
			  		$('[name="invoiceSplitBidAcceptance"]').parent().find('.form-error').text('Invoice percentage must not be greater than 100.');
			  		$('[name="invoiceSplitProjectComplete"]').parent().find('.form-error').text('Invoice percentage must not be greater than 100.');

			  		errorInvoiceInputs();
				}
				if (bidAcceptance < 1){
					$('[name="invoiceSplitBidAcceptance"]').parent().find('.form-error').text('Bid acceptance percentage must be greater than 0.');

					errorBidAcceptanceInput();
				}
				if (projectComplete < 1){
					$('[name="invoiceSplitProjectComplete"]').parent().find('.form-error').text('Project completion percentage must be greater than 0.');

					errorProjectCompleteInput();
				}
				break;
		}
	};

	var isEmail = function(email) {
		return email.indexOf('@') > 0 && email.indexOf('.') > 0;
	};

  	var saveEditCompanyProfile = function() {
  		$('[name="defaultInvoices"]').parent().find('.form-error').text('Total invoice number is required.');
  		$('[name="invoiceSplitBidAcceptance"]').parent().find('.form-error').text('Bid acceptance percentage is required.');
  		$('[name="invoiceSplitProjectComplete"]').parent().find('.form-error').text('Project completion percentage is required.');

  		$('#editCompanyProfileModal .required').each(function(){
  			if ($(this).val() == '') {
	  			$(this).parent().addClass('is-invalid-label');
				$(this).addClass('is-invalid-input');
				$(this).parent().find('.form-error').addClass('is-visible');
	  		} else {
	  			$(this).parent().removeClass('is-invalid-label');
				$(this).removeClass('is-invalid-input');
				$(this).parent().find('.form-error').removeClass('is-visible');
	  		}
  		});

  		if (!isEmail($('input[name="companyEmailFrom"]').val())){
  			$('input[name="companyEmailFrom"]').parent().addClass('is-invalid-label');
			$('input[name="companyEmailFrom"]').addClass('is-invalid-input');
			$('input[name="companyEmailFrom"]').parent().find('.form-error').addClass('is-visible');
  		}

  		if (!isEmail($('input[name="companyEmailReply"]').val())){
			$('input[name="companyEmailReply"]').parent().addClass('is-invalid-label');
			$('input[name="companyEmailReply"]').addClass('is-invalid-input');
			$('input[name="companyEmailReply"]').parent().find('.form-error').addClass('is-visible');
  		}

  		checkPercentages();

  		if ($('#phoneTable tbody tr:visible').length > 0) {
  			$('#companyPhoneSection small.onePhone').removeClass('is-visible');
  			
  			$('#phoneTable tbody tr:visible').each(function(){
  				if ($(this).find('td input.Phone').val() == '' || $(this).find('td input.Description').val() == '') {
                	$('#companyPhoneSection small.fullPhone').addClass('is-visible');
	            } else {
	                if ($(this).find('td input.Phone').val().length < 14) {
                         $('#companyPhoneSection small.fullPhone').addClass('is-visible');
                    } else {
                        $('#companyPhoneSection small.fullPhone').removeClass('is-visible');
                    }
	            }
  			});
        } else {
            $('#companyPhoneSection small.onePhone').addClass('is-visible');
        }

        if ($('#phoneTable .isPrimary:checked').length < 1) {
            $('#companyPhoneSection small.primary').addClass('is-visible');
            
        } else {
            if ($('#phoneTable .isPrimary:checked').is(':visible')) {
                $('#companyPhoneSection small.primary').removeClass('is-visible');
            } else {
                $('#companyPhoneSection small.primary').addClass('is-visible');
            }
        }

  		if (!$('#editCompanyProfileModal .required').parent().hasClass('is-invalid-label')&&
  			!$('#companyPhoneSection small.onePhone').hasClass('is-visible') &&
  			!$('#companyPhoneSection small.primary').hasClass('is-visible')  &&
  			!$('#companyPhoneSection small.fullPhone').hasClass('is-visible')) {

  			//console.log('Save');

  			$('#loading-image').show();

  			var companyName = $('input[name="companyName"]').val();
  			var companyAddress1 = $('input[name="companyAddress1"]').val();
  			var companyAddress2 = $('input[name="companyAddress2"]').val();
  			var companyCity = $('input[name="companyCity"]').val();
  			var companyState = $('select[name="companyState"]').val();
  			var companyZip = $('input[name="companyZip"]').val();


  			// billing address FXLRATR-350
  			var companyBillingAddress1 = $('input[name="companyBillingAddress1"]').val();
  			var companyBillingAddress2 = $('input[name="companyBillingAddress2"]').val();
  			var companyBillingCity = $('input[name="companyBillingCity"]').val();
  			var companyBillingState = $('select[name="companyBillingState"]').val();
  			var companyBillingZip = $('input[name="companyBillingZip"]').val();


  			var companyWebsite = $('input[name="companyWebsite"]').val();
  			var companyColor = $('input[name="companyColor"]').val();
  			var companyColorHover = $('input[name="companyColorHover"]').val();
  			var companyEmailFrom = $('input[name="companyEmailFrom"]').val();
  			var companyEmailReply = $('input[name="companyEmailReply"]').val();
  			var defaultInvoices = $('input[name="defaultInvoices"]').val();
  			var invoiceSplitBidAcceptance = $('input[name="invoiceSplitBidAcceptance"]').val();
  			var invoiceSplitProjectComplete = $('input[name="invoiceSplitProjectComplete"]').val();
  			var timezone = $('select[name="timezone"]').val();
  			var recentlyCompletedStatus = $('input[name="recentlyCompletedStatus"]').val();

  			if ($('input[name="daylightSavings"]:checked').length > 0) {
  				var daylightSavings = 1;
  			} else {
  				var daylightSavings = 0;
  			}


  			invoiceSplitBidAcceptance = invoiceSplitBidAcceptance / 100;
  			invoiceSplitProjectComplete = invoiceSplitProjectComplete / 100;

			storeCompanyPhoneTableData();

			function storeCompanyPhoneTableData() {
		        var phoneTableData = new Array();
		        $('#editCompanyProfileModal #phoneTable tbody tr').each(function(row,tr){
		            phoneTableData[row]={
		            	"phoneDelete":$(tr).find('td:eq(0)').find('input').attr('delete'),
		            	"companyPhoneID":$(tr).find('td:eq(0)').find('input').attr('sort'),
		                "phoneDescription":$(tr).find('td:eq(0)').find('input').val(),
		                "phoneNumber":$(tr).find('td:eq(1)').find('input').val(),
		                "isPrimary":$(tr).find('td:eq(2)').find('input:checked').val()
		            };
		        });
		        phoneTableData.shift();
		        var companyPhoneTableArray = phoneTableData;
		        companyPhoneTableArray = JSON.stringify(companyPhoneTableArray);


		        var formdata = new FormData();
                formdata.append('companyName', companyName);
                formdata.append('companyAddress1', companyAddress1);
                formdata.append('companyAddress2', companyAddress2);
                formdata.append('companyCity', companyCity);
                formdata.append('companyState', companyState);
                formdata.append('companyZip', companyZip);

                // billing address FXLRATR350
                formdata.append('companyBillingAddress1', companyBillingAddress1);
                formdata.append('companyBillingAddress2', companyBillingAddress2);
                formdata.append('companyBillingCity', companyBillingCity);
                formdata.append('companyBillingState', companyBillingState);
                formdata.append('companyBillingZip', companyBillingZip);


                formdata.append('companyWebsite', companyWebsite);
                formdata.append('companyColor', companyColor);
                formdata.append('companyColorHover', companyColorHover);
                formdata.append('companyEmailFrom', companyEmailFrom);
                formdata.append('companyEmailReply', companyEmailReply);
                formdata.append('defaultInvoices', defaultInvoices);
                formdata.append('invoiceSplitBidAcceptance', invoiceSplitBidAcceptance);
                formdata.append('invoiceSplitProjectComplete', invoiceSplitProjectComplete);
                formdata.append('timezone', timezone);
                formdata.append('daylightSavings', daylightSavings);
                formdata.append('recentlyCompletedStatus', recentlyCompletedStatus);
                formdata.append('phoneArray', companyPhoneTableArray);
                formdata.append('file', $('#editCompanyProfileModal input[name="companyLogo"]')[0].files[0]);

		        $.ajax({
		        	url: 'company-profile-edit.php',
                    type: "POST",
                    data: formdata,
                    processData: false,  // tell jQuery not to process the data
                    contentType: false,  // tell jQuery not to set contentType
					success: function(response) {
		        		response = response.replace('"', '');
		        		response = response.replace('"', '');
						// console.log(response);
		          		if (response == 'true') {
		          			getCompanyInfo();

		          			$('#editCompanyProfileModal #phoneTable tbody tr').not(':first').remove();

							$('input[name="companyName"]').val('');
							$('input[name="companyAddress1"]').val('');
							$('input[name="companyAddress2"]').val('');
							$('input[name="companyCity"]').val('');
							$('input[name="companyState"]').val('');
							$('input[name="companyZip"]').val('');

			                //clear billing address FXLRATR350
							$('input[name="companyBillingAddress1"]').val('');
							$('input[name="companyBillingAddress2"]').val('');
							$('input[name="companyBillingCity"]').val('');
							$('input[name="companyBillingState"]').val('');
							$('input[name="companyBillingZip"]').val('');


							$('input[name="companyWebsite"]').val('');
							$('input[name="companyColor"]').val('');
							$('input[name="companyColorHover"]').val('');
							$('input[name="companyEmailFrom"]').val('');
							$('input[name="companyEmailReply"]').val('');
							$('input[name="defaultInvoices"]').val('');
							$('input[name="invoiceSplitBidAcceptance"]').val('');
							$('input[name="invoiceSplitProjectComplete"]').val('');
							$('input[name="timezone"]').val('');
							$('input[name="daylightSavings"]').val('');
							$('input[name="recentlyCompletedStatus"]').val('');
							$('input[name="companyLogo"]').val('');

							$('#loading-image').hide();

							disableCancelButton = false;
		          			$('#editCompanyProfileModal').foundation('close');
						 	$('#companySuccessModal').foundation('open');
		          		} else {

		          			$('#companyErrorModal p.error-text').text(response);
						 	$('#companyErrorModal').foundation('open');
		          		}

					}, error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
					}

				});

		    }
  		}

	};


	var getCompanyInfo = function() {
		//Get Company General Info
    	$.ajax({
			url: 'getCompany.php',
			dataType: "json",
			contentType: 'application/json',
			type: "GET",
			contentType: "application/x-www-form-urlencoded",
			success: function(response) {

				$('.project-title').text(response.companyName);

				$('.website').html('Website: <a href="'+response.companyWebsite+'">'+response.companyWebsite+'</a>');

				if (response.companyAddress2) { var companyAddress2 = ', ' + response.companyAddress2 }
				else { var companyAddress2 = ''; }

				$('.companyAddress').html(''+response.companyAddress1+''+companyAddress2+'<br/>'+response.companyCity+', '+response.companyState+' '+response.companyZip+'');

				//billing address FXLRATR 350
				if (response.companyBillingAddress1){

					if(response.companyBillingAddress2) 
						{ 
							var companyBillingAddress2 =', '+response.companyBillingAddress2;
						}else{
							var companyBillingAddress2 = '';
						}
					$('.companyBillingAddress').html(''+response.companyBillingAddress1+''+companyBillingAddress2+ 
						'<br/>' + response.companyBillingCity + ', ' + response.companyBillingState + ' ' + response.companyBillingZip);
				}else{
					$('.companyBillingAddress').html('-As Above-');
				}
				

				if (response.companyLogo != null) {
					$('.companyLogo').html('<img src="image.php?type=companylogo&cid='+response.companyID+'&name='+response.companyLogo+'" style="width:10rem;" />');

					if ($('.companyLogo span.noPhoto').length > 0) {
						$('.companyLogo span.noPhoto').remove();
					}
				}

				$('.companyColor span').css('background',response.companyColor);
				$('.companyColorHover span').css('background',response.companyColorHover);

				$('.fromAddress').text(response.companyEmailFrom);
				$('.replyAddress').text(response.companyEmailReply);

				$('.defaultInvoices').text(response.defaultInvoices);

				var invoiceSplitBidAcceptance = (response.invoiceSplitBidAcceptance * 100).toFixed(0);
				var invoiceSplitProjectComplete = (response.invoiceSplitProjectComplete * 100).toFixed(0);
				$('.invoiceBidAcceptance').text(invoiceSplitBidAcceptance+'%');
				$('.invoiceProjectComplete').text(invoiceSplitProjectComplete+'%');

				if (response.timezone == '-18000') {
					$('.timezone').text('Eastern Time Zone');

				} else if (response.timezone == '-21600') {
					$('.timezone').text('Central Time Zone');

				} else if (response.timezone == '-25200') {
					$('.timezone').text('Mountain Time Zone');

				} else if (response.timezone == '-28800') {
					$('.timezone').text('Pacific Time Zone');

				} else if (response.timezone == '-32400') {
					$('.timezone').text('Alaska Time Zone');

				} else if (response.timezone == '-36000') {
					$('.timezone').text('Hawaii Time Zone');

				} else {
					$('.timezone').text('');
				}


				if (response.daylightSavings == 1) {
					$('.daylightSavings').text('Yes');

				} else {
					$('.daylightSavings').text('No');

				}

				$('.recentlyCompletedStatus').text(response.recentlyCompletedStatus+' Days');

				//On Success Get Company Phone
                $.ajax({
					url: 'getCompanyPhone.php',
					dataType: "json",
					contentType: 'application/json',
					type: "GET",
					contentType: "application/x-www-form-urlencoded",
					success: function(response) {
						$('.companyPhones').empty();
						$.each(response, function (i, item) {

							if (item.isPrimary == 1) {
								$('.companyPhones').append(''+item.phoneDescription+': '+item.phoneNumber+'<span style="font-size:.7rem;font-style:italic;color:#999999;"> primary</span><br/>');
							} else {
								$('.companyPhones').append(''+item.phoneDescription+': '+item.phoneNumber+'<br/>');
							}
		                });

					}, error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
					}

				});

			}, error: function(jqXHR, textStatus, errorThrown) {
  				console.log(textStatus, errorThrown);
				console.log(jqXHR.responseText);
			}

		});
	};


	// var cancelAddWarranty = function() {
	// 	$('#addWarrantyModal input[name="warrantyName"]').val('');
	// 	$('#addWarrantyModal input[name="warrantyFile"]').val('');

	// 	$('#addWarrantyModal').foundation('close');
	// };


	// var saveAddWarranty = function() {
		

	// 	function fileType(file) {
	// 	    var extension = file.substr( (file.lastIndexOf('.') +1) );
	// 	    extension = extension.toLowerCase();
	// 	    switch(extension) {
	// 	        case 'jpg':
	// 	        case 'png':
	// 	        case 'gif':
	// 	            return('1');
	// 	        break;
	// 	        case 'zip':
	// 	        case 'rar':
	// 	            return('0');
	// 	        break;
	// 	        case 'pdf':
	// 	            return('0');
	// 	        break;
	// 	        default:
	// 	            return('0');
	// 	    }
	// 	};

	// 	var warrantyFile = $('#addWarrantyModal input[name="warrantyFile"]').val()

	// 	var fileType = fileType(warrantyFile);


	// 	var addWarranty;

	// 	if ($('#addWarrantyModal input[name="warrantyName"]').val() == '' || $('#addWarrantyModal input[name="warrantyFile"]').val() == '') {
	// 		addWarranty = 0;

	// 		$('#addWarrantyModal input[name="warrantyName"], #addWarrantyModal input[name="warrantyFile"]').each(function(){
	//   			if ($(this).val() == '') {
	// 	  			$(this).parent().addClass('is-invalid-label');
	// 				$(this).addClass('is-invalid-input');
	// 				$(this).parent().find('.form-error').addClass('is-visible');
	// 	  		} else {
	// 	  			$(this).parent().removeClass('is-invalid-label');
	// 				$(this).removeClass('is-invalid-input');
	// 				$(this).parent().find('.form-error').removeClass('is-visible');
	// 	  		}

	//   		});

	//    	} else {
	//    		if (fileType == 1) {
	//    			addWarranty = 1;
	//    			$('#addWarrantyModal input[name="warrantyFile"]').parent().find('.type-error').removeClass('is-visible');
	//    		} else {
	//    			addWarranty = 0;
	//    			$(this).parent().removeClass('is-invalid-label');
	// 			$(this).removeClass('is-invalid-input');
	// 			$('#addWarrantyModal input[name="warrantyFile"]').parent().find('.type-error').addClass('is-visible');
	//    		}
	//    	}


	//    	if (addWarranty == 1) {

	//    		$('#loading-image').show();

	//    		var warrantyName = $('#addWarrantyModal input[name="warrantyName"]').val();

	// 		var formdata = new FormData();
	//         formdata.append('warrantyName', warrantyName);
	//         formdata.append('file', $('#addWarrantyModal input[name="warrantyFile"]')[0].files[0]);

	//         $.ajax({
	//         	url: 'warranty-add.php',
	//             type: "POST",
	//             data: formdata,
	//             processData: false,  // tell jQuery not to process the data
	//             contentType: false,  // tell jQuery not to set contentType
	// 			success: function(response) {
	// 				console.log(response);
	// 				if (response != null) {

	// 					$.ajax({
	// 			        	url: 'getWarrantyDocument.php',
	// 			            dataType: "json",
	// 			            contentType: 'application/json',
	// 			            type: "GET",
	// 			            contentType: "application/x-www-form-urlencoded",
	// 			            data: {
	// 			            	warrantyID: response
	// 			            },
	// 			            success: function (response) {
	// 							console.log(response);
	// 							if (response != null) {

	// 								$.each(response, function (i, item) {
	// 									$('#warrantyCoordinatesModal .warranty-name').text(item.name);

	// 									$('#warrantyCoordinatesModal .warranty-preview img').attr('src','image.php?type=warranty&cid='+item.companyID+'&name='+item.file+'');

	// 									$('#warrantyCoordinatesModal input[name="warrantyID"]').val(item.warrantyID);
	// 								});


	// 								$('#addWarrantyModal').foundation('close');

	// 								$('#loading-image').hide();

	// 								$('#addWarrantyModal input[name="warrantyName"]').val('');
	// 								$('#addWarrantyModal input[name="warrantyFile"]').val('');

	// 								$('#warrantyTable tbody tr').not(':first').remove();

	// 								//Reload Warranties
	// 								companyWarranties();

	// 								$('#warrantyCoordinatesModal input[name="addressPosition"]').filter('[value="center"]').prop('checked', true);
	// 								$('#warrantyCoordinatesModal .address-position').addClass('box-center');

	// 								$('#warrantyCoordinatesModal').foundation('open');
	// 							}
	// 						},
	// 						error: function(jqXHR, textStatus, errorThrown) {
	// 				  				console.log(textStatus, errorThrown);
	// 								console.log(jqXHR.responseText);
	// 						}
	// 				    });

	// 				}
	// 			},
	// 			error: function(jqXHR, textStatus, errorThrown) {
	// 	  				console.log(textStatus, errorThrown);
	// 					console.log(jqXHR.responseText);
	// 			}
	// 	    });

	//    	}

	// };


	var cancelWarrantyCoordinates = function() {
		$('#warrantyCoordinatesModal .warranty-preview img').attr('src','');
		$('#warrantyCoordinatesModal .warranty-name').text('');

		$('#warrantyCoordinatesModal input[name="addressCoordinatesX"]').val();
		$('#warrantyCoordinatesModal input[name="addressCoordinatesY"]').val();
		$('#warrantyCoordinatesModal input[name="warrantyID"]').val();

		$('#warrantyCoordinatesModal .address-position').css('top', '');
		$('#warrantyCoordinatesModal .address-position').css('left', '');
		$('#warrantyCoordinatesModal input[name="addressPosition"]').prop('checked',false);
		$('#warrantyCoordinatesModal .address-position').removeClass('box-center');
		$('#warrantyCoordinatesModal .address-position').removeClass('box-left');
		$('#warrantyCoordinatesModal .address-position').removeClass('box-right');

		$('#warrantyCoordinatesModal').foundation('close');
	};


	var saveWarrantyCoordinates = function() {
		var saveCoordinates;

		var warrantyID = $('#warrantyCoordinatesModal input[name="warrantyID"]').val();
		var warrantyName = $('#warrantyCoordinatesModal .warranty-name').text();
		var addressCoordinatesX = $('#warrantyCoordinatesModal input[name="addressCoordinatesX"]').val();
		var addressCoordinatesY = $('#warrantyCoordinatesModal input[name="addressCoordinatesY"]').val();
		var addressPosition = $('#warrantyCoordinatesModal input[name="addressPosition"]:checked').val();

		if (addressCoordinatesX == '' || addressCoordinatesY == ''){
			saveCoordinates = 0;
			$('#warrantyCoordinatesModal .form-error').addClass('is-visible');

		} else {
			saveCoordinates = 1;
			$('#warrantyCoordinatesModal .form-error').removeClass('is-visible');
		}


		if (saveCoordinates == 1) {
			$.ajax({
	        	url: 'warranty-edit.php',
	            dataType: "json",
	            contentType: 'application/json',
	            type: "POST",
	            contentType: "application/x-www-form-urlencoded",
	            data: {
	            	warrantyID: warrantyID,
	            	warrantyName: warrantyName,
	            	addressCoordinatesX: addressCoordinatesX,
	            	addressCoordinatesY: addressCoordinatesY,
	            	addressPosition: addressPosition
	            },
	            success: function (response) {
					if (response == 'true') {

						$('#warrantyCoordinatesModal .warranty-preview').attr('src','');
						$('#warrantyCoordinatesModal .warranty-name').text('');

						$('#warrantyCoordinatesModal input[name="addressCoordinatesX"]').val();
						$('#warrantyCoordinatesModal input[name="addressCoordinatesY"]').val();
						$('#warrantyCoordinatesModal input[name="warrantyID"]').val();

						$('#warrantyCoordinatesModal .address-position').css('top', '');
						$('#warrantyCoordinatesModal .address-position').css('left', '');
						$('#warrantyCoordinatesModal input[name="addressPosition"]').prop('checked',false);
						$('#warrantyCoordinatesModal .address-position').removeClass('box-center');
						$('#warrantyCoordinatesModal .address-position').removeClass('box-left');
						$('#warrantyCoordinatesModal .address-position').removeClass('box-right');

						$('#warrantyTable tbody tr').not(':first').remove();

						//Reload Warranties
						companyWarranties();

						$('#warrantyCoordinatesModal').foundation('close');

						$('#successModal .modal-content').text('Your warranty has been added!');
						$('#successModal').foundation('open');

					}
				},
				error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
				}
		    });

		}

	};



	var companyWarranties = function() {
		$.ajax({
            url: 'getWarranty.php',
            dataType: "json",
            contentType: 'application/json',
            type: "GET",
            contentType: "application/x-www-form-urlencoded",
            success: function (response) {

                if (!response == '') {
                    $.each(response, function (i, item) {
                    	$cloneRow = $('#warrantyTable tbody tr:first').clone().css('display', '');

				        $cloneRow.find('td.WarrantyName').text(decodeEntities(item.name));
				      	$cloneRow.find('td.WarrantyDate').text(item.lastUpdated);
				      	$cloneRow.find('td.WarrantyStatus').text(item.type);
				      	$cloneRow.find('td #previewWarranty').attr('href','warranty-preview.php?id='+item.warrantyID);

				        $cloneRow.find('td.WarrantyName').attr('id', item.warrantyID);


				        $('#warrantyTable tbody').append($cloneRow);
				        //$('#userPhoneTable tbody > tr:last-child input.isPrimary').click(isPrimaryCheckUser);
				        $('#warrantyTable tbody > tr:last-child #editWarranty').click(warrantyEdit);
				        $('#warrantyTable tbody > tr:last-child #deleteWarranty').click(warrantyDelete);

                    });
               	}
            }, error: function (jqXHR, textStatus, errorThrown) {
                console.log(textStatus, errorThrown);
                console.log(jqXHR.responseText);
            }

       	});
	};


	var warrantyEdit = function() {
		var idtoEdit = $(this).parent().parent().find('td.WarrantyName').attr('id');

		$.ajax({
        	url: 'getWarrantyDocument.php',
            dataType: "json",
            contentType: 'application/json',
            type: "GET",
            contentType: "application/x-www-form-urlencoded",
            data: {
            	warrantyID: idtoEdit
            },
            success: function (response) {
				//console.log(response);
				if (response != null) {

					$.each(response, function (i, item) {
						$('#warrantyEditModal input[name="editWarrantyID"]').val(item.warrantyID);

						$('#warrantyEditModal input[name="editWarrantyName"]').val(item.name);

						if (item.type ==0){
							//this is a certificate
							$('#optEditCertificate').prop('checked', 'checked');
						}else{
							//this is a document
							$('#optEditDocument').prop('checked', 'checked');
						}


						// $('#warrantyEditModal .warranty-preview img').attr('src','image.php?type=warranty&cid='+item.companyID+'&name='+item.file+'');

						// $('#warrantyEditModal .address-position').css({top: item.addressCoordinatesY+'px', left: item.addressCoordinatesX+'px'});

						// $('#warrantyEditModal input[name="addressCoordinatesX"]').val(item.addressCoordinatesX);
						// $('#warrantyEditModal input[name="addressCoordinatesY"]').val(item.addressCoordinatesY);

						// if (item.addressPosition == 'center') {
						// 	$('.address-position').addClass('box-center');
						// 	$('#warrantyEditModal input[name="addressPosition"]').filter('[value="center"]').prop('checked', true);

						// } else if (item.addressPosition == 'left') {
						// 	$('.address-position').addClass('box-left');
						// 	$('#warrantyEditModal input[name="addressPosition"]').filter('[value="left"]').prop('checked', true);

						// } else if (item.addressPosition == 'right') {
						// 	$('.address-position').addClass('box-right');
						// 	$('#warrantyEditModal input[name="addressPosition"]').filter('[value="right"]').prop('checked', true);


						// }

							$('textarea#warrantyEditModal').html(item.warranty);
							tinyMCE.get('editWarrantyBody').setContent(item.warranty);
							$('#warrantyEditModal').foundation('open');
							
							
					});


				}
			},
			error: function(jqXHR, textStatus, errorThrown) {
	  				console.log(textStatus, errorThrown);
					console.log(jqXHR.responseText);
			}
	    });

	};



	var cancelEditWarranty = function() {

		// $('#warrantyEditModal .warranty-preview img').attr('src','');
		$('#warrantyEditModal input[name="warrantyName"]').val('');
		$('input[name="warrantyID"]').val('');
		tinyMCE.activeEditor.setContent("");
		$('#optEditCertificate').prop('checked', 'checked');
		$('#editWarrantyNameError').removeClass('is-visible');
		$('#warrantyEditError').removeClass('is-visible');

		// $('#warrantyEditModal input[name="addressCoordinatesX"]').val('');
		// $('#warrantyEditModal input[name="addressCoordinatesY"]').val('');
		// $('#warrantyEditModal input[name="warrantyID"]').val('');

		// $('#warrantyEditModal .address-position').css('top', '');
		// $('#warrantyEditModal .address-position').css('left', '');
		// $('#warrantyEditModal input[name="addressPosition"]').prop('checked',false);
		// $('#warrantyEditModal .address-position').removeClass('box-center');
		// $('#warrantyEditModal .address-position').removeClass('box-left');
		// $('#warrantyEditModal .address-position').removeClass('box-right');

		$('#warrantyEditModal').foundation('close');

	};

	var warrantyDelete = function() {
		var idtoDelete = $(this).parent().parent().find('td.WarrantyName').attr('id');

		$('#warrantyDeleteModal input[name="warrantyID"]').val(idtoDelete);

		$('#warrantyDeleteModal').foundation('open');
	};


	var yesDeleteWarranty = function() {
		var idtoDelete = $('#warrantyDeleteModal input[name="warrantyID"]').val();

		//On Success
		// console.log(idtoDelete);

		$.ajax({
        	url: 'warranty-delete.php',
            dataType: "json",
            contentType: 'application/json',
            type: "POST",
            contentType: "application/x-www-form-urlencoded",
            data: {
            	warrantyID: idtoDelete
            },
            success: function (response) {
				//console.log(response);
				if (response == 'true') {

					$('#warrantyTable tbody tr').not(':first').remove();

					//Reload Warranties
					companyWarranties();

					$('#warrantyDeleteModal input[name="warrantyID"]').val('');
					$('#warrantyDeleteModal').foundation('close');

					$('#successModal .modal-content').text('Your warranty has been deleted!');
	        		$('#successModal').foundation('open');
				}
			},
			error: function(jqXHR, textStatus, errorThrown) {
	  				console.log(textStatus, errorThrown);
					console.log(jqXHR.responseText);
			}
	    });

	};

	var cancelDeleteWarranty = function() {
		$('#warrantyDeleteModal input[name="warrantyID"]').val('');
		$('#warrantyDeleteModal').foundation('close');
	};


	var companyDisclaimers = function() {
		$.ajax({
            url: 'getDisclaimers.php',
            dataType: "json",
            contentType: 'application/json',
            type: "GET",
            contentType: "application/x-www-form-urlencoded",
            success: function (response) {

                if (!response == '') {
                    $.each(response, function (i, item) {
                    	$cloneRow = $('#disclaimerTable tbody tr:first').clone().css('display', '');

				        $cloneRow.find('td.DisclaimerSection').text(item.sectionName);
				      	$cloneRow.find('td.DisclaimerName').text(decodeEntities(item.name));
				      	$cloneRow.find('td.Disclaimer').text(decodeEntities(item.disclaimer));
				      	$cloneRow.find('td.DisclaimerDate').text(item.lastUpdated);

				       $cloneRow.find('td.DisclaimerName').attr('id', item.disclaimerID);


				        $('#disclaimerTable tbody').append($cloneRow);
				        $('#disclaimerTable tbody > tr:last-child #editDisclaimer').click(disclaimerEdit);
				        $('#disclaimerTable tbody > tr:last-child #deleteDisclaimer').click(disclaimerDelete);

                    });
               	}
            }, error: function (jqXHR, textStatus, errorThrown) {
                console.log(textStatus, errorThrown);
                console.log(jqXHR.responseText);
            }

       	});
	};


	var cancelAddDisclaimer = function() {
		$('#addDisclaimerModal select[name="disclaimerSection"]').val('');
		$('#addDisclaimerModal input[name="disclaimerName"]').val('');
		$('#addDisclaimerModal textarea[name="disclaimer"]').val('');

		$('#addDisclaimerModal').foundation('close');
	};


	var saveAddDisclaimer = function() {
		var addDisclaimer;

		if ($('#addDisclaimerModal select[name="disclaimerSection"]').val() == '' ||
			$('#addDisclaimerModal input[name="disclaimerName"]').val() == '' ||
			$('#addDisclaimerModal textarea[name="disclaimer"]').val() == '') {
			addDisclaimer = 0;

			$('#addDisclaimerModal select[name="disclaimerSection"], #addDisclaimerModal input[name="disclaimerName"], #addDisclaimerModal textarea[name="disclaimer"]').each(function(){
	  			if ($(this).val() == '') {
		  			$(this).parent().addClass('is-invalid-label');
					$(this).addClass('is-invalid-input');
					$(this).parent().find('.form-error').addClass('is-visible');
		  		} else {
		  			$(this).parent().removeClass('is-invalid-label');
					$(this).removeClass('is-invalid-input');
					$(this).parent().find('.form-error').removeClass('is-visible');
		  		}

	  		});

	   	} else {
	   		addDisclaimer = 1;
	   	}

	   	if (addDisclaimer == 1) {

	   		var disclaimerSection = $('#addDisclaimerModal select[name="disclaimerSection"]').val();
	   		var disclaimerName = $('#addDisclaimerModal input[name="disclaimerName"]').val();
	   		var disclaimer = $('#addDisclaimerModal textarea[name="disclaimer"]').val();

	       $.ajax({
	            url: 'disclaimer-add.php',
	            dataType: "json",
	            contentType: 'application/json',
	            type: "POST",
	            contentType: "application/x-www-form-urlencoded",
	            data:{
	            	section: disclaimerSection,
	            	name: disclaimerName,
	            	disclaimer: disclaimer
	            },
	            success: function (response) {
					if (response == 'true') {

						$('#addDisclaimerModal').foundation('close');

						$('#addDisclaimerModal select[name="disclaimerSection"]').val('');
						$('#addDisclaimerModal input[name="disclaimerName"]').val('');
						$('#addDisclaimerModal textarea[name="disclaimer"]').val('');

						$('#disclaimerTable tbody tr').not(':first').remove();

						//Reload Warranties
						companyDisclaimers();

						$('#successModal .modal-content').text('Your disclaimer has been added!');
						$('#successModal').foundation('open');

					}
				},
				error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
				}
		    });

	   	}

	};

	var disclaimerDelete = function() {
		var idtoDelete = $(this).parent().parent().find('td.DisclaimerName').attr('id');

		$('#disclaimerDeleteModal input[name="disclaimerID"]').val(idtoDelete);

		$('#disclaimerDeleteModal').foundation('open');
	};

	var yesDeleteDisclaimer = function() {
		var idtoDelete = $('#disclaimerDeleteModal input[name="disclaimerID"]').val();

		//On Success
		$.ajax({
        	url: 'disclaimer-delete.php',
            dataType: "json",
            contentType: 'application/json',
            type: "POST",
            contentType: "application/x-www-form-urlencoded",
            data: {
            	disclaimerID: idtoDelete
            },
            success: function (response) {
				//console.log(response);
				if (response == 'true') {

					$('#disclaimerTable tbody tr').not(':first').remove();

					//Reload Warranties
					companyDisclaimers();

					$('#disclaimerDeleteModal input[name="disclaimerID"]').val('');
					$('#disclaimerDeleteModal').foundation('close');

					$('#successModal .modal-content').text('Your disclaimer has been deleted!');
	        		$('#successModal').foundation('open');
				}
			},
			error: function(jqXHR, textStatus, errorThrown) {
	  				console.log(textStatus, errorThrown);
					console.log(jqXHR.responseText);
			}
	    });

	};

	var cancelDeleteDisclaimer = function() {
		$('#disclaimerDeleteModal input[name="disclaimerID"]').val('');
		$('#disclaimerDeleteModal').foundation('close');
	};

	var disclaimerEdit = function() {
		var idtoEdit = $(this).parent().parent().find('td.DisclaimerName').attr('id');

		$.ajax({
        	url: 'getDisclaimerItem.php',
            dataType: "json",
            contentType: 'application/json',
            type: "GET",
            contentType: "application/x-www-form-urlencoded",
            data: {
            	disclaimerID: idtoEdit
            },
            success: function (response) {
				//console.log(response);
				if (response != null) {

					$.each(response, function (i, item) {
						$('#disclaimerEditModal input[name="disclaimerID"]').val(item.disclaimerID);
						$('#disclaimerEditModal input[name="disclaimerName"]').val(decodeEntities(item.name));
						$('#disclaimerEditModal textarea[name="disclaimer"]').val(decodeEntities(item.disclaimer));

						if ($('#disclaimerEditModal select[name="disclaimerSection"]').has('option[value="' + item.section + '"]').length > 0)
                            $('#disclaimerEditModal select[name="disclaimerSection"] > option[value="' + item.section + '"]').prop('selected', 'selected');

					});

					$('#disclaimerEditModal').foundation('open');
				}
			},
			error: function(jqXHR, textStatus, errorThrown) {
	  				console.log(textStatus, errorThrown);
					console.log(jqXHR.responseText);
			}
	    });

	};

	var saveEditDisclaimer = function() {
		var editDisclaimer;

		if ($('#disclaimerEditModal select[name="disclaimerSection"]').val() == '' ||
			$('#disclaimerEditModal input[name="disclaimerName"]').val() == '' ||
			$('#disclaimerEditModal textarea[name="disclaimer"]').val() == '') {
			editDisclaimer = 0;

			$('#disclaimerEditModal select[name="disclaimerSection"], #disclaimerEditModal input[name="disclaimerName"], #disclaimerEditModal textarea[name="disclaimer"]').each(function(){
	  			if ($(this).val() == '') {
		  			$(this).parent().addClass('is-invalid-label');
					$(this).addClass('is-invalid-input');
					$(this).parent().find('.form-error').addClass('is-visible');
		  		} else {
		  			$(this).parent().removeClass('is-invalid-label');
					$(this).removeClass('is-invalid-input');
					$(this).parent().find('.form-error').removeClass('is-visible');
		  		}

	  		});

	   	} else {
	   		editDisclaimer = 1;
	   	}

	   	if (editDisclaimer == 1) {

	   		var idToEdit = $('#disclaimerEditModal input[name="disclaimerID"]').val();
	   		var disclaimerSection = $('#disclaimerEditModal select[name="disclaimerSection"]').val();
	   		var disclaimerName = $('#disclaimerEditModal input[name="disclaimerName"]').val();
	   		var disclaimer = $('#disclaimerEditModal textarea[name="disclaimer"]').val();

	       $.ajax({
	            url: 'disclaimer-edit.php',
	            dataType: "json",
	            contentType: 'application/json',
	            type: "POST",
	            contentType: "application/x-www-form-urlencoded",
	            data:{
	            	disclaimerID: idToEdit,
	            	section: disclaimerSection,
	            	name: disclaimerName,
	            	disclaimer: disclaimer
	            },
	            success: function (response) {
					if (response == 'true') {

						$('#disclaimerEditModal input[name="disclaimerID"]').val();
						$('#disclaimerEditModal input[name="disclaimerName"]').val('');
						$('#disclaimerEditModal textarea[name="disclaimer"]').val('');
						$('#disclaimerEditModal select[name="disclaimerSection"]').val('');

						$('#disclaimerEditModal').foundation('close');

						$('#disclaimerTable tbody tr').not(':first').remove();

						//Reload Warranties
						companyDisclaimers();

						$('#successModal .modal-content').text('Your disclaimer has been edited!');
						$('#successModal').foundation('open');

					}
				},
				error: function(jqXHR, textStatus, errorThrown) {
		  				console.log(textStatus, errorThrown);
						console.log(jqXHR.responseText);
				}
		    });

	   	}
	};

	var cancelEditDisclaimer = function() {

		$('#disclaimerEditModal input[name="disclaimerID"]').val();
		$('#disclaimerEditModal input[name="disclaimerName"]').val('');
		$('#disclaimerEditModal textarea[name="disclaimer"]').val('');
		$('#disclaimerEditModal select[name="disclaimerSection"]').val('');

		$('#disclaimerEditModal').foundation('close');

	};

</script>
</head>
  <body>
	<?php  include_once 'header.html'  ?>
	<div id="loading-image" class="loadingImage">
        <img src="images/ajax-loader.gif" />
    </div>
    <div class="row expanded first-row" style="background-color:#f6f7fb;">
     	<div class="medium-12 columns">
      		<div class="medium-12 columns">
        		<h1 class="project-title"><?php echo $companyName;  ?></h1>
        	</div>
      	</div>
   	</div>
    <div class="row expanded" style="margin-bottom: 4rem;">
     	<div class="medium-12 columns no-pad">
      		<ul class="tabs" id="project-tabs">
  				<li style="width:14.28%" class="tabs-title is-active"><a aria-selected="true" id="generalTabLink">General</a></li>
  				<li style="width:14.28%" class="tabs-title"><a id="usersTabLink">Users</a></li>
              	<li style="width:14.28%" class="tabs-title"><a id="servicesTabLink">Services &amp; Bid</a></li>
             	<li style="width:14.28%" class="tabs-title"><a id="pricingTabLink">Pricing</a></li>
              	<li style="width:14.28%" class="tabs-title"><a id="contractTabLink">Contract</a></li>
              	<li style="width:14.28%" class="tabs-title"><a id="emailsTabLink">Emails</a></li>
              	<li style="width:14.28%" class="tabs-title"><a id="finalPacketTabLink">Final Packet</a></li>
			</ul>
          	<div class="tabs-content" data-tabs-content="project-tabs">
  				<div class="tabs-panel is-active" id="general">
                  <div class="row expanded">
                  	<div class="medium-3 columns" style="border-right: 1px dotted #cbcacf;">
                    	<div class="row" style="margin:0 1.5rem 4rem 1.5rem;">
                            <div class="medium-12 columns">
                    			<h4>Company Info</h4>
                 			</div>
                        	<div class="medium-12 columns" style="margin-bottom: 2rem;">
                             	<p style="margin-bottom:0;">
                                    <label><strong>Address</strong></label>
                             	</p>
                                <p class="companyAddress" style="margin-bottom:0;">
                                    <?php echo $companyAddress1;  ?>, <?php echo $companyAddress2;  ?><br/>
                          			<?php echo $companyCity;  ?>, <?php echo $companyState;  ?> <?php echo $companyZip;  ?>
                                </p>
                            	<p>
                                <p style="margin-bottom:0;">
                                      <label><strong>Billing Address</strong></label>
                               	</p>
                                <p class="companyBillingAddress" style="margin-bottom:0;">
                                    <?php echo $companyBillingAddress1;  ?> <?php echo $companyBillingAddress2;?>
                            	<?php echo $companyBillingCity;  ?> <?php echo $companyBillingState;  ?> <?php echo $companyBillingZip;  ?>
                                </p>
                              	<p>
                            	<p style="margin-bottom:0;">
                                    <label><strong>Contact Information</strong></label>
                             	</p>
                             	<p class="companyPhones" style="margin-bottom:0;">
                             		<?php echo $phoneDisplay;  ?>
                             	</p>
                                <p class="website">
                          			<a href="<?php echo $companyWebsite;  ?>"><?php echo $companyWebsite;  ?></a>
                             	</p>
                            </div>
                            <div class="medium-12 columns">
                    			<p><strong>Logo and Colors</strong></p>
                 			</div>
                 			<div class="medium-12 columns">
                                <p class="companyLogo">
                                   	<?php echo $logoDisplay;  ?><br/>
                             	</p>
                            </div>
                            <div class="medium-3 columns" style="margin-bottom: 2rem;">
                            	<label><strong>Primary Color</strong></label>
                                <p class="companyColor">
                                    <span style="height:3rem;width:3rem;background:<?php echo $companyColor;  ?>;display:block;margin-top:.3rem;border-radius: 30px;"></span>
                             	</p>
                            </div>
                            <div class="medium-4 columns" style="margin-bottom: 2rem;">
                            	<label><strong>Secondary Color</strong></label>
                                <p class="companyColorHover">
                                   <span style="height:3rem;width:3rem;background:<?php echo $companyColorHover;  ?>;display:block;margin-top:.3rem;border-radius: 30px;"></span>
                             	</p>
                            </div>
							<div class="medium-12 columns">
                                <p>
                               		<button id="editCompanyProfile" class="button">Edit</button>
                             	</p>
                          	</div>
                    	</div>
                    </div> 
                    <div class="medium-4 columns">
                    	<div class="row" style="margin:0 1.5rem 4rem 1.5rem;">
                    		<div class="medium-12 columns">
                    			<h4>Settings</h4>
                 			</div>
                    		<div class="medium-12 columns" style="margin-bottom: 1.5rem;">
                    			<p style="margin-bottom:0;"><strong>Email Defaults</strong></p>
                    			<p style="margin-bottom:0;">
                                    <label><strong>From Email Address</strong></label>
                             	</p>
                             	<p class="fromAddress" style="margin-bottom:1rem;">
                                    <?php echo $companyEmailFrom;  ?>
                                </p>
                             	<p style="margin-bottom:0;">
                                    <label><strong>Reply-To Email Address</strong></label>
                             	</p>
                             	<p class="replyAddress" style="margin-bottom:1rem;">
                                    <?php echo $companyEmailReply;  ?>
                                </p>
                 			</div>
                 			<div class="medium-12 columns" style="margin-bottom: 1.5rem;">
                    			<p style="margin-bottom:0;"><strong>Invoice Defaults</strong></p></strong>
                    			<p style="margin-bottom:0;">
                                    <label><strong>How many invoices are typically sent per project?</strong></label>
                             	</p>
                             	<p class="defaultInvoices" style="margin-bottom:1rem;">
                                    <?php echo $defaultInvoices;  ?>
                                </p>
                                <p style="margin-bottom:0;">
                                    <label><strong>What percentage of the bid total is collected at bid acceptance?</strong></label>
                             	</p>
                             	<p class="invoiceBidAcceptance" style="margin-bottom:1rem;">
                                    <?php echo $invoiceSplitBidAcceptance;  ?>
                                </p>
                                <p style="margin-bottom:0;">
                                    <label><strong>What percentage of the bid total is collected at project completion?</strong></label>
                             	</p>
                             	<p class="invoiceProjectComplete" style="margin-bottom:1rem;">
                                    <?php echo $invoiceSplitProjectComplete;  ?>
                                </p>
                 			</div>
                 			<div class="medium-12 columns" style="margin-bottom: 1.5rem;">
                    			<p style="margin-bottom:0;"><strong>Timezone</strong></p>
                    			<p style="margin-bottom:0;">
                                    <label><strong>What is your timezone?</strong></label>
                             	</p>
                             	<p class="timezone">
                                    <?php echo $timezoneDisplay;  ?>
                                </p>
                                <p style="margin-bottom:0;">
                                    <label><strong>Do you recognize daylight savings time?</strong></label>
                             	</p>
                             	<p class="daylightSavings" style="margin-bottom:1rem;">
                                    <?php echo $daylightSavingsDisplay;  ?>
                                </p>
                 			</div>
                 			<div class="medium-12 columns" style="margin-bottom: 1.5rem;">
                    			<p style="margin-bottom:0;"><strong>Project Status Defaults</strong></p></strong>
                    			<p style="margin-bottom:0;">
                                    <label><strong>How many days should recently completed projects show in project status?</strong></label>
                             	</p>
                             	<p class="recentlyCompletedStatus" style="margin-bottom:1.5rem;">
                                    <?php echo $recentlyCompletedStatus;  ?> Days
                                </p>
                            </div>
                 			<?php echo $quickbooksDisplay;  ?>
                    	</div>
                    </div>
                  	<div class="reveal small" id="editCompanyProfileModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
 						<h3 class="text-center">Edit Company Profile</h3>
 						<h5 class="subheader">General Info</h5>
      					<div class="row">
      						<div class="medium-6 columns">
      							<label>Company Name <small>required</small>
      								<input class="required" name="companyName" type="text" value="" />
      								<small class="form-error">Company Name is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
      						<div class="medium-6 columns">
      							<label>Address <small>(Street Address, P.O. Box) required</small>
      								<input class="required" name="companyAddress1" type="text" value="" />
      								<small class="form-error">Address is required.</small>
      							</label>
      						</div>
      						<div class="medium-4 columns">
      							<label>Address 2 <small>(Apt, Suite, Unit)</small>
      								<input name="companyAddress2" type="text" value="" />
      							</label>
      						</div>
      					</div>
      					<div class="row">
      						<div class="medium-4 columns">
      							<label>City <small>required</small>
      								<input class="required" name="companyCity" type="text" value="" />
      								<small class="form-error">City is required.</small>
      							</label>
      						</div>
      						<div class="medium-3 columns">
      							<label>State <small>required</small>
      								<select class="required" name="companyState">
                                		<?php echo $stateOptions;  ?>
                            		</select>
      								<small class="form-error">State is required.</small>
      							</label>
      						</div>
      						<div class="medium-3 columns">
      							<label>Zip <small>required</small>
      								<input class="required" name="companyZip" type="text" value="" />
      								<small class="form-error">Zip is required.</small>
      							</label>
      						</div>
      					</div>
               
						 <div class="row" style="margin-bottom:.5rem;">
							  <div class="large-10 columns" margin-bottom: .5rem;>
								  <label>
								  		<input type="checkBox" id="addBillingAddress"/>Use Different Billing Address <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="8" title="Billing address will appear on invoices instead of your primary address."><img src="images/icons/info.png" /></span>
								  </label>
							  </div>
						  </div>
							<div class="row" id="BillingAddress">
									<div class="medium-6 columns">
										<label>Billing Address 
											<small>(Street Address, P.O. Box) required</small>
											<input name="companyBillingAddress1" type="text" value="" />
											<small class="form-error">Billing Address is required.</small>
										</label>
									</div>

									<div class="medium-4 columns">
										<label>Billing Address 2 
											<small>(Apt, Suite, Unit)</small>
											<input name="companyBillingAddress2" type="text" value="" />
										</label>
									</div>
									<div class="medium-4 columns">
										<label>Billing City 
											<input  name="companyBillingCity" type="text" value="" />
											<small class="form-error">Billing City is required.</small>
										</label>
									</div>
									<div class="medium-3 columns">
										<label>Billing State 
											<select  name="companyBillingState">
												<?php echo $stateOptions;  ?>
											</select>
											<small class="form-error">Billing State is required.</small>
										</label>
									</div>
									<div class="medium-3 columns">
										<label>Billing Zip 
											<input  name="companyBillingZip" type="text" value=""/>
											<small  class="form-error">Billing Zip is required.</small>
										</label>
									</div>
						</div>
      					<div class="row">
      						<div class="medium-6 columns">
      							<label>Website <small>required</small>
      								<input class="required" name="companyWebsite" type="text" value="" />
      								<small class="form-error">Website is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
                    		<div class="large-9 columns" id="companyPhoneSection">
	                        	<table id="phoneTable" class="phoneTable" cellpadding="0" cellspacing="0">
	                            	<thead style="background:none;">
	                                	<tr>
	                                    	<th width="30%" style="text-align:left;color:#ffffff;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;"><label>Phone <small>required</small></label></th>
	                                    	<th width="40%" style="text-align:center;color:#ffffff;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;"></th>
	                                    	<th width="15%" style="text-align:center;color:#000000;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;">Primary</th>
	                                    	<th width="15%" style="text-align:center;color:#000000;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;">
	                                       	 <a class="addPhone"><img src="images/icons/phone_add.png" /></a>
	                                    	</th>
	                                	</tr>
	                            	</thead>
	                            	<tbody>
	                                	<tr style="display:none;">
	                                    	<td class="description" style="color:#36413e;text-align:center;">
	                                    		<input class="Description no-margin" sort="" name="description[]" type="text" value="">
	                                    	</td>
	                                    	<td class="number" style="color:#36413e;">
	                                        	<input class="Phone no-margin" class="phone" sort="" name="phone[]" type="text" value="">
	                                    	</td>
	                                    	<td class="primary" style="color:#36413e;text-align:center;">
	                                        	<input class="isPrimary no-margin" sort="" name="isPrimary[]" type="checkbox" value="1">
	                                    	</td>
	                                    	<td class="delete" style="color:#36413e;text-align:center;">
	                                        	<a class="deletePhone"><img src="images/icons/phone_delete.png" /></a>
	                                    	</td>
	                                	</tr>
	                           	 	</tbody>
	                        	</table>
	                        	<small style="margin-left: .5rem;" class="error-match onePhone">At least one phone is required.</small>
	                        	<small style="margin-left: .5rem;" class="error-match fullPhone">Description and complete phone number are required.</small>
	                        	<small style="margin-left: .5rem;" class="error-match primary">Please mark one phone number as primary.</small>
                    		</div>
                		</div>
                		<h5 class="subheader">Logo and Colors</h5>
                		<div class="row" style="margin-bottom: 1rem;">
			        		<div class="medium-12 columns">
			        			<div id="currentLogo">
			        			</div>
			        			<a style="font-size: .9rem;" id="addNewLogo">Upload New Logo</a>
			        			<div id="newLogoUpload" style="display:none;">
			        				<label><span class="update">Logo <small>(JPG, PNG or GIF)</small>
			            				<input style="margin-bottom: 1rem;" type="file" name="companyLogo" value="" />
                                	</label>
                                </div>
			          		</div>
			       		</div>
			       		<div class="row" style="margin-bottom:1rem;">
                            <div class="medium-2 columns">
                            	<label>Primary Color</label>
                              	<input type='text' id="companyColor" name="companyColor" value="" />
                            </div>
                        </div>
			       		<div class="row" style="margin-bottom:1rem;">
                            <div class="medium-2 columns">
                            	<label>Secondary Color</label>
                                <input type='text' id="companyColorHover" name="companyColorHover" value="" />
                            </div>
                        </div>
			       		<h5 class="subheader">Email Defaults</h5>
			       		<div class="row">
      						<div class="medium-5 columns">
      							<label>From Email Address <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="8" title="Email address that will show in the from field when sending emails to customers."><img src="images/icons/info.png" /></span> <small>required</small>
      								<input class="required" name="companyEmailFrom" type="text" value="" />
      								<small class="form-error">From email address is required.</small>
      							</label>
      						</div>
      						<div class="medium-5 columns">
      							<label>Reply-To Email Address <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="9" title="Email address that will show in the reply to field when sending emails to customers."><img src="images/icons/info.png" /></span> <small>required</small>
      								<input class="required" name="companyEmailReply" type="text" value="" />
      								<small class="form-error">Reply email address is required.</small>
      							</label>
      						</div>
      					</div>
			       		<h5 class="subheader">Invoice Defaults</h5>
			       		<div class="row">
      						<div class="medium-12 columns">
      							<label>How many invoices are typically sent per project? <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This is the typical number of invoices into which a project is split. For example, if an invoice is sent at project acceptance, another at project start, and the final at project end, you would enter &#34;3&#34; in this box."><img src="images/icons/info.png" /></span> <small>required</small></label>
      						</div>
      						<div class="medium-2 columns">
      							<input class="required number" name="defaultInvoices" type="text" value="" />
      							<small class="form-error">Total invoice number is required.</small>
      						</div>
      					</div>
			       		<div class="row">
			       			<div class="medium-12 columns">
      							<label>What percentage of the bid total is collected at bid acceptance? <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This is on an average. It can be modified on a per project basis."><img src="images/icons/info.png" /></span> <small>required</small></label>
      						</div>
      						<div class="medium-2 columns">
      							<input class="required percent" name="invoiceSplitBidAcceptance" type="text" value="" />
      							<small class="form-error">Bid acceptance percentage is required.</small>
      						</div>
      						<div class="medium-1 columns no-pad-left">
      							<label>%</label>
      						</div>
      					</div>
      					<div class="row">
      						<div class="medium-12 columns">
      							<label>What percentage of the bid total is collected at project completion? <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This is on an average. It can be modified on a per project basis."><img src="images/icons/info.png" /></span> <small>required</small></label>
      						</div>
      						<div class="medium-2 columns">
      							<input class="required percent" name="invoiceSplitProjectComplete" type="text" value="" />
      							<small class="form-error">Project completion percentage is required.</small>
      						</div>
      						<div class="medium-1 columns no-pad-left">
      							<label>%</label>
      						</div>
      					</div>
			       		<h5 class="subheader">Timezone</h5>
			       		<div class="row">
      						<div class="medium-4 columns">
      							<label>Timezone <small>required</small>
      								<select class="required" sort="" name="timezone">
	                                    <option>--</option>
	                                    <option value="-18000">Eastern Time Zone</option>
	                                    <option value="-21600">Central Time Zone</option>
	                                    <option value="-25200">Mountain Time Zone</option>
	                                    <option value="-28800">Pacific Time Zone</option>
	                                    <option value="-32400">Alaska Time Zone</option>
	                                    <option value="-36000">Hawaii Time Zone</option>
                                	</select>
                                	<small class="form-error">Timezone is required.</small>
      							</label>
      						</div>
      						<div class="medium-4 columns">
      							<label style="margin-top: 1.7rem;">
                                    <input type="checkbox" name="daylightSavings" value="1" />
                                    Daylight Savings <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="Check if you recognize daylight savings time."><img src="images/icons/info.png" /></span>
                               </label>
      						</div>
      					</div>
      					<h5 class="subheader">Project Status Defaults</h5>
			       		<div class="row" style="margin-bottom: 2rem;">
      						<div class="medium-12 columns">
      							<label>How many days should recently completed projects show in project status? <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This is the number of days a project will show in recently completed status in the project status tab on the dashboard."><img src="images/icons/info.png" /></span> <small>required</small></label>
      						</div>
      						<div class="medium-2 columns">
      							<input class="required number" name="recentlyCompletedStatus" type="text" value="" />
      							<small class="form-error">Recently Completed days is required.</small>
      						</div>
      					</div>
      					<div class="row">
			        		<div class="medium-12 columns">
			            		<p class="text-center no-margin">
			             			<button class="button" id="saveEditCompanyProfile">Save</button>
			                  		<button class="button secondary" id="closeEditCompanyProfile">Cancel</button>
			             		</p>
			          		</div>
			       		</div>
			   		</div>
			   		<div class="tiny reveal" id="companyErrorModal" data-reveal>
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<p class="text-center error-text" style="margin-top: 1rem;"></p>
                            	<p class="text-center no-margin">
                            		<button data-open="editCompanyProfileModal" class="button">OK</button>
                              	</p>
                            </div>
                     	</div>
                    </div>
                    <div class="tiny reveal" id="companySuccessModal" data-reveal>
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<p class="text-center no-margin">
                                	The company profile has been udpated!
                            		<br/><br/>
                            		<button class="button" data-close>OK</button>
                              	</p>
                            </div>
                     	</div>
                    </div>
                    <div id="syncCustomersModal" class="reveal large" data-reveal data-close-on-esc="false" data-close-on-click="false">
				        <h2 id="modalTitle" style="text-align:center;margin-bottom: 0;">Sync Customers</h2>
				        <p class="text-center" style="margin-bottom:1.5rem;">Select the matching customer from Foundation Accelerator.</p>
				  
			            <div class="row expanded" style="margin-bottom:4rem;">
			                <div class="medium-12 columns no-pad">
			                    <table id="syncCustomersTable" cellpadding="0" cellspacing="0">
			                        <thead>
			                            <tr>
			                                <th>Name</th>
			                                <th>Address</th>
			                                <th></th>
			                            </tr>
			                        </thead>
			                        <tbody>
			                            <tr style="display:none;">
			                                <td style="text-align: left;" class="name"></td>
			                                <td style="text-align: left;" class="address"></td>
			                                <td quickbooks="" class="link">
			                                	<select>
			                                		<option></option>
			                                	</select>
			                                </td>
			                            </tr>
			                        </tbody>
			                    </table>
			                </div>
			            </div>
			            <div class="row">
			                <div class="medium-12 columns text-center">
			                	<button class="button" id="saveSyncCutomersModal">Save</button>
			                    <button class="button secondary" id="closeSyncCutomersModal">Cancel</button>
			                </div>
			            </div>
			        </div>
			        <div id="quickbooksSettingsModal" class="reveal tiny" data-reveal data-close-on-esc="false" data-close-on-click="false">
				        <h2 id="modalTitle" style="text-align:center;margin-bottom: 0;">Quickbooks Settings</h2>
				        <!-- <p class="text-center" style="margin-bottom:1.5rem;"></p> -->
			            <div class="row">
			                <div class="medium-9 columns">
			                	<label>Default Service for Quickbooks Invoice
									<select name="quickbooksDefaultService">
										<option></option>
									</select>
									<small class="form-error">Default service is required.</small>
								</label>
			                </div>
			            </div>
			            <div class="row">
			                <div class="medium-12 columns text-center">
			                	<button class="button" id="saveQuickbooksSettings">Save</button>
			                    <button class="button secondary" id="closeQuickbooksSettings">Cancel</button>
			                </div>
			            </div>
			        </div>
  					</div>
  				</div>
          		<div class="tabs-panel" id="users">
          			<div class="medium-8 columns">
                      	<div class="row expanded">
                        	<div class="medium-12 columns">
                    			<h4>Manage Users</h4>
                           	</div>
                 		</div>
                         <div class="medium-12 columns" style="height:20rem;">
                         		<div class="row expanded">
                         			<div class="medium-3 columns">
                                    <div class="row expanded">
                        					<div class="medium-10 columns" style="padding-left:0;padding-right:0">
                        						<h5 style="margin-top: 0;margin-bottom: .3rem;">Users</h5>
                        					</div>
                       					<div class="medium-2 columns" style="margin:0;padding-left:0;padding-right:0;">
                            				<p class="addUser" style="text-align:right;margin-bottom:.4rem;">
                            					<img style="width:1.6rem;background:#ffffff;border-radius:3px;border:1px solid #EEEEEE;padding:.2rem;" src="images/icons/add.png" />
                          					</p>
                                      	</div>
                        				</div>
                                   	<div class="row expanded">
                                   		<div class="medium-12 columns" style="border:1px solid #EEEEEE;border-radius:3px;background-color:#ffffff;height:100%;padding-left:0;padding-right:0">
                                        	<div class="medium-12 columns cp-users" style="height:37.6rem;">
                                           		<ul class="no-bullet"></ul>
                                            </div>
                                      	</div>
                                   	</div>
                                    <div class="row expanded">
                                 		<div class="medium-12 columns" style="margin:.3rem 0 0 0;padding-left:0;padding-right:0;">
                                     		<label style="font-size: .8rem;">
                                           		<input style="margin-right: 0;" id="inactive" type="checkbox" name="inactive" value="1" />
                                         		View Inactive
                                            </label>
                                      	</div>
                                   	</div>
                     				</div>
                                <div class="medium-9 columns cp-user-settings" style="margin-bottom:4rem;">
                                        <h5>Settings</h5>
                                        <div class="medium-12 columns cp-user-settings-container" style="border:1px solid #EEEEEE;border-radius:3px;padding: .3rem 1.2rem;">
                                            <div class="medium-12 columns cp-user-form" id="" style="padding:.7rem 0 0 0;" >
                                                <p style="color:#0069b4;margin-bottom:0;"><span class="update">Update User</span><span class="add">Add User</span></p>

                                            		<form class="reportForm" id="myForm" data-abide action="company-profile.php" method="post">
                                                    <div class="row">
                                                        <div class="medium-6 columns">
                                                            <label><strong>First Name</strong> <small>required</small>
                                                                <input type="text" name="userFirstName" value="" class="required userEdit" />
                                                           <small class="form-error">First name is required.</small>
                                                        </label>
                                                    </div>
                                                    <div class="medium-6 columns">
                                                            <label><strong>Last Name</strong> <small>required</small>
                                                                <input type="text" name="userLastName" value="" class="required userEdit" />
                                                            <small class="form-error">Last name is required.</small>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="medium-6 columns">
                                                        <label><strong>Email</strong> <small>required</small>
                                                            <input type="text" name="userEmail" value="" class="required userEdit" />
                                                           <small class="form-error">Valid email is required.</small>
                                                        </label>
                                                    </div>
                                                    <div class="medium-6 columns">&nbsp;</div>
                                                </div>
                                               	 <div class="row" style="margin-bottom: .5rem;">
                                                    <div class="medium-6 columns">
                                                        <!-- <label><a id="changePassword">Change Password</a></label> -->
                                                        <label><a href="#" id="resetPassword" data-reveal-id="resetPasswordConfirm">Reset Password</a></label>
                                                   	</div>
                                               	</div>
                                                <div id="changePasswordInput" class="row" style="display:none">
                                                    <div class="medium-6 columns">
                                                        <label><span class="update"><strong>New</strong> </span><strong>Password</strong> <span class="add"><small>required</small></span>
                                                            <input id="password" type="password" name="userPassword" value="" class="userEdit" />
                                                           <small class="form-error pass-required">Password is required.</small>
                                                            <small class="error-match">Passwords do not match.</small>
                                                        </label>
                                                    </div>
                                                    <div class="medium-6 columns">
                                                        <label><strong>Re-Enter</strong> <span class="update"><strong>New</strong> </span><strong>Password</strong> <span class="add"><small>required</small></span>
                                                            <input id="password2" class="passwordMatch userEdit" type="password" name="userPassword2" value="" />
                                                           <small class="form-error pass-required">Re-Enter Password is required.</small>
                                                            <small class="error-match">Passwords do not match.</small>
                                                        </label>
                                                    </div>
                                                    <div class="medium-8 columns" >
                                                    	<div id="passwordErrors" class="form-error" style="display:none; margin-left: .5 rem;">
                                                    		<!-- password errors go here -->
                                                    	</div>
															<span style="margin-top:-2rem; display:none;" class="hidden" id="passwordInfo">
															<p>
																<strong><small>Please note: </strong>
																Password must contain:
																<ul style="list-style:none; margin-top:-.8rem;"></small>
																	<li> <small>At least one UPPER CASE letter,</small></li>
																	<li> <small>At least one lower case letter,</small></li>
																	<li> <small>At least one number and </small> </li>
																	<li> <small>And be least 8 characters long.</small></li>
																</ul>
															</p>
															</span>
                                                    </div>
                                                    <div class="medium-2 columns">&nbsp;</div>
                                                </div>
                                                <div class="row" style="margin:.5rem 0">
						                    		<div class="large-9 columns no-pad" id="userPhoneSection">
							                        	<table id="userPhoneTable" class="phoneTable" cellpadding="0" cellspacing="0">
							                            	<thead style="background:none;">
							                                	<tr>
							                                    	<th width="30%" style="text-align:left;color:#ffffff;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;"><label><strong>Phone</strong></label></th>
							                                    	<th width="40%" style="text-align:center;color:#ffffff;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;"></th>
							                                    	<th width="15%" style="text-align:center;color:#000000;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;">Primary</th>
							                                    	<th width="15%" style="text-align:center;color:#000000;line-height: .5rem;border-bottom:0;padding:0rem 0.4rem;">
							                                       	 <a class="addPhone"><img src="images/icons/phone_add.png" /></a>
							                                    	</th>
							                                	</tr>
							                            	</thead>
							                            	<tbody>
							                                	<tr style="display:none;">
							                                    	<td class="description" style="color:#36413e;text-align:center;">
							                                        	<select class="Description no-margin userEdit" sort="" name="description[]">
							                                            	<option></option>
							                                            	<option value="Cell">Cell</option>
							                                            	<option value="Home">Home</option>
							                                            	<option value="Work">Work</option>
							                                            	<option value="Other">Other</option>
							                                        	</select>
							                                    	</td>
							                                    	<td class="number" style="color:#36413e;">
							                                        	<input class="Phone no-margin userEdit" sort="" name="phone[]" type="text" value="">
							                                    	</td>
							                                    	<td class="primary" style="color:#36413e;text-align:center;">
							                                        	<input class="isPrimary no-margin userEdit" sort="" name="isPrimary[]" type="checkbox" value="1">
							                                    	</td>
							                                    	<td class="delete" style="color:#36413e;text-align:center;">
							                                        	<a class="deletePhone"><img src="images/icons/phone_delete.png" /></a>
							                                    	</td>
							                                	</tr>
							                           	 	</tbody>
							                        	</table>
							                        	<small style="margin-left: .5rem;" class="error-match onePhone">At least one phone is required.</small>
							                        	<small style="margin-left: .5rem;" class="error-match fullPhone">Description and complete phone number are required.</small>
							                        	<small style="margin-left: .5rem;" class="error-match primary">Please mark one phone number as primary.</small>
						                    		</div>
                                                </div>
                                                <div class="row">
                                                    <div class="medium-6 columns">
                                                    	<div class="medium-11 columns no-pad">
                                                        	<label><strong>Bio</strong>
                                                        		<textarea rows="5" name="userBio" class="userEdit"></textarea>
                                                        	</label>
                                                    	</div>
                                                		<label><strong>Photo</strong></label>
                                                		<div id="currentPhoto"></div>
									        			<a style="font-size: .9rem;" id="addNewPhoto">Upload New Photo</a>
									        			<div id="newPhotoUpload" style="display:none;">
									        				<label>Upload Photo <small>(JPG, PNG or GIF)</small>
									            				<input style="margin-bottom: 1rem;" type="file" name="userPhoto" value="" class="userEdit" />
						                                	</label>
						                                </div>
						                                <div class="row" style="margin-top:1rem;">
                                                    		<div class="medium-12 columns">
                                                    			<label><strong>Color</strong></label>
                                                      			<input type="text" id="showPalette"/>
                                                        		<input type="hidden" name="calendarBgColor" value="" class="userEdit" />
                                                    		</div>
                                                		</div>
                                                	</div>
                                                    <div class="medium-6 columns" style="margin-bottom: 1rem;">
                                                        <label><strong>Roles</strong></label>
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Primary <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This role has the ability to do all tasks within the other roles.  The primary can also manage the company profile."><img src="images/icons/info.png" /></span>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="primary" type="checkbox" name="primary" value="1">
														  			<label class="switch-paddle" for="primary"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Sales Management <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="2" title="This role is responsible for creating the customers and projects.  The sales manager can schedule sales appointments and installations.  The role can also modify the customer and project information as well as complete or cancel projects."><img src="images/icons/info.png" /></span>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="projectManagement" type="checkbox" name="projectManagement" value="1">
														  			<label class="switch-paddle" for="projectManagement"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Sales <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="3" title="This role is responsible for sales appointments.  This role will be scheduled on the calendar for sales."><img src="images/icons/info.png" /></span>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="sales" type="checkbox" name="sales" value="1">
														  			<label class="switch-paddle" for="sales"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                		<hr class="roles">
                                                		<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Marketing <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="3" title="This role is responsible for overseeing marketing efforts."><img src="images/icons/info.png" /></span>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="marketing" type="checkbox" name="marketing" value="1">
														  			<label class="switch-paddle" for="marketing"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Bid Creation <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="5" title="This role creates the bid after the evaluation."><img src="images/icons/info.png" /></span></label>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="bidCreation" type="checkbox" name="bidCreation" value="1">
														  			<label class="switch-paddle" for="bidCreation"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Bid Verification <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="6" title="This role verifies the bid after it has been created.  This role will check the prices that were entered and change if necessary."><img src="images/icons/info.png" /></span></label>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="bidVerification" type="checkbox" name="bidVerification" value="1">
														  			<label class="switch-paddle" for="bidVerification"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Installation <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="4" title="This role is responsible for installations.  This role will be scheduled on the calendar for installations."><img src="images/icons/info.png" /></span></label>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="installation" type="checkbox" name="installation" value="1">
														  			<label class="switch-paddle" for="installation"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Pier Data Recorder <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="7" title="This role enters the final pier data which determines the final load calculations."><img src="images/icons/info.png" /></span></label>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="pierDataRecorder" type="checkbox" name="pierDataRecorder" value="1">
														  			<label class="switch-paddle" for="pierDataRecorder"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Timecard Approver <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="7" title="This role approves crewman timecards."><img src="images/icons/info.png" /></span></label>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="timecardApprover" type="checkbox" name="timecardApprover" value="1">
														  			<label class="switch-paddle" for="timecardApprover"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                       	<hr class="roles">
                                                       	<label style="margin-top:2rem;"><strong>Active</strong></label>
                                                       	<div class="row">
                                                    		<div class="medium-8 columns">
                                                        		<label>Is the user active?</label>
                                                    		</div>
                                                    		<div class="medium-4 columns">
                                                    			<div class="switch tiny">
														  			<input class="switch-input userEdit" id="userActive" type="checkbox" name="userActive" value="1">
														  			<label class="switch-paddle" for="userActive"></label>
																</div>
                                                    		</div>
                                                		</div>
                                                    </div>
                                                </div>
                                                <div class="row" style="margin-top:1rem">
                                                    <div class="medium-6 columns">
                                                        <input type="hidden" name="userID" value="" />
                                                        <a id="updateExistingUser" class="button update">Save</a>
                                                        <a id="submitNewUser" class="button add">Add</a>
                                                    </div>
                                                </div>
                                            </form>
                                            </div>


											<div class="tiny reveal" id="resetPasswordConfirm" data-reveal>
                                           		<h5 class="text-center">Are you sure you want to reset the password for: </h5>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p id="resetUserName" class="text-center no-margin">
                                        
                                                    	</p>
                                                    	<p class="text-center" style="margin-top: .5rem;">
                                                     		<button class="button" id="resetPasswordConfirmed">Yes</button>
                                                     		<button class="button secondary" data-close>No</button>
                                                     	</p>
                                                    </div>
                                                </div>
                                            </div>

											<div class="tiny reveal" id="resetPasswordEmailSent" data-reveal>
                                           		<h5 class="text-center">A password reset email has been sent to </h5>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p id="passwordResetUserName" class="text-center no-margin">
                                        					
                                                    	</p>
                                                    	<p class="text-center" style="margin-top: .5rem;">
                                                     		<button class="button" data-close>OK</button>
                                                     	</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="tiny reveal" id="userUpdatedModal" data-reveal>
                                           		<h3 class="text-center">User Updated</h3>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p class="text-center no-margin">
                                                    		User has been updated!
                                                       	<br/><br/>
                                                     		<button class="button" data-close>OK</button>
                                                    	</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tiny reveal" id="userAddedModal" data-reveal>
                                           		<h3 class="text-center">User Added</h3>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p class="text-center no-margin">
                                                    		User has been added!
                                                       	<br/><br/>
                                                     		<button class="button" data-close>OK</button>
                                                    	</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tiny reveal" id="userErrorModal" data-reveal>
                                           		<h3 class="text-center">Error</h3>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p id="errorMessage" class="text-center">

                                                       	</p>
                                                       	<p class="text-center no-margin">
                                                     		<button class="button" data-close>OK</button>
                                                    	</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tiny reveal" id="usersExceededModal" data-reveal>
                                           		<h3 class="text-center">User Limit Exceeded</h3>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p id="errorMessage" class="text-center">
                                                 			You do not have any available users to add.  Please go to account settings to purchase more users.
                                                       	</p>
                                                       	<p class="text-center no-margin">
                                                     		<button class="button" data-close>OK</button>
                                                    	</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tiny reveal" id="leaveBeforeSavingNewModal" data-reveal>
                                           		<h3 class="text-center">New User Not Saved</h3>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p id="errorMessage" class="text-center">
                                                 		Are you sure you want to continue without saving? 
                                                       	</p>
                                                       	<p class="text-center no-margin">
                                                       		<input type="hidden" value="" name="moveToUserID" id="moveToUserID" />
                                                     		<button id="cancelNewUser" class="button" data-close>Ok</button>
                                                     		<button class="button secondary" data-close>Cancel</button>
                                                    	</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tiny reveal" id="leaveBeforeSavingExistingModal" data-reveal>
                                           		<h3 class="text-center">User Not Saved</h3>
                                            	<div class="row">
                                              		<div class="medium-12 columns">
                                                 		<p id="errorMessage" class="text-center">
                                                 		Are you sure you want to continue without saving your changes to this user? 
                                                       	</p>
                                                       	<p class="text-center no-margin">
                                                       		<input type="hidden" value="" name="moveToUserID" id="moveToUserID" />
                                                     		<button id="cancelExistingUser" class="button" data-close>Ok</button>
                                                     		<button class="button secondary" data-close>Cancel</button>
                                                    	</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                         		</div>
                         	</div>
                      </div>
                  </div>
              	<div class="tabs-panel" id="services">
                	<div class="medium-12 columns" style="margin: 0 0 .5rem 0;"> 
                    	<h4>Bid Intro</h4>
                 	</div>
                 		<div class="row">  
                     	</div>
<!--                        	<div style="margin:2rem 0 .5rem 0rem" class="row">
                        	<div class="large-12 columns">
            					<label>Bid Introduction</label>  
                            	<textarea rows="4" class="servicesAnswer" name="bidIntroDescription" section="description"></textarea>
           					</div>
           				</div> -->
		                <div class="row expanded">
		                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
		                		<label><textarea id="bidIntroDescription" rows="20"><?php echo $bidIntroDescription; ?></textarea>
		                       		<small style="margin-top: 1rem;" class="form-error">Bid introduction is required.</small>
		                     	</label>
							</div>
		                </div>  
		                <div class="row expanded">
	                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
	                        	<button style="margin-top: 1rem;" class="button" id="saveBidIntroDescription">Save</button>
	                     	</div>
	                 	</div>     
	                	<div id="emailSavedModal" class="reveal tiny" data-reveal data-close-on-esc="false" data-close-on-click="false">
	                     	<div class="row align-center">
	                    		<p></p>
	                    	</div>
	                     	<div class="row">
	                        	<div class="medium-12 columns text-center">
	                            	<button data-close class="button">Ok</button>
	                        	</div>
	                    	</div>
						</div>
						<div id="bidPreviewModal" class="reveal large" data-reveal>
<!-- 							<h3 id="modalTitle" style="text-align:center;margin-bottom:1.5rem;"></h3> -->
	                     	<div id="modalContent">
	                    	</div>
	                     	<div class="row">
	                        	<div class="medium-12 columns text-center">
	                            	<button data-close class="button">Close</button>
	                        	</div>
	                    	</div>
						</div>
	                	<div class="medium-12 columns" style="margin: 0 0 .5rem 0;"> 
	                    	<h4>Services</h4>
	                 	</div>
                 		<div class="medium-12 columns">
                			<h6>Select Your Company Services</h6>
               			</div>
               			<br/>
               			<div class="medium-12 columns">
                    	<div class="row">  
                      		<div class="large-5 columns">
                          		<label style="font-size: 1rem; color:#0069b4;">
                         			<input class="servicesAnswer" id="isPiering" type="checkbox" name="isPiering" section="company" value="1">
                          			Piering
                          		</label>  
                      		</div>
                  		</div> 
                    	<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isPiering">
                        	<!-- <div class="large-12 columns">
            					<label>Bid Description</label>  
                            	<textarea rows="4" class="servicesAnswer" name="pieringDescription" section="description"></textarea>
           					</div> -->
                        	<div class="large-12 columns">
            					<label><strong>Piering Sub Services</strong></label>
                        	</div>
              				<div class="large-12 columns">
            					<label> 
               						<input class="servicesAnswer" id="isGroutFootings" type="checkbox" name="isGroutFootings" value="1" section="company">
                						Grout Under Footings
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isGroutFootings">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="groutFootingDescription" section="description"></textarea>
           							</div>
                           		</div>
                        	</div> -->
          				</div>
                     	<div class="row">  
                      		<div class="large-5 columns">
                          		<label style="font-size: 1rem; color:#0069b4;">
                         			<input class="servicesAnswer" id="isWallRepair" type="checkbox" name="isWallRepair" value="1" section="company">
                          			Wall Repair
                          		</label>  
                      		</div>
                     	</div> 
                    	<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWallRepair">
                        	<!-- <div class="large-12 columns">
            					<label>Bid Description</label>  
                            	<textarea rows="4" class="servicesAnswer" name="wallRepairDescription" section="description"></textarea>
           					</div> -->
                       	<div class="large-12 columns">
            					<label><strong>Wall Repair Sub Services</strong></label>
                        	</div>
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isWallBraces" type="checkbox" name="isWallBraces" value="1" section="company">
                					Wall Braces
                 				</label>  
           					</div>
                    		<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWallBraces">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea class="servicesAnswer" name="wallBraceDescription" section="description"></textarea>
           							</div>
                        		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isWallStiffeners" type="checkbox" name="isWallStiffeners" value="1" section="company">
                					Wall Stiffeners
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWallStiffeners">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="wallStiffenerDescription" section="description"></textarea>
           							</div>
                        		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isWallAnchors" type="checkbox" name="isWallAnchors" value="1" section="company">
                					Wall Anchors
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWallAnchors">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="wallAnchorDescription" section="description"></textarea>
           							</div>
                           		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isWallExcavation" type="checkbox" name="isWallExcavation" value="1" section="company">
                					Wall Excavation
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWallStraightening">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="wallStraightenDescription" section="description"></textarea>
           							</div>
                        		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isBeamPocketRepair" type="checkbox" name="isBeamPocketRepair" value="1" section="company">
                					Beam Pocket Repair
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isBeamPocketRepair">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="beamPocketDescription" section="description"></textarea>
           							</div>
                        		</div>
                         	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isWindowWellReplacement" type="checkbox" name="isWindowWellReplacement" value="1" section="company">
                					 Window Well Replacement
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWindowWellReplacement">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="windowWellReplaceDescription" section="description"></textarea>
           							</div>
                        		</div>
                     		</div> -->
          				</div>
                      	<div class="row">  
                      	<div class="large-5 columns">
                          	<label style="font-size: 1rem; color:#0069b4;">
                         			<input class="servicesAnswer" id="isWaterManagement" type="checkbox" name="isWaterManagement" value="1" section="company">
                          		Water Management
                          	</label>  
                      	</div>
                      </div>   
                      <div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWaterManagement">
              				<!-- <div class="large-12 columns">
            					<label>Bid Description</label>  
                            	<textarea rows="4" class="servicesAnswer" name="waterManagementDescription" section="description"></textarea>
           					</div> -->
                        	<div class="large-12 columns">
            					<label><strong>Water Management Sub Services</strong></label>
                        	</div>
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isInstallSumpPumps" type="checkbox" name="isInstallSumpPumps" value="1" section="company">
                					Install Sump Pumps
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isInstallSumpPumps">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="sumpPumpDescription" section="description"></textarea>
           							</div>
                             	</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isInteriorDrainSystems" type="checkbox" name="isInteriorDrainSystems" value="1" section="company">
                					Interior Drain Systems
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isInteriorDrainSystems">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="interiorDrainDescription" section="description"></textarea>
           							</div>
                           		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isGutterDischarges" type="checkbox" name="isGutterDischarges" value="1" section="company">
                					Gutter Discharges
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isGutterDischarges">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="gutterDischargeDescription" section="description"></textarea>
           							</div>
                           		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isFrenchDrains" type="checkbox" name="isFrenchDrains" value="1" section="company">
                					French Drains
                 				</label>  
           					</div>
                       		<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isFrenchDrains">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="frenchDrainDescription" section="description"></textarea>
           							</div>
                            	</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isDrainInlets" type="checkbox" name="isDrainInlets" value="1" section="company">
                					Drain Fixtures
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isDrainInlets">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="drainInletDescription" section="description"></textarea>
           							</div>
                           		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isCurtainDrains" type="checkbox" name="isCurtainDrains" value="1" section="company">
                					Curtain Drains
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isCurtainDrains">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="curtainDrainDescription" section="description"></textarea>
           							</div>
                           		</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isWindowWellDrains" type="checkbox" name="isWindowWellDrains" value="1" section="company">
                					Window Well Drains
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isWindowWellDrains">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="windowWellDrainDescription" section="description"></textarea>
           							</div>
                            	</div>
                        	</div> -->
                        	<div class="large-12 columns">
            					<label> 
               					<input class="servicesAnswer" id="isExteriorGrading" type="checkbox" name="isExteriorGrading" value="1" section="company">
                					Exterior Grading
                 				</label>  
           					</div>
                        	<!-- <div class="large-12 columns">
                        		<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isExteriorGrading">
                        			<div class="large-12 columns">
            							<label>Bid Description</label>  
                            			<textarea rows="4" class="servicesAnswer" name="exteriorGradingDescription" section="description"></textarea>
           							</div>
                        		</div>
                         	</div> -->
          				</div> 
                      	<div class="row">  
                      		<div class="large-5 columns">
                          		<label style="font-size: 1rem; color:#0069b4;">
                         			<input class="servicesAnswer" id="isSupportPosts" type="checkbox" name="isSupportPosts" value="1" section="company">
                          			Support Posts
                          		</label>  
                      		</div>
                      	</div>
                        <!--<div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isSupportPosts">
                        	<div class="large-12 columns">
            					<label>Bid Description</label>  
                            	<textarea rows="4" class="servicesAnswer" name="supportPostDescription" section="description"></textarea>
           					</div>
          				</div> -->
                      	<div class="row">  
                      		<div class="large-5 columns">
                          		<label style="font-size: 1rem; color:#0069b4;">
                         			<input class="servicesAnswer" id="isCrackRepair" type="checkbox" name="isCrackRepair" value="1" section="company">
                          			Crack Repair
                          		</label>  
                      		</div>
                   		</div>   
                 		<!-- <div style="margin:0 0 .5rem 2rem" class="row servicesAnswer showNoTransition" parent="isCrackRepair">
                        	<div class="large-12 columns">
            					<label>Bid Description</label>  
                            	<textarea rows="4" class="servicesAnswer" name="crackRepairDescription" section="description"></textarea>
           					</div>
          				</div> -->
                      	<div class="row">  
                      		<div class="large-5 columns">
                          		<label style="font-size: 1rem; color:#0069b4;">
                         			<input class="servicesAnswer" id="isMudjacking" type="checkbox" name="isMudjacking" value="1" section="company">
                          			Mudjacking
                          		</label>  
                      		</div>
                      	</div>  
                      	<div class="row">  
                      		<div class="large-5 columns">
                          		<label style="font-size: 1rem; color:#0069b4;">
                         			<input class="servicesAnswer" id="isPolyurethaneFoam" type="checkbox" name="isPolyurethaneFoam" value="1" section="company">
                          			Polyurethane Foam
                          		</label>  
                      		</div>
                      	</div>  
                  	</div>
             	</div>
              	<div class="tabs-panel" id="pricing">
                	<div class="medium-12 columns" style="margin: 0 0 .5rem 0;">
                    	<h4>Pricing</h4>
                 	</div>
                 	<div class="servicesAnswer showNoTransition" parent="isPiering">
                  		<div class="medium-12 columns">
                    		<h5>Piering</h5>
                		</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="pieringDescription" section="description"></textarea>
           						</div>
                  		<div class="medium-12 columns">
                    		<h6>Pier Installation</h6>
                		</div>
               			<div class="medium-12 columns">
                			<div class="medium-12 columns">
                 				<table class="cpTable pricingPier" tablename="pricingPier" cellpadding="0" cellspacing="0">
									<thead>
        								<tr>
                                			<th width="5%">Order</th>
                   							<th width="25%">Manufacturer Pier</th>
                   							<th width="20%">Label</th>
                   							<th width="35%">Description</th>
            								<th width="10%">Price (each)</th>
            								<th width="5%"></th>
             							</tr>
         							</thead>
									<tbody>
                     					<tr style="display:none">
                                			<td>
                            					<input class="pricingAnswer Sort" section="pricingPier" name="sort" type="text" value="" />
                            					<input type="hidden" name="pricingPierID" value="">
                         					</td>
                            				<td>
                            					<select class="pricingAnswer ManufacturerItemID" section="pricingPier" name="manufacturerItemID" style="margin:0;">
                            						<option></option>
                            						<?php echo $manufacturerPierDisplay;  ?>
                            					</select>
                         					</td>
                         					<td>
                            					<input class="pricingAnswer Name" section="pricingPier" name="name" type="text" value="" />
                         					</td>
                         					<td>
                            					<textarea class="pricingAnswer Description" section="pricingPier" name="description"></textarea>
                         					</td>
                            				<td>
                            					<input class="pricingAnswer Price" section="pricingPier" name="price" type="text" value="" />
                         					</td>
                         					<td class="delete" style="color:#36413e;text-align:center;">
                                        		<a class="deleteRow" section="pricingPier"><img src="images/icons/phone_delete.png" /></a>
                                    		</td>
                       					</tr>
									</tbody>
								</table>
                 			</div>
               			</div>
                    	<div class="servicesAnswer showNoTransition" parent="isGroutFootings">
                    		<div class="medium-12 columns">
                    			<h6>Grout Under Footings</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-3 columns">
                   					<label>Grout Under Footings Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="pieringGroutPerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="groutFootingDescription" section="description"></textarea>
           						</div>
                     		</div>
                  		</div>
               		</div>
                	<div class="servicesAnswer showNoTransition" parent="isWallRepair">
                		<div class="medium-12 columns">
                    		<h5>Wall Repair</h5>
                		</div>
                     	<div class="servicesAnswer showNoTransition" parent="isWallBraces">
                  		<div class="medium-12 columns">
                    		<h6>Wall Braces</h6>
                		</div>
                			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                     				<table class="cpTable pricingWallBraces" tablename="pricingWallBraces" cellpadding="0" cellspacing="0">
										<thead>
            								<tr>
                                   	 			<th width="10%">Order</th>
                       							<th width="30%">Wall Brace Type</th>
                       							<th width="40%">Description</th>
                								<th width="10%">Price (each)</th>
                								<th width="10%"></th>
                 							</tr>
             							</thead>
										<tbody>
                         					<tr style="display:none">
                                    			<td>
                                					<input class="pricingAnswer Sort" section="pricingWallBraces" name="sort" type="text" value="" />
                                					<input type="hidden" name="pricingWallBracesID" value="">
                             					</td>
                                				<td>
                                					<input class="pricingAnswer Name" section="pricingWallBraces" name="name" type="text" value="" />
                             					</td>
                             					<td>
		                            				<textarea class="pricingAnswer Description" section="pricingWallBraces" name="description"></textarea>
		                         				</td>
                                				<td>
                                					<input class="pricingAnswer Price" section="pricingWallBraces" name="price" type="text" value="" />
                             					</td>
                             					<td class="delete" style="color:#36413e;text-align:center;">
	                                        		<a class="deleteRow" section="pricingWallBraces"><img src="images/icons/phone_delete.png" /></a>
	                                    		</td>
                           					</tr>
 										</tbody>
									</table>
                     			</div>
               				</div>
                     	</div>
                    	<div class="servicesAnswer showNoTransition" parent="isWallStiffeners">
                			<div class="medium-12 columns">
                				<h6>Wall Stiffener</h6>
                			</div>
                			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                     				<table class="cpTable pricingWallStiffener" tablename="pricingWallStiffener" cellpadding="0" cellspacing="0">
										<thead>
            								<tr>
                                    			<th width="10%">Order</th>
                       							<th width="30%">Wall Stiffener Type</th>
                       							<th width="40%">Description</th>
                								<th width="10%">Price (each)</th>
                								<th width="10%"></th>
                 							</tr>
             							</thead>
										<tbody>
                         					<tr style="display:none">
                                    			<td>
                                					<input class="pricingAnswer Sort" section="pricingWallStiffener" name="sort" type="text" value="" />
                                					<input type="hidden" name="pricingWallStiffenerID" value="">
                             					</td>
                                				<td>
                                					<input class="pricingAnswer Name" section="pricingWallStiffener" name="name" type="text" value="" />
                             					</td>
                             					<td>
		                            				<textarea class="pricingAnswer Description" section="pricingWallStiffener" name="description"></textarea>
		                         				</td>
                                				<td>
                                					<input class="pricingAnswer Price" section="pricingWallStiffener" name="price" type="text" value="" />
                             					</td>
                             					<td class="delete" style="color:#36413e;text-align:center;">
	                                        		<a class="deleteRow" section="pricingWallStiffener"><img src="images/icons/phone_delete.png" /></a>
	                                    		</td>
                           					</tr>
 										</tbody>
									</table>
                            	</div>
                     		</div>
               			</div>
                    	<div class="servicesAnswer showNoTransition" parent="isWallAnchors">
                			<div class="medium-12 columns">
                    			<h6>Wall Anchor</h6>
                			</div>
                			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                     				<table class="cpTable pricingWallAnchor" tablename="pricingWallAnchor" cellpadding="0" cellspacing="0">
										<thead>
            								<tr>
                                   	 			<th width="10%">Order</th>
                       							<th width="30%">Wall Anchor Type</th>
                       							<th width="40%">Description</th>
                								<th width="10%">Price (each)</th>
                								<th width="10%"></th>
                 							</tr>
             							</thead>
										<tbody>
                         					<tr style="display:none">
                                    			<td>
                                					<input class="pricingAnswer Sort" section="pricingWallAnchor" name="sort" type="text" value="" />
                                					<input type="hidden" name="pricingWallAnchorID" value="">
                             					</td>
                                				<td>
                                					<input class="pricingAnswer Name" section="pricingWallAnchor" name="name" type="text" value="" />
                             					</td>
                             					<td>
		                            				<textarea class="pricingAnswer Description" section="pricingWallAnchor" name="description"></textarea>
		                         				</td>
                                				<td>
                                					<input class="pricingAnswer Price" section="pricingWallAnchor" name="price" type="text" value="" />
                             					</td>
                             					<td class="delete" style="color:#36413e;text-align:center;">
	                                        		<a class="deleteRow" section="pricingWallAnchor"><img src="images/icons/phone_delete.png" /></a>
	                                    		</td>
                           					</tr>
 										</tbody>
									</table>
                           	</div>
                     		</div>
               			</div>
                    	<div class="servicesAnswer showNoTransition" parent="isWallExcavation">
                    		<div class="medium-12 columns">
                    			<h6>Wall Excavation</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Wall Excavation Hand Digging Price <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="Price per square foot of wall."><img src="images/icons/info.png" /></span></label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="wallExcavationDepthPerFootHandDig" value="">
                     			</div>
                				<div class="medium-2 columns">
                   					<label>Wall Excavation Equipment Price <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="Price per linear foot of wall."><img src="images/icons/info.png" /></span></label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="wallExcavationDepthPerFootEquipment" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="wallExcavationDescription" section="description"></textarea>
           						</div>
               				</div>
               				<div class="medium-12 columns">
                    			<h6>Wall Straightening</h6>
                			</div>
               				<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Wall Straightening Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="wallStraighteningPerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="wallStraighteningDescription" section="description"></textarea>
           						</div>
               				</div>
               				<div class="medium-12 columns">
                    			<h6>Gravel Backfill</h6>
                			</div>
               				<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Gravel Backfill Price (Per Cubic Yard)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="wallGravelBackfillPerYard" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="wallGravelBackfillDescription" section="description"></textarea>
           						</div>
               				</div>
               				<div class="medium-12 columns">
                    			<h6>Tile Drains</h6>
                			</div>
                			<div class="medium-12 columns">
                 				<table class="cpTable pricingTileDrain" tablename="pricingTileDrain" cellpadding="0" cellspacing="0">
									<thead>
	    								<tr>
	                            			<th width="10%">Order</th>
	               							<th width="30%">Tile Drain Type</th>
	               							<th width="40%">Description</th>
	        								<th width="10%">Price (Per Linear Foot)</th>
	        								<th width="10%"></th>
	         							</tr>
	     							</thead>
									<tbody>
	                 					<tr style="display:none">
	                           	 			<td>
	                        					<input class="pricingAnswer Sort" section="pricingTileDrain" name="sort" type="text" value="" />
	                        					<input type="hidden" name="pricingTileDrainID" value="">
	                     					</td>
	                        				<td>
	                        					<input class="pricingAnswer Name" section="pricingTileDrain" name="name" type="text" value="" />
	                     					</td>
	                     					<td>
	                            				<textarea class="pricingAnswer Description" section="pricingTileDrain" name="description"></textarea>
	                         				</td>
	                        				<td>
	                        					<input class="pricingAnswer Price" section="pricingTileDrain" name="price" type="text" value="" />
	                     					</td>
	                     					<td class="delete" style="color:#36413e;text-align:center;">
	                                    		<a class="deleteRow" section="pricingTileDrain"><img src="images/icons/phone_delete.png" /></a>
	                                		</td>
	                   					</tr>
									</tbody>
								</table>
                 			</div>
                 			<div class="medium-12 columns">
                    			<h6>Membranes</h6>
                			</div>
                			<div class="medium-12 columns">
                 				<table class="cpTable pricingMembrane" tablename="pricingMembrane" cellpadding="0" cellspacing="0">
									<thead>
	    								<tr>
	                            			<th width="10%">Order</th>
	               							<th width="30%">Membrane Type</th>
	               							<th width="40%">Description</th>
	        								<th width="10%">Price (Per Sq Ft)</th>
	        								<th width="10%"></th>
	         							</tr>
	     							</thead>
									<tbody>
	                 					<tr style="display:none">
	                           	 			<td>
	                        					<input class="pricingAnswer Sort" section="pricingMembrane" name="sort" type="text" value="" />
	                        					<input type="hidden" name="pricingMembraneID" value="">
	                     					</td>
	                        				<td>
	                        					<input class="pricingAnswer Name" section="pricingMembrane" name="name" type="text" value="" />
	                     					</td>
	                     					<td>
	                            				<textarea class="pricingAnswer Description" section="pricingMembrane" name="description"></textarea>
	                         				</td>
	                        				<td>
	                        					<input class="pricingAnswer Price" section="pricingMembrane" name="price" type="text" value="" />
	                     					</td>
	                     					<td class="delete" style="color:#36413e;text-align:center;">
	                                    		<a class="deleteRow" section="pricingMembrane"><img src="images/icons/phone_delete.png" /></a>
	                                		</td>
	                   					</tr>
									</tbody>
								</table>
                 			</div>
                     	</div>
                    	<div class="servicesAnswer showNoTransition" parent="isBeamPocketRepair">
                    		<div class="medium-12 columns">
                    			<h6>Beam Pockets</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Beam Pockets Price (each)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="wallBeamPocketEach" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="beamPocketDescription" section="description"></textarea>
           						</div>
               				</div>
                    	</div>
                   		<div class="servicesAnswer showNoTransition" parent="isWindowWellReplacement">
                   			<div class="medium-12 columns">
                    			<h6>Window Well</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Window Well Replacement Price (each)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="wallWindowWellEach" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="windowWellReplaceDescription" section="description"></textarea>
           						</div>
               				</div>
                    	</div>
                 	</div>
                 	<div class="servicesAnswer showNoTransition" parent="isWaterManagement">
                		<div class="medium-12 columns">
                    		<h5>Water Management</h5>
                		</div>
                      	<div class="servicesAnswer showNoTransition" parent="isInstallSumpPumps">
                     		<div class="medium-12 columns">
                    			<h6>Sump Pump</h6>
                			</div>
               				<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Standard Sump Pump Installation</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterPumpInstallEach" value="">
                     			</div>
               				</div>
               				<div class="medium-12 columns">
               					<div class="large-6 columns">
            						<label>Standard Sump Pump Installation Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="standardSumpPumpDescription" section="description"></textarea>
           						</div>
           					</div>
                			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                    				<label>Sump Pump</label>
                     			</div>
                			</div>
                			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                     				<table class="cpTable pricingSumpPump" tablename="pricingSumpPump" cellpadding="0" cellspacing="0">
										<thead>
            								<tr>
                                    			<th width="10%">Order</th>
                       							<th width="30%">Sump Pump Type</th>
                       							<th width="40%">Description</th>
                								<th width="10%">Price (each)</th>
                								<th width="10%"></th>
                 							</tr>
             							</thead>
										<tbody>
                         					<tr style="display:none">
                                   	 			<td>
                                					<input class="pricingAnswer Sort" section="pricingSumpPump" name="sort" type="text" value="" />
                                					<input type="hidden" name="pricingSumpPumpID" value="">
                             					</td>
                                				<td>
                                					<input class="pricingAnswer Name" section="pricingSumpPump" name="name" type="text" value="" />
                             					</td>
                             					<td>
		                            				<textarea class="pricingAnswer Description" section="pricingSumpPump" name="description"></textarea>
		                         				</td>
                                				<td>
                                					<input class="pricingAnswer Price" section="pricingSumpPump" name="price" type="text" value="" />
                             					</td>
                             					<td class="delete" style="color:#36413e;text-align:center;">
	                                        		<a class="deleteRow" section="pricingSumpPump"><img src="images/icons/phone_delete.png" /></a>
	                                    		</td>
                           					</tr>
 										</tbody>
									</table>
                     			</div>
               			</div>
                			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                    				<label>Basin</label>
                    			</div>
                			</div>
               			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                     				<table class="cpTable pricingBasin" tablename="pricingBasin" cellpadding="0" cellspacing="0">
										<thead>
            								<tr>
                                    			<th width="10%">Order</th>
                       							<th width="30%">Basin Type</th>
                       							<th width="40%">Description</th>
                								<th width="10%">Price (each)</th>
                								<th width="10%"></th>
                 							</tr>
             							</thead>
										<tbody>
                         					<tr style="display:none">
                                    			<td>
                                					<input class="pricingAnswer Sort" section="pricingBasin" name="sort" type="text" value="" />
                                					<input type="hidden" name="pricingBasinID" value="">
                             					</td>
                                				<td>
                                					<input class="pricingAnswer Name" section="pricingBasin" name="name" type="text" value="" />
                             					</td>
                             					<td>
		                            				<textarea class="pricingAnswer Description" section="pricingBasin" name="description"></textarea>
		                         				</td>
                                				<td>
                                					<input class="pricingAnswer Price" section="pricingBasin" name="price" type="text" value="" />
                             					</td>
                             					<td class="delete" style="color:#36413e;text-align:center;">
	                                        		<a class="deleteRow" section="pricingBasin"><img src="images/icons/phone_delete.png" /></a>
	                                    		</td>
                           					</tr>
 										</tbody>
									</table>
                     			</div>
               			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   				<label>Interior Plumbing Price (Per Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   				<input class="pricingAnswer" section="pricing" type="text" name="waterPumpPlumbingPerFoot" value="">
                     			</div>
               			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   				<label>Elbows Price (each)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   				<input class="pricingAnswer" section="pricing" type="text" name="waterPumpElbowsEach" value="">
                     			</div>
               			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   				<label>Electrical Price (each)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   				<input class="pricingAnswer" section="pricing" type="text" name="waterPumpElectricalEach" value="">
                     			</div>
               			</div>
                			<!-- <div class="medium-12 columns">
                				<div class="medium-2 columns">
                   				<label>Standard Discharge Price</label>
                     			</div>
                    			<div class="medium-2 columns">
                   				<input class="pricingAnswer" section="pricing" type="text" name="waterPumpDischargeStandard" value="">
                     			</div>
               			</div> -->
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   				<label>Bury Discharge Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   				<input class="pricingAnswer" section="pricing" type="text" name="waterPumpDischargeBuriedPerFoot" value="">
                     			</div>
                    		</div>
                     	</div>
                    	<div class="servicesAnswer showNoTransition" parent="isInteriorDrainSystems">
                    		<div class="medium-12 columns">
                    			<h6>Interior Drain System</h6>
                			</div>
               				<div class="medium-12 columns">
                				<div class="medium-3 columns">
                   					<label>Interior Drain System Price - Basement (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterInteriorDrainPerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="interiorDrainBasementDescription" section="description"></textarea>
           						</div>
                     			<div class="medium-3 columns">
                   					<label>Interior Drain System Price - Crawlspace (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterInteriorDrainCrawlspacePerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="interiorDrainCrawlspaceDescription" section="description"></textarea>
           						</div>
               				</div>
                     	</div>
                    	<div class="servicesAnswer showNoTransition" parent="isGutterDischarges">
                    		<div class="medium-12 columns">
                    			<h6>Gutter Discharge</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Gutter Discharge - Buried Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterGutterDischargeBuriedPerFoot" value="">
                     			</div>
               				</div>
                			<div class="medium-12 columns">
                				<div class="medium-3 columns">
                   					<label>Gutter Discharge - Above Ground Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterGutterDischargePerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="gutterDischargeDescription" section="description"></textarea>
           						</div>
               				</div>
                   		</div>
                    	<div class="servicesAnswer showNoTransition" parent="isFrenchDrains">
                    		<div class="medium-12 columns">
                    			<h6>French Drains</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>French Drains - Perforated Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterFrenchDrainPerforatedPerFoot" value="">
                     			</div>
               				</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>French Drains - Non-Perforated Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterFrenchDrainNonPerforatedPerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="frenchDrainDescription" section="description"></textarea>
           						</div>
               				</div>
                    	</div>
                    	<div class="servicesAnswer showNoTransition" parent="isDrainInlets">
                			<div class="medium-12 columns">
                    			<h6>Drain Fixture</h6>
                			</div>
                			<div class="medium-12 columns">
                    			<div class="medium-12 columns">
                     				<table class="cpTable pricingDrainInlet" tablename="pricingDrainInlet" cellpadding="0" cellspacing="0">
										<thead>
            								<tr>
                                		    	<th width="10%">Order</th>
                       							<th width="30%">Drain Fixture Type</th>
                       							<th width="40%">Description</th>
                								<th width="10%">Price (each)</th>
                								<th width="10%"></th>
                 							</tr>
             							</thead>
										<tbody>
                         					<tr style="display:none">
                                   	 			<td>
                                					<input class="pricingAnswer Sort" section="pricingDrainInlet" name="sort" type="text" value="" />
                                					<input type="hidden" name="pricingDrainInletID" value="">
                             					</td>
                                				<td>
                                					<input class="pricingAnswer Name" section="pricingDrainInlet" name="name" type="text" value="" />
                             					</td>
                             					<td>
		                            				<textarea class="pricingAnswer Description" section="pricingDrainInlet" name="description"></textarea>
		                         				</td>
                                				<td>
                                					<input class="pricingAnswer Price" section="pricingDrainInlet" name="price" type="text" value="" />
                             					</td>
                             					<td class="delete" style="color:#36413e;text-align:center;">
	                                        		<a class="deleteRow" section="pricingDrainInlet"><img src="images/icons/phone_delete.png" /></a>
	                                    		</td>
                           					</tr>
 										</tbody>
									</table>
                     			</div>
               				</div>
                    	</div>
                     	<div class="servicesAnswer showNoTransition" parent="isCurtainDrains">
                     		<div class="medium-12 columns">
                    			<h6>Curtain Drains</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Curtain Drains Price (Per Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterCurtianDrainPerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="curtainDrainDescription" section="description"></textarea>
           						</div>
               				</div>
                    	</div>
                    	<div class="servicesAnswer showNoTransition" parent="isWindowWellDrains">
                    		<div class="medium-12 columns">
                    			<h6>Window Well Drains</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Window Well Drains Price (Each)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterWindowWellDrainEach" value="">
                     			</div>
               				</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Window Well Drains Interior Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterWindowWellDrainInteriorPerFoot" value="">
                     			</div>
               				</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Window Well Drains Exterior Price (Per Linear Foot)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterWindowWellDrainExteriorPerFoot" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="windowWellDrainDescription" section="description"></textarea>
           						</div>
               				</div>
                    	</div>
                    	<div class="servicesAnswer showNoTransition" parent="isExteriorGrading">
                    		<div class="medium-12 columns">
                    			<h6>Exterior Grading</h6>
                			</div>
                			<div class="medium-12 columns">
                				<div class="medium-2 columns">
                   					<label>Exterior Grading Price (Per Cubic Yard)</label>
                     			</div>
                    			<div class="medium-2 columns">
                   					<input class="pricingAnswer" section="pricing" type="text" name="waterGradingPerVolume" value="">
                     			</div>
                     			<div class="large-6 columns">
            						<label>Bid Description</label>
                            		<textarea rows="4" class="servicesAnswer" name="exteriorGradingDescription" section="description"></textarea>
           						</div>
               				</div>
                     	</div>
               		</div>
                	<div class="servicesAnswer showNoTransition" parent="isSupportPosts">
                		<div class="medium-12 columns">
                    		<h5>Support Posts</h5>
                		</div>
               			<div class="medium-12 columns">
                			<div class="medium-2 columns">
                   				<label>Adjust Existing Support Post (each)</label>
                     		</div>
                    		<div class="medium-2 columns">
                   				<input class="pricingAnswer" section="pricing" type="text" name="postAdjustEach" value="">
                     		</div>
               			</div>
                		<div class="medium-12 columns">
                    		<div class="medium-12 columns">
                    			<label>New/Replace Post</label>
                     		</div>
                		</div>
                		<div class="medium-12 columns">
                    		<div class="medium-12 columns">
                     			<table class="cpTable pricingPost" tablename="pricingPost" cellpadding="0" cellspacing="0">
									<thead>
            							<tr>
                                    		<th width="10%">Order</th>
                       						<th width="30%">Post Size</th>
                       						<th width="40%">Description</th>
                							<th width="10%">Price (each)</th>
                							<th width="10%"></th>
                 						</tr>
             						</thead>
									<tbody>
                                		<tr style="display:none">
                                    		<td>
                                				<input class="pricingAnswer Sort" section="pricingPost" name="sort" type="text" value="" />
                                				<input type="hidden" name="pricingPostID" value="">
                             				</td>
                                			<td>
                                				<input class="pricingAnswer Name" section="pricingPost" name="name" type="text" value="" />
                             				</td>
                             				<td>
		                            			<textarea class="pricingAnswer Description" section="pricingPost" name="description"></textarea>
		                         			</td>
                                			<td>
                                				<input class="pricingAnswer Price" section="pricingPost" name="price" type="text" value="" />
                             				</td>
                             				<td class="delete" style="color:#36413e;text-align:center;">
	                                       		<a class="deleteRow" section="pricingPost"><img src="images/icons/phone_delete.png" /></a>
	                                    	</td>
                           				</tr>
 									</tbody>
								</table>
                     		</div>
               			</div>
                		<div class="medium-12 columns">
                    		<div class="medium-12 columns">
                    			<label>New/Replace Footing</label>
                    		</div>
                		</div>
                		<div class="medium-12 columns">
                    		<div class="medium-12 columns">
                     			<table class="cpTable pricingPostFooting" tablename="pricingPostFooting" cellpadding="0" cellspacing="0">
									<thead>
            							<tr>
                                    		<th width="10%">Order</th>
                       						<th width="30%">Footing Size</th>
                       						<th width="40%">Description</th>
                							<th width="10%">Price (each)</th>
                							<th width="10%"></th>
                 						</tr>
             						</thead>
									<tbody>
                         				<tr style="display:none">
                                    		<td>
                                				<input class="pricingAnswer Sort" section="pricingPostFooting" name="sort" type="text" value="" />
                                				<input type="hidden" name="pricingPostFootingID" value="">
                             				</td>
                                			<td>
                                				<input class="pricingAnswer Name" section="pricingPostFooting" name="name" type="text" value="" />
                             				</td>
                             				<td>
		                            			<textarea class="pricingAnswer Description" section="pricingPostFooting" name="description"></textarea>
		                         			</td>
                                			<td>
                                				<input class="pricingAnswer Price" section="pricingPostFooting" name="price" type="text" value="" />
                             				</td>
                             				<td class="delete" style="color:#36413e;text-align:center;">
	                                        	<a class="deleteRow" section="pricingPostFooting"><img src="images/icons/phone_delete.png" /></a>
	                                    	</td>
                           				</tr>
 									</tbody>
								</table>
                     		</div>
               			</div>
                 	</div>
                 	<div class="servicesAnswer showNoTransition" parent="isMudjacking">
                  		<div class="medium-12 columns">
                    		<h5>Mudjacking</h5>
                		</div>
             			<div class="large-6 columns">
    						<label>Bid Description</label>
                    		<textarea rows="4" class="servicesAnswer" name="mudjackingDescription" section="description"></textarea>
   						</div>
               		</div>
                 	<div class="servicesAnswer showNoTransition" parent="isPolyurethaneFoam">
                  		<div class="medium-12 columns">
                    		<h5>Polyurethane Foam</h5>
                		</div>
             			<div class="large-6 columns">
    						<label>Bid Description</label>
                    		<textarea rows="4" class="servicesAnswer" name="polyurethaneFoamDescription" section="description"></textarea>
   						</div>
               		</div>
                 	<div class="servicesAnswer showNoTransition" parent="isCrackRepair">
                		<div class="medium-12 columns">
                    		<h5>Cracks</h5>
                		</div>
                		<div class="medium-12 columns">
                    		<h6>Floor Cracks</h6>
                		</div>
               			<div class="medium-12 columns">
                    		<div class="medium-12 columns">
                     			<table class="cpTable pricingFloorCracks" tablename="pricingFloorCracks" cellpadding="0" cellspacing="0">
									<thead>
            							<tr>
                                    		<th width="10%">Order</th>
                       						<th width="30%">Floor Crack Repair Type</th>
                       						<th width="40%">Description</th>
                							<th width="10%">Price (Per Linear Foot)</th>
                							<th width="10%"></th>
                 						</tr>
             						</thead>
									<tbody>
                         				<tr style="display:none">
                                    		<td>
                                				<input class="pricingAnswer Sort" section="pricingFloorCracks" name="sort" type="text" value="" />
                                				<input type="hidden" name="pricingFloorCracksID" value="">
                             				</td>
                                			<td>
                                				<input class="pricingAnswer Name" section="pricingFloorCracks" name="name" type="text" value="" />
                             				</td>
                             				<td>
		                            			<textarea class="pricingAnswer Description" section="pricingFloorCracks" name="description"></textarea>
		                         			</td>
                                			<td>
                                				<input class="pricingAnswer Price" section="pricingFloorCracks" name="price" type="text" value="" />
                             				</td>
                             				<td class="delete" style="color:#36413e;text-align:center;">
	                                        	<a class="deleteRow" section="pricingFloorCracks"><img src="images/icons/phone_delete.png" /></a>
	                                    	</td>
                           				</tr>
 									</tbody>
								</table>
                     		</div>
               		</div>
                		<div class="medium-12 columns">
                    		<h6>Wall Cracks</h6>
                		</div>
               			<div class="medium-12 columns">
                    		<div class="medium-12 columns">
                     			<table class="cpTable pricingWallCracks" tablename="pricingWallCracks" cellpadding="0" cellspacing="0">
									<thead>
            							<tr>
                                    		<th width="10%">Order</th>
                       						<th width="30%">Wall Crack Repair Type</th>
                       						<th width="40%">Description</th>
                							<th width="10%">Price (Per Linear Foot)</th>
                							<th width="10%"></th>
                 						</tr>
             						</thead>
									<tbody>
                         				<tr style="display:none">
                                    		<td>
                                				<input class="pricingAnswer Sort" section="pricingWallCracks" name="sort" type="text" value="" />
                                				<input type="hidden" name="pricingWallCracksID" value="">
                             				</td>
                                			<td>
                                				<input class="pricingAnswer Name" section="pricingWallCracks" name="name" type="text" value="" />
                             				</td>
                             				<td>
		                            			<textarea class="pricingAnswer Description" section="pricingWallCracks" name="description"></textarea>
		                         			</td>
                                			<td>
                                				<input class="pricingAnswer Price" section="pricingWallCracks" name="price" type="text" value="" />
                             				</td>
                             				<td class="delete" style="color:#36413e;text-align:center;">
	                                      		<a class="deleteRow" section="pricingWallCracks"><img src="images/icons/phone_delete.png" /></a>
	                                    	</td>
                           				</tr>
 									</tbody>
								</table>
                     		</div>
               			</div>
               			<div class="medium-12 columns">
                    		<h6>Custom Services</h6>
                		</div>
               			<div class="medium-12 columns">
                    		<div class="medium-12 columns">
                     			<table class="cpTable pricingCustomServices" tablename="pricingCustomServices" cellpadding="0" cellspacing="0">
									<thead>
            							<tr>
                                    		<th width="10%">Order</th>
                       						<th width="30%">Custom Service Name</th>
                       						<th width="40%">Description</th>
                							<th width="10%">Price (each) <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="Each, square foot, linear foot, cubic yard, etc."><img src="images/icons/info_white.png" /></span> </th>
                							<th width="10%"></th>
                 						</tr>
             						</thead>
									<tbody>
                         				<tr style="display:none">
                                    		<td>
                                				<input class="pricingAnswer Sort" section="pricingCustomServices" name="sort" type="text" value="" />
                                				<input type="hidden" name="pricingCustomCustomID" value="">
                             				</td>
                                			<td>
                                				<input class="pricingAnswer Name" section="pricingCustomServices" name="name" type="text" value="" />
                             				</td>
                             				<td>
		                            			<textarea class="pricingAnswer Description" section="pricingCustomServices" name="description"></textarea>
		                         			</td>
                                			<td>
                                				<input class="pricingAnswer Price" section="pricingCustomServices" name="price" type="text" value="" />
                             				</td>
                             				<td class="delete" style="color:#36413e;text-align:center;">
	                                      		<a class="deleteRow" section="pricingCustomServices"><img src="images/icons/phone_delete.png" /></a>
	                                    	</td>
                           				</tr>
 									</tbody>
								</table>
                     		</div>
               			</div>
                 	</div>
                 	<div id="deleteRowModal" class="reveal tiny" data-reveal data-close-on-esc="false" data-close-on-click="false">
                        <h2 id="modalTitle" style="text-align:center;margin-bottom:1.5rem;">Delete Row</h2>
                        <div class="row align-center">
                            <p>Are you sure you want to delete this row?</p>
                        </div>
                        <div class="row">
                            <div class="medium-12 columns text-center">
                                <input type="hidden" id="idToDelete" name="idToDelete" value="" />
                                <input type="hidden" id="idToDeleteSection" name="idToDeleteSection" value="" />
                                <button id="yesDeleteRow" class="button">Yes</button>
                                <button class="button secondary" data-close>Cancel</button>
                            </div>
                        </div>
                    </div>
             	</div>
              	<div class="tabs-panel" id="contract">
                	<div class="row expanded">
                  	<div class="medium-8 columns">
                    		<div class="row expanded">
                            	<div class="medium-6 columns">
                                	<label>Enter Your Contract Text and Replace the Customer's Information with the Tags</label>
                            	</div>
                            	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="contractLastSaved"><?php echo $contractLastUpdatedDisplay; ?></span>
                               		</p>
                            	</div>
                         	</div>
                			<label><textarea id="contractText" rows="20"><?php echo $contractText; ?></textarea>
                       			<small style="margin-top: 1rem;" class="form-error">Contract text is required.</small>
                     		</label>
						</div>
                	</div>
                 	<div class="row expanded">
                    	<div class="medium-12 columns">
                        	<button style="margin-top: 1rem;" class="button" id="saveContractText">Save</button>
                     	</div>
                 	</div>
                	<div id="contractSavedModal" class="reveal tiny" data-reveal data-close-on-esc="false" data-close-on-click="false">
                     	<div class="row align-center">
                    		<p>Contract has been saved!</p>
                    	</div>
                     	<div class="row">
                        	<div class="medium-12 columns text-center">
                            	<button data-close class="button">Ok</button>
                        	</div>
                    	</div>
					</div>
         		</div>
         		<div class="tabs-panel" id="emails">
                	<div class="medium-12 columns" style="margin: 0 0 .5rem 0;">
                    	<h4>Email Setup</h4>
                 	</div>
	                <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>New Customer</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>New customer is added without an evaluation appointment.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="newCustomerLastSaved"><?php echo $companyEmailAddCustomerLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<textarea id="newCustomerEmail" rows="20"><?php echo $companyEmailAddCustomer; ?></textarea>
	                       	<small style="margin-top: 1rem;" class="form-error">New Customer email is required.</small>
						</div>
	                </div>
	                <div class="row expanded">

                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 1rem;" class="button" id="saveNewCustomerEmail">Save</button>
                     	</div>
                 	</div>
                    <hr>
                    <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>Evaluation Appointment</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>New customer is added with an evaluation appointment.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="evaluationAppointmentLastSaved"><?php echo $companyEmailScheduleLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<label><textarea id="evaluationAppointmentEmail" rows="20"><?php echo $companyEmailSchedule; ?></textarea>
	                       		<small style="margin-top: 1rem;" class="form-error">Evaluation email is required.</small>
	                     	</label>
						</div>
	                </div>
	                <div class="row expanded">
                    	<div class="medium-12 columns">
                           <label style="color: #58595b;padding-left: 1rem;margin-top: .5rem;">Send From Project Salesperson <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This will send the email from the project salesperson email address instead of the company email address."><img src="images/icons/info.png" /></span></label>
                           </div>
                           <div class="medium-12 columns">
                             <div class="switch small" style="padding-left: 1rem;">
                               <input class="switch-input" id="scheduleEmailSendSales" type="checkbox" name="scheduleEmailSendSales" <?php echo $scheduleEmailSendSales; ?> >
                        
                                <label class="switch-paddle" for="scheduleEmailSendSales">
                                    <span class="switch-active" aria-hidden="true">On</span>
                                    <span class="switch-inactive" aria-hidden="true">Off</span>
                                </label>
                            </div>
                            </div>
                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 1rem;" class="button" id="saveEvaluationAppointmentEmail">Save</button>
                     	</div>
                 	</div>
                    <hr>
                    <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>Customer Bid</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>Bid is emailed to customer.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="customerBidLastSaved"><?php echo $companyEmailBidSentLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<label><textarea id="customerBidEmail" rows="20"><?php echo $companyEmailBidSent; ?></textarea>
	                       		<small style="margin-top: 1rem;" class="form-error">Customer bid email is required.</small>
	                     	</label>
						</div>
	                </div>
	                <div class="row expanded">
                    	
	                	<div class="medium-12 columns">
                           <label style="color: #58595b;padding-left: 1rem;margin-top: .5rem;">Send From Project Salesperson <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This will send the email from the project salesperson email address instead of the company email address."><img src="images/icons/info.png" /></span></label>
                           </div>
                           <div class="medium-12 columns">
                             <div class="switch small" style="padding-left: 1rem;">
                               <input class="switch-input" id="bidEmailSendSales" type="checkbox" name="bidEmailSendSales" <?php echo $bidEmailSendSales; ?> >
                        
                                <label class="switch-paddle" for="bidEmailSendSales">
                                    <span class="switch-active" aria-hidden="true">On</span>
                                    <span class="switch-inactive" aria-hidden="true">Off</span>
                                </label>
                            </div>
                            </div>

                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 1rem;" class="button" id="saveCustomerBidEmail">Save</button>
                     	</div>
                 	</div>
                    <hr>
                    <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>Bid Accept Email</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>Customer accepts bid and receives an email.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="bidAcceptLastSaved"><?php echo $companyEmailBidAcceptLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<label><textarea id="bidAcceptEmail" rows="20"><?php echo $companyEmailBidAccept; ?></textarea>
	                       		<small style="margin-top: 1rem;" class="form-error">Bid accept email is required.</small>
	                     	</label>
						</div>
	                </div>
	                	  <div class="row expanded">

                			 <div class="medium-12 columns">
                           <label style="color: #58595b;padding-left: 1rem;margin-top: .5rem;">Send From Project Salesperson <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This will send the email from the project salesperson email address instead of the company email address."><img src="images/icons/info.png" /></span></label>
                           </div>
                           <div class="medium-12 columns">
                             <div class="switch small" style="padding-left: 1rem;">
                               <input class="switch-input" id="bidAcceptEmailSendSales" type="checkbox" name="bidAcceptEmailSendSales" <?php echo $bidAcceptEmailSendSales;?> >
                        
                                <label class="switch-paddle" for="bidAcceptEmailSendSales">
                                    <span class="switch-active" aria-hidden="true">On</span>
                                    <span class="switch-inactive" aria-hidden="true">Off</span>
                                </label>
                            </div>
                            </div>
                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 1rem;" class="button" id="saveBidAcceptEmail">Save</button>
                     	</div>
                 	</div>
                 	<hr>
                    <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>Bid Reject Email</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>Customer rejects bid and receives an email.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="bidRejectLastSaved"><?php echo $companyEmailBidRejectLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<label><textarea id="bidRejectEmail" rows="20"><?php echo $companyEmailBidReject; ?></textarea>
	                       		<small style="margin-top: 1rem;" class="form-error">Bid reject email is required.</small>
	                     	</label>
						</div>
	                </div>
	                <div class="row expanded">


	                <div class="medium-12 columns">
                           <label style="color: #58595b;padding-left: 1rem;margin-top: .5rem;">Send From Project Salesperson <span data-tooltip aria-haspopup="true" class="has-tip top" data-disable-hover="false" tabindex="1" title="This will send the email from the project salesperson email address instead of the company email address."><img src="images/icons/info.png" /></span></label>
                           </div>
                           <div class="medium-12 columns">
                             <div class="switch small" style="padding-left: 1rem;">
                               <input class="switch-input" id="bidRejectEmailSendSales" type="checkbox" name="bidRejectEmailSendSales" <?php echo $bidRejectEmailSendSales; ?> >
                        
                                <label class="switch-paddle" for="bidRejectEmailSendSales">
                                    <span class="switch-active" aria-hidden="true">On</span>
                                    <span class="switch-inactive" aria-hidden="true">Off</span>
                                </label>
                            </div>
                            </div>

                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 1rem;" class="button" id="saveBidRejectEmail">Save</button>
                     	</div>
                 	</div>
                 	<hr>
                    <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>Installation Email</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>Installation appointment is emailed to customer.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="installationAppointmentLastSaved"><?php echo $companyEmailInstallationLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<label><textarea id="installationAppointmentEmail" rows="20"><?php echo $companyEmailInstallation; ?></textarea>
	                       		<small style="margin-top: 1rem;" class="form-error">Installation email is required.</small>
	                     	</label>
						</div>
	                </div>
	                <div class="row expanded">
                    	
                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 0.5rem;" class="button" id="saveInstallationAppointmentEmail">Save</button>
                     	</div>
                 	</div>
                 	<hr>
                    <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>Final Packet Email</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>Final packet is emailed to customer.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="finalPacketLastSaved"><?php echo $companyEmailFinalPacketLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<label><textarea id="finalPacketEmail" rows="20"><?php echo $companyEmailFinalPacket; ?></textarea>
	                       		<small style="margin-top: 1rem;" class="form-error">Final packet email is required.</small>
	                     	</label>
						</div>
	                </div>
	                <div class="row expanded">
                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 1rem;" class="button" id="saveFinalPacketEmail">Save</button>
                     	</div>
                 	</div>
                 	<hr>
                    <div class="medium-12 columns" style="margin-top:1rem;">
	                    <h5>Send Invoice Email</h5>
	                </div>
	                <div class="row expanded">
	                	<div class="medium-8 columns" style="padding-left: 1.8rem;">
	                    	<div class="row expanded">
	                       		<div class="medium-6 columns">
	                           		<label>Invoice is emailed to customer.</label>
	                          	</div>
	                          	<div class="medium-6 columns">
                                	<p class="text-right no-margin">
                                    	<span id="invoiceLastSaved"><?php echo $companyEmailInvoiceLastUpdated; ?></span>
                               		</p>
                            	</div>
	                      	</div>
	                		<label><textarea id="invoiceEmail" rows="20"><?php echo $companyEmailInvoice; ?></textarea>
	                       		<small style="margin-top: 1rem;" class="form-error">Invoice email is required.</small>
	                     	</label>
						</div>
	                </div>
	                <div class="row expanded">
                    	<div class="medium-12 columns" style="padding-left: 1.8rem;">
                        	<button style="margin-top: 1rem;" class="button" id="saveInvoiceEmail">Save</button>
                     	</div>
                 	</div>

                	<div id="emailSavedModal" class="reveal tiny" data-reveal data-close-on-esc="false" data-close-on-click="false">
                     	<div class="row align-center">
                    		<p></p>
                    	</div>
                     	<div class="row">
                        	<div class="medium-12 columns text-center">
                            	<button data-close class="button">Ok</button>
                        	</div>
                    	</div>
					</div>
					<div id="emailPreviewModal" class="reveal large" data-reveal>
						<h3 id="modalTitle" style="text-align:center;margin-bottom:1.5rem;"></h3>
                     	<div id="modalContent" class="row">
                    	</div>
                     	<div class="row">
                        	<div class="medium-12 columns text-center">
                            	<button data-close class="button">Close</button>
                        	</div>
                    	</div>
					</div>

					<div id="coverLetterPreviewModal" class="reveal large" data-reveal>
						<h3 id="modalTitleCL" style="text-align:center;margin-bottom:1.5rem;"></h3>
                     	<div id="modalContentCL" class="row">
                    	</div>
                     	<div class="row">
                        	<div class="medium-12 columns text-center">
                            	<button data-close class="button">Close</button>
                        	</div>
                    	</div>
					</div>

         		</div>
         		<div class="tabs-panel" id="finalPacket">
         			<div class="row expanded">

						<div class="medium-9 columns">
							<div class="row">
								<div class="medium-9 columns">
							 		<h4>Cover Letter</h4>
							 	</div>
					                	<div class="medium-12 columns" style="padding-left: 1.8rem; margin-bottom: .5rem;">
					                    	<div class="row expanded">
					                       		<div class="medium-6 columns">
					                           		<label>Cover Letter for final packet</label>
					                          	</div>
					                          	<div class="medium-6 columns">
				                                	<p class="text-right no-margin">
				                                    	<span id="finalPacketCoverLetterLastSaved">
				                                    		</span>
				                               		</p>
				                            	</div>
					                      	</div>
					                		<label><textarea id="finalPacketCoverLetter" rows="20"><?php echo $companyCoverLetter; ?></textarea>
					                       		<small style="margin-top: 1rem;" class="form-error">Cover Letter is required.</small>
					                     	</label>
										</div>

										<div class="row expanded">
											<div class="medium-12 columns" style="padding-left: 1.8rem; margin-left: 1.1 rem;">
												<button style="margin-top: .5rem; margin-left: 1.1rem;" class="button" id="saveFinalPacketCoverLetter">Save
												</button>
											</div>
										</div>
										<hr>
						 	</div>
						</div>
					</div>

         				<div class="medium-9 columns">
         					<div class="row">
         						<div class="medium-9 columns">
			                 		<h4>Warranties</h4>
			                 	</div>
			                 	<div class="medium-3 columns text-right">
			                    	<button id="addWarranty" class="button">Add Warranty</button>
			                 	</div>
         					</div>
         					<div class="row">
         						<div class="medium-12 columns" style="margin: 0 0 .5rem 0;">
			                    	<table id="warrantyTable" class="evaluationTable" cellpadding="0" cellspacing="0">
						                <thead>
						                    <tr>
						                        <th style="text-align:left">Warranty Name</th>
						                        <th>Last Updated</th>
						                        <th>Warranty Type</th>
						                        <th width="30%"></th>
						                    </tr>
						                </thead>
						                <tbody>
						                	<tr style="display:none;">
						                        <td class="WarrantyName" style="text-align:left"></td>
						                        <td class="WarrantyDate"></td>
						                        <td class="WarrantyStatus"></td>
						                        <td>
						                        	<button id="editWarranty" class="button">Edit</button>
						                        	<a id="previewWarranty" target="_blank" style="margin: 0rem 0 1rem 0;" class="button" href="">Preview</a>
						                        	<a class="deleteItem" id="deleteWarranty"><img src="images/icons/phone_delete.png" /></a>
						                       	</td>
						                    </tr>
						                </tbody>
						            </table>
			                 	</div>
         					</div>
         				</div>
         				<div class="medium-9 columns" style="margin-top:3rem;">
         					<div class="row">
         						<div class="medium-9 columns">
			                 		<h4>Disclaimers</h4>
			                 	</div>
			                 	<div class="medium-3 columns text-right">
			                    	<button id="addDisclaimer" class="button">Add Disclaimer</button>
			                 	</div>
         					</div>
         					<div class="row">
         						<div class="medium-12 columns" style="margin: 0 0 .5rem 0;">
			                    	<table id="disclaimerTable" class="evaluationTable" cellpadding="0" cellspacing="0">
						                <thead>
						                    <tr>
						                    	<th style="text-align:left">Section</th>
						                        <th>Name</th>
						                        <th>Disclaimer</th>
						                        <th width="20%">Last Updated</th>
						                        <th width="20%"></th>
						                    </tr>
						                </thead>
						                <tbody>
						                	<tr style="display:none;">
						                    	<td class="DisclaimerSection" style="text-align:left"></td>
						                        <td class="DisclaimerName"></td>
						                        <td class="Disclaimer"></td>
						                        <td class="DisclaimerDate"></td>
						                        <td>
						                        	<button id="editDisclaimer" class="button">Edit</button>
						                        	<a class="deleteItem" id="deleteDisclaimer"><img src="images/icons/phone_delete.png" /></a>
						                        </td>
						                    </tr>
						                </tbody>
						            </table>
			                 	</div>
         					</div>
         				</div>
         			</div>
         			 <div class="large reveal" id="addWarrantyModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<h3 class="text-center">Add Warranty</h3>
                        		<div class="medium-6 columns no-pad">
                        			<label>Warranty Name</label>
                        			<input name="warrantyName" type="text" value="" />
                        			<small id="addWarrantyNameError" style="margin-top: 1rem;" class="form-error">You must specify a warranty name.</small>
                        		</div>
                        		<div class="medium-6 columns no-pad" style="margin-bottom: 1rem;">
                        			<label>Page Orientation</label>
                        			<label>
	                        			<input name="optType" type="radio" value="0" id="optCertificate" checked="checked"/>
                        				Certificate (landscape)
                        			</label>
                        			<label>
                        			<input name="optType" type="radio" value="1" />
	                        			Document (portrait)
                        			</label>
                        		</div>
                        		<!-- <div class="medium-6 columns no-pad"> -->
                        		<label>
                        			<textarea id="addWarrantyBody" rows="20"></textarea>
					                    <small id="warrantyError" style="margin-top: 1rem;" class="form-error">You must include warranty information.</small>
		                     	</label>
		                     	<p class="text-center no-margin" style="margin-top: 1.4rem;">
		                     	    <button class="button" id="saveAddWarrantyBody">Save</button>
                            		<button class="button secondary" id="cancelAddWarrantyBody">Cancel</button>
                            	</p>
		                     <!-- </div> -->
    <!--                     		<p class="warranty-preview">
                        			<label>Set Position for Customer Address</label>
                        			<span class="address-position">1234 Some Street, Thiscity, MO 12345</span>
                        			<img style="border:1px solid #c5c5c5;cursor:pointer;" src="" />
                        		</p>
                            	<p class="text-center no-margin">
                            		<small class="form-error">Please select the position for the customer address.</small>
                            		<input type="hidden" name="warrantyID" value="" />
                            		<input type="hidden" name="addressCoordinatesX" value="" />
                            		<input type="hidden" name="addressCoordinatesY" value="" />
                            		<button class="button" id="saveEditWarranty">Save</button>
                            		<button class="button secondary" id="cancelEditWarranty">Cancel</button>
                              	</p> -->
                            </div>
                     	</div>
                    </div>
                    <div class="tiny reveal" id="warrantyDeleteModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<h3 class="text-center">Delete Warranty</h3>
                        		<p class="text-center" style="margin-top: 1rem;">Are you sure you want to delete this warranty?</p>
                            	<p class="text-center no-margin">
                            		<input type="hidden" name="warrantyID" value="" />
                            		<button class="button" id="yesDeleteWarranty">Yes</button>
                            		<button class="button secondary" id="cancelDeleteWarranty">Cancel</button>
                              	</p>
                            </div>
                     	</div>
                    </div>
                    <!-- start warranty edit modal -->
                    <div class="large reveal" id="warrantyEditModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<h3 class="text-center">Edit Warranty</h3>
                        		<div class="medium-6 columns no-pad">
                        			<label>Warranty Name</label>
                        			<input name="editWarrantyName" type="text" value="" />
                        			<input name="editWarrantyID" type="hidden" value=""/ >
                        			<small id="editWarrantyNameError" style="margin-top: 1rem;" class="form-error">You must specify a warranty name.</small>
                        		</div>
                        		<div class="medium-6 columns no-pad" style="margin-bottom: 1rem;">
                        			<label>Page Orientation</label>
                        			<label>
	                        			<input name="optType" type="radio" value="0" id="optEditCertificate" checked="checked"/>
                        				Certificate (landscape)
                        			</label>
                        			<label>
                        			<input name="optType" type="radio" value="1" id="optEditDocument" />
	                        			Document (portrait)
                        			</label>
                        			<small class="form-error" id="editDocumentTypeError">You must choose a document type</small>

                        		</div>
                        		<!-- <div class="medium-6 columns no-pad"> -->
                        		<label>
                        			<textarea id="editWarrantyBody" rows="20"></textarea>
					                    <small id="warrantyEditError" style="margin-top: 1rem;" class="form-error">You must include warranty information.</small>
		                     	</label>
		                     	<p class="text-center no-margin" style="margin-top: 1.4rem;">
		                     	    <button class="button" id="saveEditWarrantyBody">Save</button>
                            		<button class="button secondary" id="cancelEditWarrantyBody">Cancel</button>
                            	</p>
		                     <!-- </div> -->
    <!--                     		<p class="warranty-preview">
                        			<label>Set Position for Customer Address</label>
                        			<span class="address-position">1234 Some Street, Thiscity, MO 12345</span>
                        			<img style="border:1px solid #c5c5c5;cursor:pointer;" src="" />
                        		</p>
                            	<p class="text-center no-margin">
                            		<small class="form-error">Please select the position for the customer address.</small>
                            		<input type="hidden" name="warrantyID" value="" />
                            		<input type="hidden" name="addressCoordinatesX" value="" />
                            		<input type="hidden" name="addressCoordinatesY" value="" />
                            		<button class="button" id="saveEditWarranty">Save</button>
                            		<button class="button secondary" id="cancelEditWarranty">Cancel</button>
                              	</p> -->
                            </div>
                     	</div>
                    </div>








        <!--             <div class="small reveal" id="warrantyEditModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<h3 class="text-center">Edit Warranty</h3>
                        		<div class="medium-6 columns no-pad">
                        			<label>Warranty Name</label>
                        			<input name="warrantyName" type="text" value="" />
                        		</div>
                        		<div class="medium-6 columns no-pad" style="margin-bottom: 1rem;">
                        			<label>Addresss Position</label>
                        			<input name="addressPosition" type="radio" value="left" />
                        			<label>Left</label>
                        			<input name="addressPosition" type="radio" value="center" />
                        			<label>Center</label>
                        			<input name="addressPosition" type="radio" value="right" />
                        			<label>Right</label>
                        		</div>
                        		<p class="warranty-preview">
                        			<label>Set Position for Customer Address</label>
                        			<span class="address-position">1234 Some Street, Thiscity, MO 12345</span>
                        			<img style="border:1px solid #c5c5c5;cursor:pointer;" src="" />
                        		</p>
                            	<p class="text-center no-margin">
                            		<small class="form-error">Please select the position for the customer address.</small>
                            		<input type="hidden" name="warrantyID" value="" />
                            		<input type="hidden" name="addressCoordinatesX" value="" />
                            		<input type="hidden" name="addressCoordinatesY" value="" />
                            		<button class="button" id="saveEditWarranty">Save</button>
                            		<button class="button secondary" id="cancelEditWarranty">Cancel</button>
                              	</p>
                            </div>
                     	</div>
                    </div> -->
                    <!-- end warranty edit modal -->

                    <div class="reveal small" id="addDisclaimerModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
 						<h3 class="text-center">Add Disclaimer</h3>
 						<div class="row">
      						<div class="medium-6 columns">
      							<label>Disclaimer Section <small>required</small>
      								<select name="disclaimerSection">
      									<option value=""></option>
      									<option value="1">Piering</option>
      									<option value="2">Wall Repair</option>
      									<option value="3">Water Management</option>
      									<option value="4">Crack Repair</option>
      									<option value="5">Support Posts</option>
      									<option value="6">Mudjacking</option>
      									<option value="7">Polyurethane Foam</option>
      									<option value="8">General</option>
      								</select>
      								<small class="form-error">Disclaimer Section is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
      						<div class="medium-9 columns">
      							<label>Disclaimer Name <small>required</small>
      								<input name="disclaimerName" type="text" value="" />
      								<small class="form-error">Disclaimer Name is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
      						<div class="medium-9 columns">
      							<label>Disclaimer Text <small>required</small>
      								<textarea rows="3" name="disclaimer"></textarea>
      								<small class="form-error">Disclaimer Text is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
			        		<div class="medium-12 columns">
			            		<p class="text-center no-margin">
			             			<button class="button" id="saveAddDisclaimer">Save</button>
			                  		<button class="button secondary" id="cancelAddDisclaimer">Cancel</button>
			             		</p>
			          		</div>
			       		</div>
			   		</div>
			   		<div class="tiny reveal" id="disclaimerDeleteModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<h3 class="text-center">Delete Disclaimer</h3>
                        		<p class="text-center" style="margin-top: 1rem;">Are you sure you want to delete this disclaimer?</p>
                            	<p class="text-center no-margin">
                            		<input type="hidden" name="disclaimerID" value="" />
                            		<button class="button" id="yesDeleteDisclaimer">Yes</button>
                            		<button class="button secondary" id="cancelDeleteDisclaimer">Cancel</button>
                              	</p>
                            </div>
                     	</div>
                    </div>
                    <div class="reveal small" id="disclaimerEditModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
 						<h3 class="text-center">Edit Disclaimer</h3>
 						<div class="row">
      						<div class="medium-6 columns">
      							<label>Disclaimer Section <small>required</small>
      								<select name="disclaimerSection">
      									<option value=""></option>
      									<option value="1">Piering</option>
      									<option value="2">Wall Repair</option>
      									<option value="3">Water Management</option>
      									<option value="4">Crack Repair</option>
      									<option value="5">Support Posts</option>
      									<option value="6">Mudjacking</option>
      									<option value="7">Polyurethane Foam</option>
      									<option value="8">General</option>
      								</select>
      								<small class="form-error">Disclaimer Section is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
      						<div class="medium-9 columns">
      							<label>Disclaimer Name <small>required</small>
      								<input name="disclaimerName" type="text" value="" />
      								<small class="form-error">Disclaimer Name is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
      						<div class="medium-9 columns">
      							<label>Disclaimer Text <small>required</small>
      								<textarea rows="3" name="disclaimer"></textarea>
      								<small class="form-error">Disclaimer Text is required.</small>
      							</label>
      						</div>
      					</div>
      					<div class="row">
			        		<div class="medium-12 columns">
			            		<p class="text-center no-margin">
			            			<input type="hidden" name="disclaimerID" value="" />
			             			<button class="button" id="saveEditDisclaimer">Save</button>
			                  		<button class="button secondary" id="cancelEditDisclaimer">Cancel</button>
			             		</p>
			          		</div>
			       		</div>
			   		</div>
			   		<div class="tiny reveal" id="successModal" data-reveal>
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<p class="modal-content text-center">
                                </p>
                                <p class="text-center no-margin">
                            		<button class="button" data-close>OK</button>
                              	</p>
                            </div>
                     	</div>
                    </div>
			   		<div class="tiny reveal" id="missingInformationModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
			   			<h3 class="text-center">Missing Information</h3>
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<p class="modal-content text-center">
                    			You have missing information in your company profile. Please fill out your email and invoice defaults before you can make additional changes to your company profile.
                                </p>
                                <p class="text-center no-margin">
                            		<button class="button" id="continueMissingInformation">Continue</button>
                              	</p>
                            </div>
                     	</div>
                    </div>
			   		<div class="tiny reveal" id="contractNotSavedModal" data-reveal data-close-on-esc="false" data-close-on-click="false">
			   			<h3 class="text-center">Contract Not Saved</h3>
                      	<div class="row">
                        	<div class="medium-12 columns">
                        		<p class="modal-content text-center">
                    				Are you sure you want to continue without saving your contract?
                                </p>
                                <p class="text-center no-margin">
                            		<button class="button" id="noSaveContract">Ok</button>                                
                            		<button class="button secondary" id="yesSaveContract" data-close>Cancel</button>
                              	</p>
                            </div>
                     	</div>
                    </div>
         		</div>
        	</div>
      	</div>
   	</div>
   	<?php  include_once 'setup-modal.html'  ?>
    <?php  include_once 'footer.html'  ?>

<script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();
    </script>
    <script type="text/javascript" src="js/jquery.mask.min.js"></script>
    <script type="text/javascript">
        $(function () {
        	$('.numberOnly').mask('00000000000');
        	$('.percent').mask('000');
            $('.Phone').mask('(000) 000-0000');
            $('.date').mask('11/11/1111');
            $('.time').mask('Hh:Mm Pp',
               {
                   'translation': {
                       H: { pattern: /[0-1]/ },
                       h: { pattern: /[0-9]/ },
                       M: { pattern: /[0-5]/ },
                       m: { pattern: /[0-9]/ },
                       P: { pattern: /[AaPp]/ },
                       p: { pattern: /[Mm]/ }
                   }
               });
        });
    </script>
  </body>
</html>
